(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[197],{2576:function(e,s,a){Promise.resolve().then(a.bind(a,2292))},2292:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return b}});var l=a(7437),t=a(2265),r=a(1827),i=a(2482),n=a(2549),c=a(5750),d=a(1396),o=a.n(d),x=a(7810),m=a(6142),u=a(2245),g=a(8203),h=a(2176);function p(e){let{guide:s,className:a=""}=e,t=e=>new Intl.NumberFormat("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0}).format(e),r=Math.min(...s.guidedServices.map(e=>Number(e.price)));return(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition-shadow ".concat(a),children:[(0,l.jsxs)("div",{className:"p-6",children:[(0,l.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,l.jsx)("div",{className:"flex-shrink-0",children:(0,l.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded-full overflow-hidden",children:s.avatar?(0,l.jsx)("img",{src:s.avatar,alt:s.name,className:"w-full h-full object-cover"}):(0,l.jsx)("div",{className:"w-full h-full flex items-center justify-center text-gray-400 text-xl font-semibold",children:s.name.charAt(0)})})}),(0,l.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900 truncate",children:s.name}),(0,l.jsx)("button",{className:"text-gray-400 hover:text-red-500 transition-colors",children:(0,l.jsx)(x.Z,{className:"w-5 h-5"})})]}),s.userProfile.location&&(0,l.jsxs)("div",{className:"flex items-center text-sm text-gray-600 mt-1",children:[(0,l.jsx)(m.Z,{className:"w-4 h-4 mr-1"}),s.userProfile.location]}),(0,l.jsxs)("div",{className:"flex items-center space-x-4 mt-2",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(u.Z,{className:"w-4 h-4 text-yellow-400 fill-current mr-1"}),(0,l.jsx)("span",{className:"text-sm font-medium text-gray-900",children:s.stats.averageRating}),(0,l.jsxs)("span",{className:"text-sm text-gray-600 ml-1",children:["(",s.stats.totalReviews,")"]})]}),(0,l.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,l.jsx)(c.Z,{className:"w-4 h-4 mr-1"}),s.stats.totalBookings," 次預訂"]})]})]})]}),s.userProfile.bio&&(0,l.jsx)("p",{className:"text-gray-700 text-sm mt-4 line-clamp-2",children:s.userProfile.bio}),(0,l.jsxs)("div",{className:"mt-4 space-y-2",children:[s.userProfile.languages.length>0&&(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("span",{className:"text-xs text-gray-500 w-12",children:"語言:"}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-1",children:[s.userProfile.languages.slice(0,3).map((e,s)=>(0,l.jsx)("span",{className:"inline-block px-2 py-1 text-xs bg-blue-100 text-blue-700 rounded",children:e},s)),s.userProfile.languages.length>3&&(0,l.jsxs)("span",{className:"text-xs text-gray-500",children:["+",s.userProfile.languages.length-3]})]})]}),s.userProfile.specialties.length>0&&(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("span",{className:"text-xs text-gray-500 w-12",children:"專長:"}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-1",children:[s.userProfile.specialties.slice(0,2).map((e,s)=>(0,l.jsx)("span",{className:"inline-block px-2 py-1 text-xs bg-green-100 text-green-700 rounded",children:e},s)),s.userProfile.specialties.length>2&&(0,l.jsxs)("span",{className:"text-xs text-gray-500",children:["+",s.userProfile.specialties.length-2]})]})]})]})]}),s.guidedServices.length>0&&(0,l.jsx)("div",{className:"border-t border-gray-100",children:(0,l.jsxs)("div",{className:"p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,l.jsx)("h4",{className:"text-sm font-medium text-gray-900",children:"服務項目"}),(0,l.jsxs)("span",{className:"text-xs text-gray-500",children:[s.stats.activeServices," 項服務"]})]}),(0,l.jsx)("div",{className:"grid grid-cols-2 gap-3",children:s.guidedServices.slice(0,2).map(e=>(0,l.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.images.length>0&&(0,l.jsx)("div",{className:"w-full h-20 bg-gray-200 rounded mb-2 overflow-hidden",children:(0,l.jsx)("img",{src:e.images[0],alt:e.title,className:"w-full h-full object-cover"})}),(0,l.jsx)("h5",{className:"text-sm font-medium text-gray-900 line-clamp-1 mb-1",children:e.title}),(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("span",{className:"text-xs text-gray-600 flex items-center",children:[(0,l.jsx)(m.Z,{className:"w-3 h-3 mr-1"}),e.location]}),(0,l.jsx)("span",{className:"text-sm font-semibold text-blue-600",children:t(e.price)})]})]},e.id))})]})}),(0,l.jsxs)("div",{className:"border-t border-gray-100 p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsxs)("div",{className:"text-sm text-gray-600",children:["起價 ",(0,l.jsx)("span",{className:"text-lg font-semibold text-gray-900",children:t(r)})]}),(0,l.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,l.jsx)(g.Z,{className:"w-4 h-4 mr-1"}),s.userProfile.experienceYears||0," 年經驗"]})]}),(0,l.jsxs)("div",{className:"flex space-x-2",children:[(0,l.jsx)("button",{className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:(0,l.jsx)(h.Z,{className:"w-4 h-4"})}),(0,l.jsx)(o(),{href:"/guides/".concat(s.id),className:"px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 transition-colors",children:"查看詳情"})]})]}),s.stats.responseRate>0&&(0,l.jsxs)("div",{className:"mt-3 text-xs text-gray-500",children:["回覆率 ",s.stats.responseRate,"%"]})]})]})}function b(e){let{className:s=""}=e,[a,d]=(0,t.useState)([]),[o,x]=(0,t.useState)(!0),[m,u]=(0,t.useState)(null),[g,h]=(0,t.useState)({page:1,limit:20,total:0,pages:0,hasNext:!1,hasPrev:!1}),[b,j]=(0,t.useState)({locations:[],languages:[],specialties:[]}),[v,f]=(0,t.useState)(""),[N,y]=(0,t.useState)(""),[w,k]=(0,t.useState)(""),[S,P]=(0,t.useState)(""),[_,C]=(0,t.useState)(""),[Z,E]=(0,t.useState)(""),[R,A]=(0,t.useState)("rating"),[D,F]=(0,t.useState)("desc"),[M,z]=(0,t.useState)(!1),O=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;try{x(!0);let s=new URLSearchParams({page:e.toString(),limit:g.limit.toString(),sortBy:R,sortOrder:D});v&&s.append("q",v),N&&s.append("location",N),w&&s.append("language",w),S&&s.append("specialty",S),_&&s.append("minRating",_),Z&&s.append("minExperience",Z);let a=await fetch("/api/guides?".concat(s));if(!a.ok)throw Error("Failed to fetch guides");let l=(await a.json()).data;d(l.guides),h(l.pagination),j(l.filters),u(null)}catch(e){u(e instanceof Error?e.message:"載入嚮導列表失敗")}finally{x(!1)}};(0,t.useEffect)(()=>{O(1)},[v,N,w,S,_,Z,R,D]);let T=()=>{f(""),y(""),k(""),P(""),C(""),E(""),A("rating"),F("desc")},W=v||N||w||S||_||Z;return m?(0,l.jsxs)("div",{className:"text-center py-8 ".concat(s),children:[(0,l.jsx)("div",{className:"text-red-500 mb-4",children:m}),(0,l.jsx)("button",{onClick:()=>O(g.page),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"重新載入"})]}):(0,l.jsxs)("div",{className:"".concat(s),children:[(0,l.jsx)("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-10",children:(0,l.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:[(0,l.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0",children:[(0,l.jsx)("form",{onSubmit:e=>{e.preventDefault(),O(1)},className:"flex-1 max-w-lg",children:(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(r.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,l.jsx)("input",{type:"text",value:v,onChange:e=>f(e.target.value),placeholder:"搜尋嚮導姓名或專業...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsxs)("button",{onClick:()=>z(!M),className:"flex items-center px-4 py-2 border rounded-lg transition-colors ".concat(M||W?"border-blue-500 text-blue-600 bg-blue-50":"border-gray-300 text-gray-700 hover:bg-gray-50"),children:[(0,l.jsx)(i.Z,{className:"w-4 h-4 mr-2"}),"篩選",W&&(0,l.jsx)("span",{className:"ml-2 px-2 py-0.5 bg-blue-600 text-white text-xs rounded-full",children:"!"})]}),(0,l.jsxs)("select",{value:"".concat(R,"_").concat(D),onChange:e=>{let[s,a]=e.target.value.split("_");A(s||"rating"),F(a||"desc")},className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,l.jsx)("option",{value:"rating_desc",children:"評分高到低"}),(0,l.jsx)("option",{value:"rating_asc",children:"評分低到高"}),(0,l.jsx)("option",{value:"services_desc",children:"服務數量多到少"}),(0,l.jsx)("option",{value:"services_asc",children:"服務數量少到多"}),(0,l.jsx)("option",{value:"experience_desc",children:"經驗豐富到新手"}),(0,l.jsx)("option",{value:"experience_asc",children:"新手到經驗豐富"}),(0,l.jsx)("option",{value:"name_asc",children:"姓名 A-Z"}),(0,l.jsx)("option",{value:"name_desc",children:"姓名 Z-A"})]})]})]}),M&&(0,l.jsxs)("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"地點"}),(0,l.jsxs)("select",{value:N,onChange:e=>y(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,l.jsx)("option",{value:"",children:"所有地點"}),b.locations.map(e=>(0,l.jsxs)("option",{value:e.location,children:[e.location," (",e._count.location,")"]},e.location))]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"語言"}),(0,l.jsxs)("select",{value:w,onChange:e=>k(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,l.jsx)("option",{value:"",children:"所有語言"}),b.languages.map(e=>(0,l.jsx)("option",{value:e,children:e},e))]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"專業領域"}),(0,l.jsxs)("select",{value:S,onChange:e=>P(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,l.jsx)("option",{value:"",children:"所有專業"}),b.specialties.map(e=>(0,l.jsx)("option",{value:e,children:e},e))]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"最低評分"}),(0,l.jsxs)("select",{value:_,onChange:e=>C(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,l.jsx)("option",{value:"",children:"不限"}),(0,l.jsx)("option",{value:"4.5",children:"4.5+ 星"}),(0,l.jsx)("option",{value:"4",children:"4+ 星"}),(0,l.jsx)("option",{value:"3.5",children:"3.5+ 星"}),(0,l.jsx)("option",{value:"3",children:"3+ 星"})]})]})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"最少經驗年數"}),(0,l.jsxs)("select",{value:Z,onChange:e=>E(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,l.jsx)("option",{value:"",children:"不限"}),(0,l.jsx)("option",{value:"1",children:"1+ 年"}),(0,l.jsx)("option",{value:"2",children:"2+ 年"}),(0,l.jsx)("option",{value:"3",children:"3+ 年"}),(0,l.jsx)("option",{value:"5",children:"5+ 年"}),(0,l.jsx)("option",{value:"10",children:"10+ 年"})]})]}),W&&(0,l.jsxs)("button",{onClick:T,className:"flex items-center px-3 py-2 text-sm text-gray-600 hover:text-gray-800",children:[(0,l.jsx)(n.Z,{className:"w-4 h-4 mr-1"}),"清除篩選"]})]})]})]})}),(0,l.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,l.jsxs)("div",{className:"text-sm text-gray-600",children:["找到 ",g.total," 位嚮導",W&&(0,l.jsx)("span",{className:"ml-2 text-blue-600",children:"(已套用篩選條件)"})]}),(0,l.jsxs)("div",{className:"text-sm text-gray-600",children:["第 ",g.page," 頁，共 ",g.pages," 頁"]})]}),o?(0,l.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:Array.from({length:6},(e,s)=>(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 animate-pulse",children:[(0,l.jsxs)("div",{className:"flex space-x-4",children:[(0,l.jsx)("div",{className:"w-16 h-16 bg-gray-200 rounded-full"}),(0,l.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,l.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/3"}),(0,l.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/2"}),(0,l.jsx)("div",{className:"h-3 bg-gray-200 rounded w-2/3"})]})]}),(0,l.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,l.jsx)("div",{className:"h-3 bg-gray-200 rounded"}),(0,l.jsx)("div",{className:"h-3 bg-gray-200 rounded w-4/5"})]})]},s))}):0===a.length?(0,l.jsxs)("div",{className:"text-center py-12",children:[(0,l.jsx)(c.Z,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),(0,l.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"沒有找到符合條件的嚮導"}),(0,l.jsx)("p",{className:"text-gray-600 mb-6",children:"試試調整搜尋條件或清除篩選器"}),W&&(0,l.jsx)("button",{onClick:T,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"清除所有篩選"})]}):(0,l.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:a.map(e=>(0,l.jsx)(p,{guide:e},e.id))}),g.pages>1&&(0,l.jsxs)("div",{className:"flex items-center justify-center space-x-2 mt-8",children:[(0,l.jsx)("button",{onClick:()=>O(g.page-1),disabled:!g.hasPrev,className:"px-3 py-2 border border-gray-300 rounded-md disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"上一頁"}),Array.from({length:Math.min(5,g.pages)},(e,s)=>{let a=Math.max(1,g.page-2)+s;return a>g.pages?null:(0,l.jsx)("button",{onClick:()=>O(a),className:"px-3 py-2 border rounded-md ".concat(a===g.page?"border-blue-500 bg-blue-50 text-blue-600":"border-gray-300 hover:bg-gray-50"),children:a},a)}),(0,l.jsx)("button",{onClick:()=>O(g.page+1),disabled:!g.hasNext,className:"px-3 py-2 border border-gray-300 rounded-md disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"下一頁"})]})]})]})}}},function(e){e.O(0,[1216,1744],function(){return e(e.s=2576)}),_N_E=e.O()}]);