(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[86],{4733:function(e,s,l){Promise.resolve().then(l.bind(l,8656))},8656:function(e,s,l){"use strict";l.r(s),l.d(s,{default:function(){return C}});var t=l(7437),a=l(2265),r=l(4033),n=l(9617),i=l(6142),d=l(8203),o=l(8244),c=l(7810),x=l(2245),m=l(1738),h=l(3021),u=l(9036),g=l(8956),p=l(9409),b=l(8228),f=l(4563),j=l(2549),v=l(2169);function y(e){let{isOpen:s,onClose:l,title:r,description:n,children:i,size:d="md",showCloseButton:o=!0,closeOnOverlayClick:c=!0,className:x}=e;return(a.useEffect(()=>{let e=e=>{"Escape"===e.key&&l()};return s&&(document.addEventListener("keydown",e),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",e),document.body.style.overflow="unset"}},[s,l]),s)?(0,t.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:c?l:void 0}),(0,t.jsx)("div",{className:"flex min-h-full items-center justify-center p-4",children:(0,t.jsxs)("div",{className:(0,v.cn)("relative w-full bg-white rounded-xl shadow-2xl transform transition-all",{sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl",full:"max-w-[95vw] max-h-[95vh]"}[d],x),onClick:e=>e.stopPropagation(),children:[(r||o)&&(0,t.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,t.jsxs)("div",{children:[r&&(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:r}),n&&(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:n})]}),o&&(0,t.jsx)("button",{onClick:l,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors","aria-label":"關閉",children:(0,t.jsx)(j.Z,{className:"w-5 h-5 text-gray-400"})})]}),(0,t.jsx)("div",{className:"p-6",children:i})]})})]}):null}var N=l(5022),w=l(7290),k=l(5554);function C(){var e,s,l,j;let v=(0,r.useRouter)(),{user:C,updateUser:S,isLoading:Z,isAuthenticated:B}=(0,b.a)(),{success:E,error:R}=(0,w.pm)(),{isOpen:z,openModal:A,closeModal:T}=function(){let[e,s]=a.useState(!1);return{isOpen:e,openModal:()=>s(!0),closeModal:()=>s(!1),toggleModal:()=>s(!e)}}(),[_,D]=(0,a.useState)({name:"",phone:"",bio:"",location:"",languages:[],specialties:[],avatar:""}),[F,L]=(0,a.useState)({}),[M,O]=(0,a.useState)(!1);(0,a.useEffect)(()=>{if(!B){v.push("/login");return}},[B,v]),(0,a.useEffect)(()=>{if(C){var e,s,l,t,a;D({name:C.name||"",phone:(null===(e=C.profile)||void 0===e?void 0:e.phone)||"",bio:(null===(s=C.profile)||void 0===s?void 0:s.bio)||"",location:(null===(l=C.profile)||void 0===l?void 0:l.location)||"",languages:(null===(t=C.profile)||void 0===t?void 0:t.languages)||[],specialties:(null===(a=C.profile)||void 0===a?void 0:a.specialties)||[],avatar:C.avatar||""})}},[C]);let W=()=>{let e={};return _.name.trim()?_.name.trim().length<2&&(e.name="姓名至少需要2個字元"):e.name="請輸入姓名",_.phone&&!/^09\d{8}$/.test(_.phone.replace(/\D/g,""))&&(e.phone="請輸入有效的台灣手機號碼格式"),_.bio&&_.bio.length>500&&(e.bio="自我介紹不能超過500個字元"),L(e),0===Object.keys(e).length},H=(e,s)=>{D(l=>({...l,[e]:s})),F[e]&&L(s=>({...s,[e]:void 0}))},I=async()=>{if(W()){O(!0);try{await S({name:_.name,avatar:_.avatar,profile:{phone:_.phone,bio:_.bio,location:_.location,languages:_.languages,specialties:_.specialties}}),E("更新成功","您的個人資料已成功更新"),T()}catch(e){R("更新失敗","無法更新個人資料，請稍後再試")}finally{O(!1)}}};return B&&C?(0,t.jsxs)("div",{style:{minHeight:"100vh",background:"linear-gradient(to bottom right, #dbeafe, #ffffff, #e0e7ff)"},children:[(0,t.jsx)(k.us,{}),(0,t.jsxs)("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"1rem"},className:"sm:p-8",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("h1",{className:"heading-1 text-gray-900 mb-2",children:"個人中心"}),(0,t.jsx)("p",{className:"body-large",children:"管理您的個人資料和偏好設定"})]}),(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:"2rem"},className:"lg:grid-cols-3",children:[(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"2rem"},className:"lg:col-span-2",children:[(0,t.jsxs)("div",{style:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"1rem",padding:"1.5rem",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)"},children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-6",children:[(0,t.jsx)("h2",{className:"heading-3",children:"個人資料"}),(0,t.jsxs)("button",{onClick:A,className:"btn btn-secondary btn-sm flex items-center gap-2",children:[(0,t.jsx)(n.Z,{className:"w-4 h-4"}),"編輯"]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-6 mb-6",children:[(0,t.jsxs)("div",{className:"relative",children:[C.avatar?(0,t.jsx)("img",{src:C.avatar,alt:C.name,className:"w-24 h-24 rounded-full object-cover"}):(0,t.jsx)("div",{className:"w-24 h-24 bg-gray-200 rounded-full flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-2xl font-bold text-gray-400",children:C.name.charAt(0)})}),(0,t.jsx)("div",{className:"absolute -bottom-1 -right-1 flex space-x-1",children:C.isEmailVerified&&(0,t.jsx)("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-white text-xs",children:"✓"})})})]}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:C.name}),(0,t.jsx)("p",{className:"text-gray-600 mb-2",children:(null===(e=C.profile)||void 0===e?void 0:e.bio)||"還沒有自我介紹"}),(0,t.jsxs)("div",{className:"flex items-center text-sm text-gray-500 space-x-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(i.Z,{className:"w-4 h-4"}),(null===(s=C.profile)||void 0===s?void 0:s.location)||"未設定地區"]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(d.Z,{className:"w-4 h-4"}),"加入於 ",new Date(C.createdAt).toLocaleDateString("zh-TW")]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mt-3",children:[(0,t.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium ".concat("guide"===C.role?"bg-[#FF5A5F] text-white":"bg-blue-100 text-blue-800"),children:"guide"===C.role?"地陪":"旅客"}),!C.isKYCVerified&&(0,t.jsx)("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs font-medium",children:"待驗證"})]})]})]}),(null===(l=C.profile)||void 0===l?void 0:l.specialties)&&C.profile.specialties.length>0&&(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"專長領域"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:C.profile.specialties.map((e,s)=>(0,t.jsx)("span",{className:"px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm",children:e},s))})]}),(null===(j=C.profile)||void 0===j?void 0:j.languages)&&C.profile.languages.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"語言能力"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:C.profile.languages.map((e,s)=>(0,t.jsx)("span",{className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm",children:e},s))})]})]}),(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"1rem"},className:"md:grid-cols-4",children:[(0,t.jsxs)("div",{style:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"1rem",padding:"1rem",textAlign:"center",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)"},children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:"12"}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"完成預訂"})]}),(0,t.jsxs)("div",{style:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"1rem",padding:"1rem",textAlign:"center",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)"},children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:"4.8"}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"平均評分"})]}),(0,t.jsxs)("div",{style:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"1rem",padding:"1rem",textAlign:"center",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)"},children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:"8"}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"收藏地陪"})]}),(0,t.jsxs)("div",{style:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"1rem",padding:"1rem",textAlign:"center",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)"},children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:"3"}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"本月預訂"})]})]})]}),(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[(0,t.jsxs)("div",{style:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"1rem",padding:"1.5rem",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)"},children:[(0,t.jsx)("h3",{className:"heading-3 mb-4",children:"快速操作"}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("button",{onClick:()=>v.push("/my-bookings"),className:"w-full flex items-center gap-3 p-3 text-left hover:bg-gray-50 rounded-lg transition-colors",children:[(0,t.jsx)(o.Z,{className:"w-5 h-5 text-gray-400"}),(0,t.jsx)("span",{children:"預訂歷史"})]}),"guide"===C.role&&(0,t.jsxs)("button",{onClick:()=>v.push("/guide-dashboard"),className:"w-full flex items-center gap-3 p-3 text-left hover:bg-blue-50 rounded-lg transition-colors",children:[(0,t.jsx)(i.Z,{className:"w-5 h-5 text-blue-500"}),(0,t.jsx)("span",{style:{color:"#2563eb",fontWeight:"500"},children:"導遊控制台"})]}),(0,t.jsxs)("button",{className:"w-full flex items-center gap-3 p-3 text-left hover:bg-gray-50 rounded-lg transition-colors",children:[(0,t.jsx)(c.Z,{className:"w-5 h-5 text-gray-400"}),(0,t.jsx)("span",{children:"我的收藏"})]}),(0,t.jsxs)("button",{className:"w-full flex items-center gap-3 p-3 text-left hover:bg-gray-50 rounded-lg transition-colors",children:[(0,t.jsx)(x.Z,{className:"w-5 h-5 text-gray-400"}),(0,t.jsx)("span",{children:"我的評價"})]}),(0,t.jsxs)("button",{className:"w-full flex items-center gap-3 p-3 text-left hover:bg-gray-50 rounded-lg transition-colors",children:[(0,t.jsx)(m.Z,{className:"w-5 h-5 text-gray-400"}),(0,t.jsx)("span",{children:"付款方式"})]})]})]}),(0,t.jsxs)("div",{style:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"1rem",padding:"1.5rem",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)"},children:[(0,t.jsx)("h3",{className:"heading-3 mb-4",children:"設定"}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("button",{className:"w-full flex items-center gap-3 p-3 text-left hover:bg-gray-50 rounded-lg transition-colors",children:[(0,t.jsx)(h.Z,{className:"w-5 h-5 text-gray-400"}),(0,t.jsx)("span",{children:"通知設定"})]}),(0,t.jsxs)("button",{className:"w-full flex items-center gap-3 p-3 text-left hover:bg-gray-50 rounded-lg transition-colors",children:[(0,t.jsx)(u.Z,{className:"w-5 h-5 text-gray-400"}),(0,t.jsx)("span",{children:"隱私設定"})]}),(0,t.jsxs)("button",{className:"w-full flex items-center gap-3 p-3 text-left hover:bg-gray-50 rounded-lg transition-colors",children:[(0,t.jsx)(g.Z,{className:"w-5 h-5 text-gray-400"}),(0,t.jsx)("span",{children:"語言設定"})]}),(0,t.jsxs)("button",{className:"w-full flex items-center gap-3 p-3 text-left hover:bg-gray-50 rounded-lg transition-colors",children:[(0,t.jsx)(p.Z,{className:"w-5 h-5 text-gray-400"}),(0,t.jsx)("span",{children:"帳戶設定"})]})]})]}),!C.isKYCVerified&&(0,t.jsxs)("div",{className:"card p-6 bg-yellow-50 border-yellow-200",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-yellow-800 mb-2",children:"完成身分驗證"}),(0,t.jsx)("p",{className:"text-sm text-yellow-700 mb-4",children:"完成 KYC 驗證可以提升帳戶安全性並解鎖更多功能"}),(0,t.jsx)("button",{onClick:()=>v.push("/kyc"),className:"btn btn-primary btn-sm w-full",children:"立即驗證"})]})]})]})]}),(0,t.jsx)(y,{isOpen:z,onClose:T,title:"編輯個人資料",size:"lg",children:(0,t.jsxs)("form",{className:"space-y-6",children:[(0,t.jsx)(f.G,{value:_.avatar,onChange:e=>{H("avatar",e)},size:"lg"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"姓名 *"}),(0,t.jsx)("input",{type:"text",value:_.name,onChange:e=>H("name",e.target.value),className:"input w-full ".concat(F.name?"border-red-500 focus:border-red-500 focus:ring-red-200":""),required:!0}),F.name&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-600",children:F.name})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"電子郵件 *"}),(0,t.jsx)("input",{type:"email",value:C.email,className:"input bg-gray-50 w-full",disabled:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"手機號碼"}),(0,t.jsx)("input",{type:"tel",value:_.phone,onChange:e=>H("phone",e.target.value),className:"input w-full ".concat(F.phone?"border-red-500 focus:border-red-500 focus:ring-red-200":""),placeholder:"例：0912345678"}),F.phone&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-600",children:F.phone})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"所在地區"}),(0,t.jsx)("input",{type:"text",value:_.location,onChange:e=>H("location",e.target.value),className:"input w-full",placeholder:"例：台北市"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"自我介紹"}),(0,t.jsx)("textarea",{value:_.bio,onChange:e=>H("bio",e.target.value),className:"input min-h-[100px] w-full ".concat(F.bio?"border-red-500 focus:border-red-500 focus:ring-red-200":""),placeholder:"告訴大家關於您的故事...",maxLength:500}),(0,t.jsxs)("div",{className:"flex justify-between items-center mt-1",children:[F.bio&&(0,t.jsx)("p",{className:"text-sm text-red-600",children:F.bio}),(0,t.jsxs)("p",{className:"text-sm text-gray-500 ml-auto",children:[_.bio.length,"/500"]})]})]}),(0,t.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,t.jsx)("button",{type:"button",onClick:T,className:"btn btn-ghost btn-md",children:"取消"}),(0,t.jsx)("button",{type:"button",onClick:I,disabled:M,className:"btn btn-primary btn-md disabled:opacity-50 disabled:cursor-not-allowed",children:M?(0,t.jsxs)("div",{className:"flex items-center justify-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"儲存中..."]}):"儲存變更"})]})]})})]}):(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)(N.gb,{size:"lg"})})}},5554:function(e,s,l){"use strict";l.d(s,{L6:function(){return d},d8:function(){return n},us:function(){return i}});var t=l(7437),a=l(4033),r=l(1291);function n(e){let{showBackButton:s=!1,backButtonText:l="返回",showHomeButton:n=!0,homeButtonText:i="回到首頁",customBackAction:d}=e,o=(0,a.useRouter)();return(0,t.jsxs)(t.Fragment,{children:[n&&(0,t.jsx)("div",{style:{position:"absolute",top:"1rem",left:"1rem",zIndex:50},className:"sm:top-8 sm:left-8",children:(0,t.jsxs)("button",{onClick:()=>{o.push("/")},style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0.75rem",backgroundColor:"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(10px)",borderRadius:"0.5rem",border:"1px solid rgba(255, 255, 255, 0.3)",cursor:"pointer",transition:"all 0.2s",fontSize:"0.75rem",fontWeight:"500",color:"#374151",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)"},className:"hover:bg-white hover:shadow-md sm:text-sm sm:px-4 sm:py-3",children:[(0,t.jsxs)("span",{className:"hidden sm:inline",children:["← ",i]}),(0,t.jsx)("span",{className:"sm:hidden",children:"← 首頁"})]})}),s&&(0,t.jsx)("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"1rem 1.5rem",paddingTop:n?"4rem":"1rem"},children:(0,t.jsxs)("button",{onClick:()=>{d?d():o.back()},style:{display:"flex",alignItems:"center",gap:"0.5rem",color:"#6b7280",background:"none",border:"none",cursor:"pointer",fontSize:"0.875rem",transition:"color 0.2s",padding:"0.5rem 0"},className:"hover:text-gray-900",children:[(0,t.jsx)(r.Z,{style:{width:"1.25rem",height:"1.25rem"}}),(0,t.jsx)("span",{children:l})]})})]})}function i(e){let{text:s="回到首頁"}=e;return(0,t.jsx)(n,{showHomeButton:!0,homeButtonText:s,showBackButton:!1})}function d(e){let{backButtonText:s="返回",homeButtonText:l="回到首頁",customBackAction:a}=e;return(0,t.jsx)(n,{showHomeButton:!0,showBackButton:!0,backButtonText:s,homeButtonText:l,customBackAction:a})}}},function(e){e.O(0,[1216,811,1744],function(){return e(e.s=4733)}),_N_E=e.O()}]);