(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4031],{4164:function(e,r,t){Promise.resolve().then(t.bind(t,8984))},8984:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return b}});var o=t(7437),i=t(2265),n=t(4033),l=t(1981),s=t(2442),d=t(2549),a=t(8203),m=t(6141),c=t(5750),g=t(2245),h=t(8228),u=t(4477),x=t(5554),f=t(5022);function b(){let e=(0,n.useRouter)(),{isAuthenticated:r,user:t}=(0,h.a)(),{bookings:b,fetchBookings:p,cancelBooking:y,submitReview:j,isLoading:v}=(0,u.v)(),[k,w]=(0,i.useState)("all"),[S,C]=(0,i.useState)(!1),[z,B]=(0,i.useState)(null),[W,N]=(0,i.useState)(5),[R,I]=(0,i.useState)(""),[Z,D]=(0,i.useState)(!1),[E,T]=(0,i.useState)(null),[_,F]=(0,i.useState)("");(0,i.useEffect)(()=>{if(!r){e.push("/login?redirect=/my-bookings");return}p()},[r,e,p]);let H=e=>{let r={pending:{text:"待確認",color:"bg-yellow-100 text-yellow-800",icon:l.Z},confirmed:{text:"已確認",color:"bg-blue-100 text-blue-800",icon:s.Z},completed:{text:"已完成",color:"bg-green-100 text-green-800",icon:s.Z},cancelled:{text:"已取消",color:"bg-red-100 text-red-800",icon:d.Z},refunded:{text:"已退款",color:"bg-gray-100 text-gray-800",icon:d.Z}},t=r[e]||r.pending,i=t.icon;return(0,o.jsxs)("span",{style:{display:"inline-flex",alignItems:"center",gap:"0.25rem",padding:"0.25rem 0.5rem",borderRadius:"9999px",fontSize:"0.75rem",fontWeight:"500"},className:t.color,children:[(0,o.jsx)(i,{style:{width:"0.75rem",height:"0.75rem"}}),t.text]})},O=b.filter(e=>"all"===k||e.status===k),L=async()=>{if(E)try{await y(E,_),D(!1),T(null),F("")}catch(e){}},A=async()=>{if(z)try{await j(z,W,R),C(!1),B(null),N(5),I("")}catch(e){}};return r?(0,o.jsxs)("div",{style:{minHeight:"100vh",background:"linear-gradient(to bottom right, #dbeafe, #ffffff, #e0e7ff)",paddingTop:"2rem",paddingBottom:"2rem"},children:[(0,o.jsx)(x.L6,{}),(0,o.jsxs)("div",{style:{maxWidth:"64rem",margin:"0 auto",padding:"0 1rem"},children:[(0,o.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,o.jsx)("h1",{style:{fontSize:"2rem",fontWeight:"700",color:"#111827",marginBottom:"0.5rem"},children:"我的預訂"}),(0,o.jsx)("p",{style:{color:"#6b7280"},children:"管理您的所有導覽預訂"})]}),(0,o.jsx)("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"2rem",flexWrap:"wrap"},children:[{key:"all",label:"全部"},{key:"PENDING",label:"待確認"},{key:"CONFIRMED",label:"已確認"},{key:"completed",label:"已完成"},{key:"cancelled",label:"已取消"}].map(e=>(0,o.jsx)("button",{onClick:()=>w(e.key),style:{padding:"0.5rem 1rem",borderRadius:"0.5rem",fontSize:"0.875rem",fontWeight:"500",border:"1px solid",cursor:"pointer",transition:"all 0.2s",...k===e.key?{backgroundColor:"#2563eb",borderColor:"#2563eb",color:"white"}:{backgroundColor:"white",borderColor:"#e5e7eb",color:"#374151"}},className:k!==e.key?"hover:bg-gray-50":"",children:e.label},e.key))}),v?(0,o.jsx)(f.gb,{}):0===O.length?(0,o.jsxs)("div",{style:{textAlign:"center",padding:"3rem",backgroundColor:"white",borderRadius:"1rem",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)"},children:[(0,o.jsx)("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:"\uD83D\uDCC5"}),(0,o.jsx)("h3",{style:{fontSize:"1.125rem",fontWeight:"600",color:"#111827",marginBottom:"0.5rem"},children:"all"===k?"暫無預訂記錄":"暫無".concat("PENDING"===k?"待確認":"CONFIRMED"===k?"已確認":"completed"===k?"已完成":"已取消","的預訂")}),(0,o.jsx)("p",{style:{color:"#6b7280",marginBottom:"1.5rem"},children:"開始探索精彩的導覽服務吧！"}),(0,o.jsx)("button",{onClick:()=>e.push("/search"),style:{padding:"0.75rem 1.5rem",background:"linear-gradient(to right, #2563eb, #4f46e5)",color:"white",border:"none",borderRadius:"0.5rem",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer",transition:"all 0.2s"},className:"hover:shadow-lg",children:"瀏覽服務"})]}):(0,o.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:O.map(e=>(0,o.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"1rem",padding:"1.5rem",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)",border:"1px solid #f3f4f6"},children:[(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1rem"},children:[(0,o.jsx)("div",{style:{flex:1},children:(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.5rem"},children:[(0,o.jsxs)("h3",{style:{fontSize:"1.125rem",fontWeight:"600",color:"#111827"},children:["預訂 #",e.id]}),H(e.status)]})}),(0,o.jsxs)("div",{style:{textAlign:"right"},children:[(0,o.jsxs)("div",{style:{fontSize:"1.25rem",fontWeight:"700",color:"#111827"},children:["NT$ ",e.pricing.total.toLocaleString()]}),(0,o.jsx)("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:e.pricing.currency})]})]}),(0,o.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"1rem"},children:[(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,o.jsx)(a.Z,{style:{width:"1rem",height:"1rem",color:"#6b7280"}}),(0,o.jsx)("span",{style:{fontSize:"0.875rem",color:"#374151"},children:new Date(e.details.date).toLocaleDateString("zh-TW")})]}),(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,o.jsx)(m.Z,{style:{width:"1rem",height:"1rem",color:"#6b7280"}}),(0,o.jsxs)("span",{style:{fontSize:"0.875rem",color:"#374151"},children:[e.details.time," (",e.details.duration,"小時)"]})]}),(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,o.jsx)(c.Z,{style:{width:"1rem",height:"1rem",color:"#6b7280"}}),(0,o.jsxs)("span",{style:{fontSize:"0.875rem",color:"#374151"},children:[e.details.guests," 人"]})]})]}),(0,o.jsxs)("div",{style:{marginBottom:"1rem",padding:"0.75rem",backgroundColor:"#f9fafb",borderRadius:"0.5rem"},children:[(0,o.jsx)("div",{style:{fontSize:"0.875rem",fontWeight:"500",color:"#374151",marginBottom:"0.25rem"},children:"聯絡資訊"}),(0,o.jsxs)("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:[e.details.contactInfo.name," • ",e.details.contactInfo.email," • ",e.details.contactInfo.phone]})]}),e.details.specialRequests&&(0,o.jsxs)("div",{style:{marginBottom:"1rem",padding:"0.75rem",backgroundColor:"#fef3c7",borderRadius:"0.5rem"},children:[(0,o.jsx)("div",{style:{fontSize:"0.875rem",fontWeight:"500",color:"#92400e",marginBottom:"0.25rem"},children:"特殊要求"}),(0,o.jsx)("div",{style:{fontSize:"0.875rem",color:"#92400e"},children:e.details.specialRequests})]}),e.review&&(0,o.jsxs)("div",{style:{marginBottom:"1rem",padding:"0.75rem",backgroundColor:"#ecfdf5",borderRadius:"0.5rem"},children:[(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[(0,o.jsx)(g.Z,{style:{width:"1rem",height:"1rem",color:"#f59e0b",fill:"#f59e0b"}}),(0,o.jsxs)("span",{style:{fontSize:"0.875rem",fontWeight:"500",color:"#065f46"},children:["您的評價: ",e.review.rating,"/5"]})]}),(0,o.jsx)("div",{style:{fontSize:"0.875rem",color:"#065f46"},children:e.review.comment})]}),(0,o.jsxs)("div",{style:{display:"flex",gap:"0.75rem",flexWrap:"wrap"},children:["CONFIRMED"===e.status&&(0,o.jsx)("button",{onClick:()=>{T(e.id),D(!0)},style:{padding:"0.5rem 1rem",border:"1px solid #dc2626",borderRadius:"0.375rem",color:"#dc2626",backgroundColor:"white",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer",transition:"all 0.2s"},className:"hover:bg-red-50",children:"取消預訂"}),"completed"===e.status&&!e.review&&(0,o.jsxs)("button",{onClick:()=>{B(e.id),C(!0)},style:{padding:"0.5rem 1rem",background:"linear-gradient(to right, #2563eb, #4f46e5)",color:"white",border:"none",borderRadius:"0.375rem",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer",transition:"all 0.2s"},className:"hover:shadow-md",children:[(0,o.jsx)(g.Z,{style:{width:"0.875rem",height:"0.875rem",marginRight:"0.25rem",display:"inline"}}),"撰寫評價"]})]})]},e.id))})]}),Z&&(0,o.jsx)("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem",zIndex:50},children:(0,o.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"1rem",padding:"1.5rem",maxWidth:"28rem",width:"100%"},children:[(0,o.jsx)("h3",{style:{fontSize:"1.125rem",fontWeight:"600",color:"#111827",marginBottom:"1rem"},children:"取消預訂"}),(0,o.jsx)("p",{style:{color:"#6b7280",marginBottom:"1rem"},children:"您確定要取消這個預訂嗎？此操作無法撤銷。"}),(0,o.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,o.jsx)("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#374151",marginBottom:"0.5rem"},children:"取消原因 (選填)"}),(0,o.jsx)("textarea",{value:_,onChange:e=>F(e.target.value),placeholder:"請簡述取消原因...",style:{width:"100%",padding:"0.75rem",border:"1px solid #e5e7eb",borderRadius:"0.5rem",fontSize:"0.875rem",outline:"none",resize:"vertical",minHeight:"4rem"},className:"focus:border-blue-500 focus:ring-2 focus:ring-blue-200"})]}),(0,o.jsxs)("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[(0,o.jsx)("button",{onClick:()=>{D(!1),T(null),F("")},style:{padding:"0.5rem 1rem",border:"1px solid #e5e7eb",borderRadius:"0.375rem",color:"#374151",backgroundColor:"white",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer",transition:"all 0.2s"},className:"hover:bg-gray-50",children:"取消"}),(0,o.jsx)("button",{onClick:L,style:{padding:"0.5rem 1rem",backgroundColor:"#dc2626",color:"white",border:"none",borderRadius:"0.375rem",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer",transition:"all 0.2s"},className:"hover:bg-red-700",children:"確認取消"})]})]})}),S&&(0,o.jsx)("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem",zIndex:50},children:(0,o.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"1rem",padding:"1.5rem",maxWidth:"28rem",width:"100%"},children:[(0,o.jsx)("h3",{style:{fontSize:"1.125rem",fontWeight:"600",color:"#111827",marginBottom:"1rem"},children:"撰寫評價"}),(0,o.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,o.jsx)("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#374151",marginBottom:"0.5rem"},children:"評分"}),(0,o.jsx)("div",{style:{display:"flex",gap:"0.25rem"},children:[1,2,3,4,5].map(e=>(0,o.jsx)("button",{onClick:()=>N(e),style:{padding:"0.5rem",border:"none",backgroundColor:"transparent",cursor:"pointer"},children:(0,o.jsx)(g.Z,{style:{width:"1.5rem",height:"1.5rem",color:e<=W?"#f59e0b":"#e5e7eb",fill:e<=W?"#f59e0b":"none"}})},e))})]}),(0,o.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,o.jsx)("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#374151",marginBottom:"0.5rem"},children:"評價內容"}),(0,o.jsx)("textarea",{value:R,onChange:e=>I(e.target.value),placeholder:"分享您的體驗...",style:{width:"100%",padding:"0.75rem",border:"1px solid #e5e7eb",borderRadius:"0.5rem",fontSize:"0.875rem",outline:"none",resize:"vertical",minHeight:"6rem"},className:"focus:border-blue-500 focus:ring-2 focus:ring-blue-200"})]}),(0,o.jsxs)("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[(0,o.jsx)("button",{onClick:()=>{C(!1),B(null),N(5),I("")},style:{padding:"0.5rem 1rem",border:"1px solid #e5e7eb",borderRadius:"0.375rem",color:"#374151",backgroundColor:"white",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer",transition:"all 0.2s"},className:"hover:bg-gray-50",children:"取消"}),(0,o.jsx)("button",{onClick:A,disabled:!R.trim(),style:{padding:"0.5rem 1rem",background:R.trim()?"linear-gradient(to right, #2563eb, #4f46e5)":"#9ca3af",color:"white",border:"none",borderRadius:"0.375rem",fontSize:"0.875rem",fontWeight:"500",cursor:R.trim()?"pointer":"not-allowed",transition:"all 0.2s"},className:R.trim()?"hover:shadow-md":"",children:"提交評價"})]})]})})]}):(0,o.jsx)(f.gb,{})}},5554:function(e,r,t){"use strict";t.d(r,{L6:function(){return d},d8:function(){return l},us:function(){return s}});var o=t(7437),i=t(4033),n=t(1291);function l(e){let{showBackButton:r=!1,backButtonText:t="返回",showHomeButton:l=!0,homeButtonText:s="回到首頁",customBackAction:d}=e,a=(0,i.useRouter)();return(0,o.jsxs)(o.Fragment,{children:[l&&(0,o.jsx)("div",{style:{position:"absolute",top:"1rem",left:"1rem",zIndex:50},className:"sm:top-8 sm:left-8",children:(0,o.jsxs)("button",{onClick:()=>{a.push("/")},style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0.75rem",backgroundColor:"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(10px)",borderRadius:"0.5rem",border:"1px solid rgba(255, 255, 255, 0.3)",cursor:"pointer",transition:"all 0.2s",fontSize:"0.75rem",fontWeight:"500",color:"#374151",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)"},className:"hover:bg-white hover:shadow-md sm:text-sm sm:px-4 sm:py-3",children:[(0,o.jsxs)("span",{className:"hidden sm:inline",children:["← ",s]}),(0,o.jsx)("span",{className:"sm:hidden",children:"← 首頁"})]})}),r&&(0,o.jsx)("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"1rem 1.5rem",paddingTop:l?"4rem":"1rem"},children:(0,o.jsxs)("button",{onClick:()=>{d?d():a.back()},style:{display:"flex",alignItems:"center",gap:"0.5rem",color:"#6b7280",background:"none",border:"none",cursor:"pointer",fontSize:"0.875rem",transition:"color 0.2s",padding:"0.5rem 0"},className:"hover:text-gray-900",children:[(0,o.jsx)(n.Z,{style:{width:"1.25rem",height:"1.25rem"}}),(0,o.jsx)("span",{children:t})]})})]})}function s(e){let{text:r="回到首頁"}=e;return(0,o.jsx)(l,{showHomeButton:!0,homeButtonText:r,showBackButton:!1})}function d(e){let{backButtonText:r="返回",homeButtonText:t="回到首頁",customBackAction:i}=e;return(0,o.jsx)(l,{showHomeButton:!0,showBackButton:!0,backButtonText:r,homeButtonText:t,customBackAction:i})}}},function(e){e.O(0,[1216,1424,1744],function(){return e(e.s=4164)}),_N_E=e.O()}]);