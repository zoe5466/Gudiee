(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4604],{7070:function(e,r,t){Promise.resolve().then(t.bind(t,3878))},3878:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return v}});var i=t(7437),s=t(2265),o=t(4033),n=t(8203),l=t(6141),d=t(1298),a=t(2245),c=t(9883),m=t(9670),h=t(9617),g=t(3008),x=t(5790),p=t(5750),f=t(8228),u=t(4477),b=t(5554),y=t(5022),j=t(7722);function v(){let e=(0,o.useRouter)(),{isAuthenticated:r,user:t}=(0,f.a)(),{bookings:v,fetchBookings:w,isLoading:k}=(0,u.v)(),[S,z]=(0,s.useState)("overview"),[C,B]=(0,s.useState)({totalBookings:0,pendingBookings:0,totalEarnings:0,averageRating:0,totalReviews:0,servicesCount:0});return(0,s.useEffect)(()=>{if(!r){e.push("/login?redirect=/guide-dashboard");return}if((null==t?void 0:t.role)!=="guide"){e.push("/");return}w()},[r,t,e,w]),(0,s.useEffect)(()=>{if(v.length>0){let e=v.filter(e=>e.guideId===(null==t?void 0:t.id)),r=e.reduce((e,r)=>"completed"===r.payment.status?e+r.pricing.total:e,0);B({totalBookings:e.length,pendingBookings:e.filter(e=>"pending"===e.status).length,totalEarnings:r,averageRating:4.8,totalReviews:25,servicesCount:3})}},[v,t]),r&&(null==t?void 0:t.role)==="guide"?(0,i.jsxs)("div",{style:{minHeight:"100vh",background:"linear-gradient(to bottom right, #dbeafe, #ffffff, #e0e7ff)",paddingTop:"2rem",paddingBottom:"2rem"},children:[(0,i.jsx)(b.L6,{}),(0,i.jsxs)("div",{style:{maxWidth:"80rem",margin:"0 auto",padding:"0 1rem"},children:[(0,i.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,i.jsx)("h1",{style:{fontSize:"2rem",fontWeight:"700",color:"#111827",marginBottom:"0.5rem"},children:"導遊控制台"}),(0,i.jsx)("p",{style:{color:"#6b7280"},children:"管理您的服務、預訂和收入"})]}),(0,i.jsx)("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"2rem",flexWrap:"wrap"},children:[{key:"overview",label:"總覽",icon:x.Z},{key:"services",label:"我的服務",icon:p.Z},{key:"bookings",label:"預訂管理",icon:n.Z},{key:"reviews",label:"評價管理",icon:a.Z},{key:"earnings",label:"收入統計",icon:d.Z}].map(e=>{let r=e.icon;return(0,i.jsxs)("button",{onClick:()=>z(e.key),style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 1rem",borderRadius:"0.5rem",fontSize:"0.875rem",fontWeight:"500",border:"1px solid",cursor:"pointer",transition:"all 0.2s",...S===e.key?{backgroundColor:"#2563eb",borderColor:"#2563eb",color:"white"}:{backgroundColor:"white",borderColor:"#e5e7eb",color:"#374151"}},className:S!==e.key?"hover:bg-gray-50":"",children:[(0,i.jsx)(r,{style:{width:"1rem",height:"1rem"}}),e.label]},e.key)})}),(0,i.jsxs)("div",{children:["overview"===S&&(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem",marginBottom:"2rem"},children:[(0,i.jsxs)("div",{style:{backgroundColor:"white",padding:"1.5rem",borderRadius:"1rem",border:"1px solid #e5e7eb",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1rem"},children:[(0,i.jsx)("h3",{style:{fontSize:"0.875rem",fontWeight:"500",color:"#6b7280"},children:"總預訂數"}),(0,i.jsx)(n.Z,{style:{width:"1.25rem",height:"1.25rem",color:"#3b82f6"}})]}),(0,i.jsx)("div",{style:{fontSize:"2rem",fontWeight:"700",color:"#111827"},children:C.totalBookings}),(0,i.jsx)("div",{style:{fontSize:"0.875rem",color:"#10b981"},children:"+12% 較上月"})]}),(0,i.jsxs)("div",{style:{backgroundColor:"white",padding:"1.5rem",borderRadius:"1rem",border:"1px solid #e5e7eb",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1rem"},children:[(0,i.jsx)("h3",{style:{fontSize:"0.875rem",fontWeight:"500",color:"#6b7280"},children:"待確認預訂"}),(0,i.jsx)(l.Z,{style:{width:"1.25rem",height:"1.25rem",color:"#f59e0b"}})]}),(0,i.jsx)("div",{style:{fontSize:"2rem",fontWeight:"700",color:"#111827"},children:C.pendingBookings}),(0,i.jsx)("div",{style:{fontSize:"0.875rem",color:"#f59e0b"},children:"需要處理"})]}),(0,i.jsxs)("div",{style:{backgroundColor:"white",padding:"1.5rem",borderRadius:"1rem",border:"1px solid #e5e7eb",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1rem"},children:[(0,i.jsx)("h3",{style:{fontSize:"0.875rem",fontWeight:"500",color:"#6b7280"},children:"總收入"}),(0,i.jsx)(d.Z,{style:{width:"1.25rem",height:"1.25rem",color:"#10b981"}})]}),(0,i.jsxs)("div",{style:{fontSize:"2rem",fontWeight:"700",color:"#111827"},children:["NT$ ",C.totalEarnings.toLocaleString()]}),(0,i.jsx)("div",{style:{fontSize:"0.875rem",color:"#10b981"},children:"+8% 較上月"})]}),(0,i.jsxs)("div",{style:{backgroundColor:"white",padding:"1.5rem",borderRadius:"1rem",border:"1px solid #e5e7eb",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1rem"},children:[(0,i.jsx)("h3",{style:{fontSize:"0.875rem",fontWeight:"500",color:"#6b7280"},children:"平均評分"}),(0,i.jsx)(a.Z,{style:{width:"1.25rem",height:"1.25rem",color:"#f59e0b"}})]}),(0,i.jsx)("div",{style:{fontSize:"2rem",fontWeight:"700",color:"#111827"},children:C.averageRating}),(0,i.jsxs)("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:[C.totalReviews," 則評價"]})]})]}),"services"===S&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem"},children:[(0,i.jsx)("h2",{style:{fontSize:"1.5rem",fontWeight:"600",color:"#111827"},children:"我的服務"}),(0,i.jsxs)("button",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.75rem 1rem",background:"linear-gradient(to right, #2563eb, #4f46e5)",color:"white",border:"none",borderRadius:"0.5rem",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer",transition:"all 0.2s"},className:"hover:shadow-lg",children:[(0,i.jsx)(c.Z,{style:{width:"1rem",height:"1rem"}}),"新增服務"]})]}),(0,i.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(350px, 1fr))",gap:"1.5rem"},children:[{id:"1",title:"台北101 & 信義區深度導覽",image:"https://images.unsplash.com/photo-1508150492017-3d1e63ecdfc5?w=400&h=300&fit=crop",price:800,duration:"4小時",status:"active",bookings:15,rating:4.9,lastBooked:"2024-01-15"},{id:"2",title:"九份老街文化巡禮",image:"https://images.unsplash.com/photo-1549813069-f95e44d7f498?w=400&h=300&fit=crop",price:1200,duration:"6小時",status:"active",bookings:8,rating:4.7,lastBooked:"2024-01-12"}].map(e=>(0,i.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"1rem",border:"1px solid #e5e7eb",overflow:"hidden",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[(0,i.jsx)("img",{src:e.image,alt:e.title,style:{width:"100%",height:"12rem",objectFit:"cover"}}),(0,i.jsxs)("div",{style:{padding:"1.5rem"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1rem"},children:[(0,i.jsx)("h3",{style:{fontSize:"1.125rem",fontWeight:"600",color:"#111827",flex:1},children:e.title}),(0,i.jsx)("span",{style:{padding:"0.25rem 0.5rem",backgroundColor:"active"===e.status?"#dcfce7":"#fef3c7",color:"active"===e.status?"#166534":"#92400e",borderRadius:"9999px",fontSize:"0.75rem",fontWeight:"500"},children:"active"===e.status?"上架中":"暫停"})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1rem",fontSize:"0.875rem",color:"#6b7280"},children:[(0,i.jsxs)("div",{children:["價格: NT$ ",e.price]}),(0,i.jsxs)("div",{children:["時長: ",e.duration]}),(0,i.jsxs)("div",{children:["預訂: ",e.bookings," 次"]}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[(0,i.jsx)(a.Z,{style:{width:"0.875rem",height:"0.875rem",fill:"#f59e0b",color:"#f59e0b"}}),e.rating]})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},children:[(0,i.jsxs)("button",{style:{flex:1,padding:"0.5rem 1rem",border:"1px solid #e5e7eb",borderRadius:"0.375rem",color:"#374151",backgroundColor:"white",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer",transition:"all 0.2s"},className:"hover:bg-gray-50",children:[(0,i.jsx)(m.Z,{style:{width:"0.875rem",height:"0.875rem",marginRight:"0.25rem",display:"inline"}}),"查看"]}),(0,i.jsxs)("button",{style:{flex:1,padding:"0.5rem 1rem",border:"1px solid #e5e7eb",borderRadius:"0.375rem",color:"#374151",backgroundColor:"white",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer",transition:"all 0.2s"},className:"hover:bg-gray-50",children:[(0,i.jsx)(h.Z,{style:{width:"0.875rem",height:"0.875rem",marginRight:"0.25rem",display:"inline"}}),"編輯"]})]})]})]},e.id))})]}),"bookings"===S&&(()=>{let e=v.filter(e=>e.guideId===(null==t?void 0:t.id));return(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{style:{fontSize:"1.5rem",fontWeight:"600",color:"#111827",marginBottom:"2rem"},children:"預訂管理"}),0===e.length?(0,i.jsxs)("div",{style:{textAlign:"center",padding:"3rem",backgroundColor:"white",borderRadius:"1rem"},children:[(0,i.jsx)(n.Z,{style:{width:"3rem",height:"3rem",color:"#9ca3af",margin:"0 auto 1rem"}}),(0,i.jsx)("h3",{style:{fontSize:"1.125rem",fontWeight:"600",color:"#111827",marginBottom:"0.5rem"},children:"暫無預訂"}),(0,i.jsx)("p",{style:{color:"#6b7280"},children:"等待客戶預訂您的服務"})]}):(0,i.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:e.map(e=>(0,i.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"1rem",padding:"1.5rem",border:"1px solid #e5e7eb",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1rem"},children:[(0,i.jsxs)("div",{style:{flex:1},children:[(0,i.jsxs)("h3",{style:{fontSize:"1.125rem",fontWeight:"600",color:"#111827",marginBottom:"0.5rem"},children:["預訂 #",e.id]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"0.75rem",fontSize:"0.875rem",color:"#6b7280"},children:[(0,i.jsxs)("div",{children:["日期: ",new Date(e.details.date).toLocaleDateString("zh-TW")]}),(0,i.jsxs)("div",{children:["時間: ",e.details.time]}),(0,i.jsxs)("div",{children:["人數: ",e.details.guests," 人"]}),(0,i.jsxs)("div",{children:["聯絡人: ",e.details.contactInfo.name]})]})]}),(0,i.jsxs)("div",{style:{textAlign:"right"},children:[(0,i.jsxs)("div",{style:{fontSize:"1.25rem",fontWeight:"700",color:"#111827"},children:["NT$ ",e.pricing.total.toLocaleString()]}),(0,i.jsx)("span",{style:{padding:"0.25rem 0.5rem",backgroundColor:"confirmed"===e.status?"#dcfce7":"#fef3c7",color:"confirmed"===e.status?"#166534":"#92400e",borderRadius:"9999px",fontSize:"0.75rem",fontWeight:"500"},children:"pending"===e.status?"待確認":"confirmed"===e.status?"已確認":"已完成"})]})]}),"pending"===e.status&&(0,i.jsxs)("div",{style:{display:"flex",gap:"0.75rem",marginTop:"1rem"},children:[(0,i.jsxs)("button",{style:{padding:"0.5rem 1rem",background:"linear-gradient(to right, #10b981, #059669)",color:"white",border:"none",borderRadius:"0.375rem",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer",transition:"all 0.2s"},className:"hover:shadow-md",children:[(0,i.jsx)(g.Z,{style:{width:"0.875rem",height:"0.875rem",marginRight:"0.25rem",display:"inline"}}),"確認預訂"]}),(0,i.jsx)("button",{style:{padding:"0.5rem 1rem",border:"1px solid #dc2626",borderRadius:"0.375rem",color:"#dc2626",backgroundColor:"white",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer",transition:"all 0.2s"},className:"hover:bg-red-50",children:"拒絕預訂"})]})]},e.id))})]})})(),"reviews"===S&&(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{style:{fontSize:"1.5rem",fontWeight:"600",color:"#111827",marginBottom:"2rem"},children:"評價管理"}),(0,i.jsx)(j.n,{guideId:null==t?void 0:t.id,showDetails:!0,className:"mb-4"})]}),"earnings"===S&&(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{style:{fontSize:"1.5rem",fontWeight:"600",color:"#111827",marginBottom:"2rem"},children:"收入統計"}),(0,i.jsx)("div",{style:{backgroundColor:"white",padding:"2rem",borderRadius:"1rem",border:"1px solid #e5e7eb"},children:(0,i.jsx)("p",{style:{color:"#6b7280",textAlign:"center"},children:"收入統計功能開發中..."})})]})]})]})]}):(0,i.jsx)(y.gb,{})}},5554:function(e,r,t){"use strict";t.d(r,{L6:function(){return d},d8:function(){return n},us:function(){return l}});var i=t(7437),s=t(4033),o=t(1291);function n(e){let{showBackButton:r=!1,backButtonText:t="返回",showHomeButton:n=!0,homeButtonText:l="回到首頁",customBackAction:d}=e,a=(0,s.useRouter)();return(0,i.jsxs)(i.Fragment,{children:[n&&(0,i.jsx)("div",{style:{position:"absolute",top:"1rem",left:"1rem",zIndex:50},className:"sm:top-8 sm:left-8",children:(0,i.jsxs)("button",{onClick:()=>{a.push("/")},style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0.75rem",backgroundColor:"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(10px)",borderRadius:"0.5rem",border:"1px solid rgba(255, 255, 255, 0.3)",cursor:"pointer",transition:"all 0.2s",fontSize:"0.75rem",fontWeight:"500",color:"#374151",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)"},className:"hover:bg-white hover:shadow-md sm:text-sm sm:px-4 sm:py-3",children:[(0,i.jsxs)("span",{className:"hidden sm:inline",children:["← ",l]}),(0,i.jsx)("span",{className:"sm:hidden",children:"← 首頁"})]})}),r&&(0,i.jsx)("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"1rem 1.5rem",paddingTop:n?"4rem":"1rem"},children:(0,i.jsxs)("button",{onClick:()=>{d?d():a.back()},style:{display:"flex",alignItems:"center",gap:"0.5rem",color:"#6b7280",background:"none",border:"none",cursor:"pointer",fontSize:"0.875rem",transition:"color 0.2s",padding:"0.5rem 0"},className:"hover:text-gray-900",children:[(0,i.jsx)(o.Z,{style:{width:"1.25rem",height:"1.25rem"}}),(0,i.jsx)("span",{children:t})]})})]})}function l(e){let{text:r="回到首頁"}=e;return(0,i.jsx)(n,{showHomeButton:!0,homeButtonText:r,showBackButton:!1})}function d(e){let{backButtonText:r="返回",homeButtonText:t="回到首頁",customBackAction:s}=e;return(0,i.jsx)(n,{showHomeButton:!0,showBackButton:!0,backButtonText:r,homeButtonText:t,customBackAction:s})}},7722:function(e,r,t){"use strict";t.d(r,{n:function(){return l}});var i=t(7437),s=t(2265),o=t(2245),n=t(5750);function l(e){let{serviceId:r,guideId:t,className:l="",showDetails:d=!1}=e,[a,c]=(0,s.useState)(null),[m,h]=(0,s.useState)(!0);(0,s.useEffect)(()=>{g()},[r,t]);let g=async()=>{try{h(!0);let e=new URLSearchParams;r&&e.append("serviceId",r),t&&e.append("guideId",t),e.append("limit","1");let i=await fetch("/api/reviews?".concat(e.toString()));if(!i.ok)throw Error("獲取評價統計失敗");let s=await i.json();c(s.statistics)}catch(e){}finally{h(!1)}};return m?(0,i.jsx)("div",{className:l,children:(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,i.jsx)("div",{style:{width:"5rem",height:"1rem",backgroundColor:"#e5e7eb",borderRadius:"0.25rem"}}),(0,i.jsx)("div",{style:{width:"3rem",height:"1rem",backgroundColor:"#e5e7eb",borderRadius:"0.25rem"}})]})}):a?(0,i.jsx)("div",{className:l,children:0===a.totalReviews?(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",color:"#6b7280",fontSize:"0.875rem"},children:[(0,i.jsx)(o.Z,{style:{width:"1rem",height:"1rem"}}),(0,i.jsx)("span",{children:"暫無評價"})]}):(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"md",t={sm:"w-3 h-3",md:"w-4 h-4"};return(0,i.jsx)("div",{style:{display:"flex",gap:"0.125rem"},children:[1,2,3,4,5].map(s=>(0,i.jsx)(o.Z,{style:{color:s<=e?"#f59e0b":"#e5e7eb",fill:s<=e?"#f59e0b":"none"},className:t[r]},s))})}(Math.round(a.averageRating)),(0,i.jsx)("span",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#111827"},children:a.averageRating})]}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",color:"#6b7280",fontSize:"0.875rem"},children:[(0,i.jsx)(n.Z,{style:{width:"0.875rem",height:"0.875rem"}}),(0,i.jsxs)("span",{children:[a.totalReviews," 則評價"]})]}),d&&(0,i.jsx)("div",{style:{display:"flex",gap:"0.5rem",fontSize:"0.75rem",color:"#6b7280"},children:[5,4,3,2,1].map(e=>(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.125rem"},children:[(0,i.jsxs)("span",{children:[e,"★"]}),(0,i.jsxs)("span",{children:["(",a.ratingDistribution[e],")"]})]},e))})]})}):null}}},function(e){e.O(0,[1216,1424,1744],function(){return e(e.s=7070)}),_N_E=e.O()}]);