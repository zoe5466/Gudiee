(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1069],{5943:function(e,t,r){Promise.resolve().then(r.bind(r,7795))},7795:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return u}});var n=r(7437),i=r(2265),o=r(3067),s=r(9883),a=r(1827),l=r(2176),d=r(5554),c=r(6828),m=r(8228);function u(){let{user:e}=(0,m.a)(),[t,r]=(0,i.useState)(null),[u,h]=(0,i.useState)(""),[g,x]=(0,i.useState)([]);(0,i.useEffect)(()=>{e&&x([{id:"guide-001",name:"張小明導遊",lastMessage:"您好！我已經安排好明天的行程，期待與您見面！",lastMessageTime:new Date(Date.now()-3e5),unreadCount:2,role:"guide",isOnline:!0},{id:"traveler-001",name:"李大華",lastMessage:"謝謝您的服務，這次旅行非常愉快！",lastMessageTime:new Date(Date.now()-72e5),unreadCount:0,role:"traveler",isOnline:!1},{id:"guide-002",name:"王美麗導遊",lastMessage:"下次有機會歡迎再來台灣！",lastMessageTime:new Date(Date.now()-864e5),unreadCount:0,role:"guide",isOnline:!0},{id:"support",name:"客服中心",lastMessage:"您的問題已經解決了嗎？如有其他需要請隨時聯繫我們。",lastMessageTime:new Date(Date.now()-2592e5),unreadCount:0,role:"support",isOnline:!0}])},[e]);let p=g.filter(e=>e.name.toLowerCase().includes(u.toLowerCase())),f=e=>{let t=new Date().getTime()-e.getTime(),r=Math.floor(t/6e4),n=Math.floor(t/36e5),i=Math.floor(t/864e5);return r<60?"".concat(r," 分鐘前"):n<24?"".concat(n," 小時前"):i<7?"".concat(i," 天前"):new Intl.DateTimeFormat("zh-TW",{month:"short",day:"numeric"}).format(e)},b=e=>{switch(e){case"guide":return"#10b981";case"support":return"#3b82f6";default:return"#6b7280"}};return e?(0,n.jsxs)("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"1rem"},children:[(0,n.jsxs)("div",{style:{maxWidth:"1200px",margin:"0 auto",backgroundColor:"white",borderRadius:"0.5rem",overflow:"hidden",height:"90vh",display:"flex"},children:[(0,n.jsxs)("div",{style:{width:t?"350px":"100%",borderRight:t?"1px solid #e5e7eb":"none",display:"flex",flexDirection:"column",transition:"width 0.3s ease"},children:[(0,n.jsxs)("div",{style:{padding:"1rem",borderBottom:"1px solid #e5e7eb",backgroundColor:"#f8fafc"},children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1rem"},children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,n.jsx)("button",{onClick:()=>r(null),style:{padding:"0.5rem",backgroundColor:"transparent",border:"none",borderRadius:"0.25rem",cursor:"pointer",display:t?"flex":"none",alignItems:"center",justifyContent:"center"},className:"hover:bg-gray-200",children:(0,n.jsx)(o.Z,{style:{width:"1.25rem",height:"1.25rem",color:"#6b7280"}})}),(0,n.jsx)("h1",{style:{fontSize:"1.25rem",fontWeight:"600",color:"#111827"},children:"聊天室"})]}),(0,n.jsx)("button",{style:{padding:"0.5rem",backgroundColor:"transparent",border:"none",borderRadius:"0.25rem",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},className:"hover:bg-gray-200",children:(0,n.jsx)(s.Z,{style:{width:"1.25rem",height:"1.25rem",color:"#6b7280"}})})]}),(0,n.jsxs)("div",{style:{position:"relative"},children:[(0,n.jsx)(a.Z,{style:{position:"absolute",left:"0.75rem",top:"50%",transform:"translateY(-50%)",width:"1rem",height:"1rem",color:"#9ca3af"}}),(0,n.jsx)("input",{type:"text",placeholder:"搜尋聊天室...",value:u,onChange:e=>h(e.target.value),style:{width:"100%",padding:"0.75rem 0.75rem 0.75rem 2.5rem",border:"1px solid #e5e7eb",borderRadius:"0.5rem",fontSize:"0.875rem",backgroundColor:"white",outline:"none"},className:"focus:border-blue-500 focus:ring-1 focus:ring-blue-500"})]})]}),(0,n.jsx)("div",{style:{flex:1,overflowY:"auto"},children:0===p.length?(0,n.jsxs)("div",{style:{padding:"2rem",textAlign:"center",color:"#6b7280"},children:[(0,n.jsx)(l.Z,{style:{width:"3rem",height:"3rem",margin:"0 auto 1rem",color:"#d1d5db"}}),(0,n.jsx)("p",{children:"尚無聊天記錄"})]}):p.map(e=>(0,n.jsx)("div",{onClick:()=>r(e),style:{padding:"1rem",borderBottom:"1px solid #f3f4f6",cursor:"pointer",backgroundColor:(null==t?void 0:t.id)===e.id?"#f0f9ff":"transparent",transition:"all 0.2s"},className:"hover:bg-gray-50",children:(0,n.jsxs)("div",{style:{display:"flex",gap:"0.75rem"},children:[(0,n.jsxs)("div",{style:{position:"relative"},children:[(0,n.jsx)("div",{style:{width:"3rem",height:"3rem",backgroundColor:e.avatar?"transparent":"#e5e7eb",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.125rem",fontWeight:"600",color:"#6b7280",backgroundImage:e.avatar?"url(".concat(e.avatar,")"):void 0,backgroundSize:"cover",backgroundPosition:"center"},children:!e.avatar&&e.name.charAt(0).toUpperCase()}),e.isOnline&&(0,n.jsx)("div",{style:{position:"absolute",bottom:"0.125rem",right:"0.125rem",width:"0.75rem",height:"0.75rem",backgroundColor:"#10b981",borderRadius:"50%",border:"2px solid white"}}),(0,n.jsx)("div",{style:{position:"absolute",top:"-0.25rem",right:"-0.25rem",width:"1rem",height:"1rem",backgroundColor:b(e.role),borderRadius:"50%",border:"2px solid white"}})]}),(0,n.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"0.25rem"},children:[(0,n.jsx)("div",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#111827",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.name}),(0,n.jsx)("div",{style:{fontSize:"0.75rem",color:"#9ca3af",flexShrink:0},children:f(e.lastMessageTime)})]}),(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,n.jsx)("div",{style:{fontSize:"0.75rem",color:"#6b7280",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",flex:1},children:e.lastMessage}),e.unreadCount>0&&(0,n.jsx)("div",{style:{width:"1.25rem",height:"1.25rem",backgroundColor:"#ef4444",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem",fontWeight:"600",color:"white",marginLeft:"0.5rem",flexShrink:0},children:e.unreadCount>9?"9+":e.unreadCount})]})]})]})},e.id))})]}),t?(0,n.jsx)("div",{style:{flex:1,display:"flex",flexDirection:"column"},children:(0,n.jsx)(c.f,{recipientId:t.id,recipientName:t.name,recipientAvatar:t.avatar,chatType:"support"===t.role?"customer_support":"guide_chat"})}):(0,n.jsx)("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f9fafb"},children:(0,n.jsxs)("div",{style:{textAlign:"center",color:"#6b7280"},children:[(0,n.jsx)(l.Z,{style:{width:"4rem",height:"4rem",margin:"0 auto 1rem",color:"#d1d5db"}}),(0,n.jsx)("h3",{style:{fontSize:"1.125rem",fontWeight:"600",marginBottom:"0.5rem"},children:"選擇一個聊天室"}),(0,n.jsx)("p",{children:"點擊左側聯絡人開始對話"})]})})]}),(0,n.jsx)("div",{style:{marginTop:"1rem"},children:(0,n.jsx)(d.d8,{showBackButton:!0,backButtonText:"返回首頁"})})]}):(0,n.jsx)("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"2rem",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,n.jsxs)("div",{style:{backgroundColor:"white",padding:"2rem",borderRadius:"0.5rem",textAlign:"center",maxWidth:"400px"},children:[(0,n.jsx)("h2",{style:{fontSize:"1.5rem",fontWeight:"600",marginBottom:"1rem"},children:"請先登入"}),(0,n.jsx)("p",{style:{color:"#6b7280",marginBottom:"1.5rem"},children:"您需要登入才能使用聊天功能"}),(0,n.jsx)(d.d8,{showBackButton:!0,backButtonText:"返回首頁"})]})})}},5554:function(e,t,r){"use strict";r.d(t,{L6:function(){return l},d8:function(){return s},us:function(){return a}});var n=r(7437),i=r(4033),o=r(1291);function s(e){let{showBackButton:t=!1,backButtonText:r="返回",showHomeButton:s=!0,homeButtonText:a="回到首頁",customBackAction:l}=e,d=(0,i.useRouter)();return(0,n.jsxs)(n.Fragment,{children:[s&&(0,n.jsx)("div",{style:{position:"absolute",top:"1rem",left:"1rem",zIndex:50},className:"sm:top-8 sm:left-8",children:(0,n.jsxs)("button",{onClick:()=>{d.push("/")},style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0.75rem",backgroundColor:"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(10px)",borderRadius:"0.5rem",border:"1px solid rgba(255, 255, 255, 0.3)",cursor:"pointer",transition:"all 0.2s",fontSize:"0.75rem",fontWeight:"500",color:"#374151",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)"},className:"hover:bg-white hover:shadow-md sm:text-sm sm:px-4 sm:py-3",children:[(0,n.jsxs)("span",{className:"hidden sm:inline",children:["← ",a]}),(0,n.jsx)("span",{className:"sm:hidden",children:"← 首頁"})]})}),t&&(0,n.jsx)("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"1rem 1.5rem",paddingTop:s?"4rem":"1rem"},children:(0,n.jsxs)("button",{onClick:()=>{l?l():d.back()},style:{display:"flex",alignItems:"center",gap:"0.5rem",color:"#6b7280",background:"none",border:"none",cursor:"pointer",fontSize:"0.875rem",transition:"color 0.2s",padding:"0.5rem 0"},className:"hover:text-gray-900",children:[(0,n.jsx)(o.Z,{style:{width:"1.25rem",height:"1.25rem"}}),(0,n.jsx)("span",{children:r})]})})]})}function a(e){let{text:t="回到首頁"}=e;return(0,n.jsx)(s,{showHomeButton:!0,homeButtonText:t,showBackButton:!1})}function l(e){let{backButtonText:t="返回",homeButtonText:r="回到首頁",customBackAction:i}=e;return(0,n.jsx)(s,{showHomeButton:!0,showBackButton:!0,backButtonText:t,homeButtonText:r,customBackAction:i})}}},function(e){e.O(0,[1216,6828,1744],function(){return e(e.s=5943)}),_N_E=e.O()}]);