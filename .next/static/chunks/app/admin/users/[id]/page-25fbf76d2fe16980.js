(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[214],{5749:function(e,s,a){Promise.resolve().then(a.bind(a,5575))},5575:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return b}});var t=a(7437),l=a(2265),i=a(4033),r=a(7045),c=a(5671),n=a(575),d=a(3277),x=a(1981),m=a(3067),o=a(9617),h=a(1195),j=a(9036),u=a(3008),f=a(2741),N=a(6142),p=a(1295),g=a(8203),v=a(2245),y=a(998);function b(){var e,s,a,b,w,C,Z,P,k;let S=(0,i.useRouter)(),D=(0,i.useParams)(),[A,T]=(0,l.useState)(null),[z,L]=(0,l.useState)(!0),[O,Y]=(0,l.useState)("");(0,l.useEffect)(()=>{D.id&&R(D.id)},[D.id]);let R=async e=>{try{let s=await fetch("/api/admin/users/".concat(e));if(s.ok){let e=await s.json();T(e)}else Y("無法獲取用戶詳細資料")}catch(e){Y("載入用戶資料時發生錯誤")}finally{L(!1)}},E=async e=>{if(A)try{(await fetch("/api/admin/users/".concat(A.id),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:e})})).ok&&R(A.id)}catch(e){}};return z?(0,t.jsx)(r.AdminLayout,{children:(0,t.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600",children:"載入中..."})]})})}):O||!A?(0,t.jsx)(r.AdminLayout,{children:(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)(x.Z,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"載入失敗"}),(0,t.jsx)("p",{className:"text-gray-600 mb-6",children:O||"找不到該用戶"}),(0,t.jsxs)(n.z,{onClick:()=>S.push("/admin/users"),children:[(0,t.jsx)(m.Z,{className:"h-4 w-4 mr-2"}),"返回用戶列表"]})]})}):(0,t.jsx)(r.AdminLayout,{children:(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("div",{className:"mb-8",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)(n.z,{variant:"outline",onClick:()=>S.push("/admin/users"),children:[(0,t.jsx)(m.Z,{className:"h-4 w-4 mr-2"}),"返回"]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:(null===(e=A.userProfile)||void 0===e?void 0:e.name)||A.name||"未設定姓名"}),(0,t.jsx)("p",{className:"text-gray-600 mt-1",children:"用戶詳細管理"})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsxs)(n.z,{variant:"outline",onClick:()=>E("edit"),children:[(0,t.jsx)(o.Z,{className:"h-4 w-4 mr-2"}),"編輯"]}),(0,t.jsxs)(n.z,{variant:"outline",onClick:()=>E("suspend"),children:[(0,t.jsx)(h.Z,{className:"h-4 w-4 mr-2"}),"停用"]}),"admin"!==A.role&&(0,t.jsxs)(n.z,{variant:"outline",onClick:()=>E("promote"),children:[(0,t.jsx)(j.Z,{className:"h-4 w-4 mr-2"}),"提升權限"]})]})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,t.jsxs)("div",{className:"lg:col-span-1 space-y-6",children:[(0,t.jsxs)(c.Zb,{children:[(0,t.jsx)(c.Ol,{children:(0,t.jsx)(c.ll,{children:"基本資料"})}),(0,t.jsxs)(c.aY,{children:[(0,t.jsxs)("div",{className:"text-center mb-6",children:[(0,t.jsx)("div",{className:"w-24 h-24 bg-gray-300 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)("span",{className:"text-2xl font-bold text-gray-600",children:((null===(s=A.userProfile)||void 0===s?void 0:s.name)||A.name||A.email)[0].toUpperCase()})}),(0,t.jsx)("h3",{className:"text-lg font-semibold",children:(null===(a=A.userProfile)||void 0===a?void 0:a.name)||A.name||"未設定"}),(0,t.jsx)("p",{className:"text-gray-600",children:A.email}),(0,t.jsx)("div",{className:"flex justify-center mt-2",children:(0,t.jsx)(d.Ct,{variant:{admin:"destructive",guide:"default",customer:"secondary"}[A.role]||"outline",children:{admin:"管理員",guide:"地陪",customer:"客戶"}[k=A.role]||k})})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between py-2 border-b",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"電子郵件驗證"}),A.isEmailVerified?(0,t.jsxs)(d.Ct,{variant:"success",children:[(0,t.jsx)(u.Z,{className:"h-3 w-3 mr-1"}),"已驗證"]}):(0,t.jsxs)(d.Ct,{variant:"destructive",children:[(0,t.jsx)(x.Z,{className:"h-3 w-3 mr-1"}),"未驗證"]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between py-2 border-b",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"身份驗證 (KYC)"}),A.isKycVerified?(0,t.jsxs)(d.Ct,{variant:"success",children:[(0,t.jsx)(u.Z,{className:"h-3 w-3 mr-1"}),"已通過"]}):(0,t.jsx)(d.Ct,{variant:"outline",children:"未驗證"})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between py-2 border-b",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"註冊時間"}),(0,t.jsx)("span",{className:"text-sm",children:new Date(A.createdAt).toLocaleDateString("zh-TW")})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between py-2",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"最後登入"}),(0,t.jsx)("span",{className:"text-sm",children:A.lastLoginAt?new Date(A.lastLoginAt).toLocaleDateString("zh-TW"):"從未登入"})]})]})]})]}),A.userProfile&&(0,t.jsxs)(c.Zb,{children:[(0,t.jsx)(c.Ol,{children:(0,t.jsx)(c.ll,{children:"聯絡資訊"})}),(0,t.jsxs)(c.aY,{className:"space-y-4",children:[A.userProfile.phone&&(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(f.Z,{className:"h-4 w-4 text-gray-400"}),(0,t.jsx)("span",{className:"text-sm",children:A.userProfile.phone})]}),A.userProfile.location&&(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(N.Z,{className:"h-4 w-4 text-gray-400"}),(0,t.jsx)("span",{className:"text-sm",children:A.userProfile.location})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(p.Z,{className:"h-4 w-4 text-gray-400"}),(0,t.jsx)("span",{className:"text-sm",children:A.email})]})]})]})]}),(0,t.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsx)(c.Zb,{children:(0,t.jsx)(c.aY,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"提供服務"}),(0,t.jsx)("p",{className:"text-2xl font-bold",children:(null===(b=A.stats)||void 0===b?void 0:b.servicesCount)||0})]}),(0,t.jsx)(N.Z,{className:"h-8 w-8 text-gray-400"})]})})}),(0,t.jsx)(c.Zb,{children:(0,t.jsx)(c.aY,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"預訂記錄"}),(0,t.jsx)("p",{className:"text-2xl font-bold",children:(null===(w=A.stats)||void 0===w?void 0:w.bookingsCount)||0})]}),(0,t.jsx)(g.Z,{className:"h-8 w-8 text-gray-400"})]})})}),(0,t.jsx)(c.Zb,{children:(0,t.jsx)(c.aY,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"評論數量"}),(0,t.jsx)("p",{className:"text-2xl font-bold",children:(null===(C=A.stats)||void 0===C?void 0:C.reviewsCount)||0})]}),(0,t.jsx)(v.Z,{className:"h-8 w-8 text-gray-400"})]})})})]}),A.userProfile&&(0,t.jsxs)(c.Zb,{children:[(0,t.jsx)(c.Ol,{children:(0,t.jsx)(c.ll,{children:"個人檔案"})}),(0,t.jsxs)(c.aY,{className:"space-y-6",children:[A.userProfile.bio&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-gray-600 mb-2",children:"個人簡介"}),(0,t.jsx)("p",{className:"text-sm bg-gray-50 p-4 rounded-lg",children:A.userProfile.bio})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[A.userProfile.languages&&A.userProfile.languages.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-gray-600 mb-2",children:"語言能力"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:A.userProfile.languages.map((e,s)=>(0,t.jsx)(d.Ct,{variant:"secondary",children:e},s))})]}),A.userProfile.specialties&&A.userProfile.specialties.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-gray-600 mb-2",children:"專業領域"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:A.userProfile.specialties.map((e,s)=>(0,t.jsx)(d.Ct,{variant:"outline",children:e},s))})]})]}),A.userProfile.certifications&&A.userProfile.certifications.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-gray-600 mb-2",children:"認證資格"}),(0,t.jsx)("div",{className:"space-y-2",children:A.userProfile.certifications.map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center p-3 bg-green-50 rounded-lg",children:[(0,t.jsx)(u.Z,{className:"h-4 w-4 text-green-500 mr-2"}),(0,t.jsx)("span",{className:"text-sm text-green-700",children:e})]},s))})]})]})]}),(0,t.jsxs)(c.Zb,{children:[(0,t.jsx)(c.Ol,{children:(0,t.jsxs)(c.ll,{className:"flex items-center",children:[(0,t.jsx)(y.Z,{className:"h-5 w-5 mr-2"}),"最近活動"]})}),(0,t.jsx)(c.aY,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[A.recentServices&&A.recentServices.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-gray-600 mb-3",children:"最近提供的服務"}),(0,t.jsx)("div",{className:"space-y-2",children:A.recentServices.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:e.title}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:new Date(e.createdAt).toLocaleDateString("zh-TW")})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)(d.Ct,{variant:"APPROVED"===e.status?"success":"outline",children:e.status}),(0,t.jsxs)("p",{className:"text-xs text-gray-600 mt-1",children:["NT$ ",e.price]})]})]},e.id))})]}),A.recentBookings&&A.recentBookings.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-gray-600 mb-3",children:"最近預訂記錄"}),(0,t.jsx)("div",{className:"space-y-2",children:A.recentBookings.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:e.serviceTitle}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:new Date(e.bookingDate).toLocaleDateString("zh-TW")})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)(d.Ct,{variant:"secondary",children:e.status}),(0,t.jsxs)("p",{className:"text-xs text-gray-600 mt-1",children:["NT$ ",e.totalAmount]})]})]},e.id))})]}),!(null===(Z=A.recentServices)||void 0===Z?void 0:Z.length)&&!(null===(P=A.recentBookings)||void 0===P?void 0:P.length)&&(0,t.jsxs)("div",{className:"text-center text-gray-500 py-8",children:[(0,t.jsx)(y.Z,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),(0,t.jsx)("p",{children:"暫無最近活動記錄"})]})]})})]})]})]})]})})}},5671:function(e,s,a){"use strict";a.d(s,{Ol:function(){return c},SZ:function(){return d},Zb:function(){return r},aY:function(){return x},ll:function(){return n}});var t=a(7437),l=a(2265),i=a(2169);let r=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("div",{ref:s,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...l})});r.displayName="Card";let c=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("div",{ref:s,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",a),...l})});c.displayName="CardHeader";let n=l.forwardRef((e,s)=>{let{className:a,children:l,...r}=e;return(0,t.jsx)("h3",{ref:s,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",a),...r,children:l})});n.displayName="CardTitle";let d=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("p",{ref:s,className:(0,i.cn)("text-sm text-muted-foreground",a),...l})});d.displayName="CardDescription";let x=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("div",{ref:s,className:(0,i.cn)("p-6 pt-0",a),...l})});x.displayName="CardContent",l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("div",{ref:s,className:(0,i.cn)("flex items-center p-6 pt-0",a),...l})}).displayName="CardFooter"}},function(e){e.O(0,[1216,4784,7045,1744],function(){return e(e.s=5749)}),_N_E=e.O()}]);