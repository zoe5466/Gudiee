(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7838],{9928:function(e,s,a){Promise.resolve().then(a.bind(a,5985))},5985:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return g}});var l=a(7437),t=a(2265),r=a(4033),i=a(7045),n=a(5671),c=a(575),d=a(3277),x=a(2782),o=a(6142),m=a(1827),u=a(6141),h=a(2442),f=a(1298),j=a(5750),N=a(2245),p=a(9670),v=a(2549);function g(){let e=(0,r.useRouter)(),[s,a]=(0,t.useState)([]),[g,b]=(0,t.useState)([]),[y,w]=(0,t.useState)(!0),[C,E]=(0,t.useState)(""),[Z,k]=(0,t.useState)("all");(0,t.useEffect)(()=>{S()},[]),(0,t.useEffect)(()=>{D()},[s,C,Z]);let S=async()=>{try{let e=await fetch("/api/admin/services");if(e.ok){let s=await e.json();a(s)}}catch(e){}finally{w(!1)}},D=()=>{let e=s;C&&(e=e.filter(e=>{var s,a,l;return e.title.toLowerCase().includes(C.toLowerCase())||e.location.toLowerCase().includes(C.toLowerCase())||(null===(a=e.guide.userProfile)||void 0===a?void 0:null===(s=a.name)||void 0===s?void 0:s.toLowerCase().includes(C.toLowerCase()))||(null===(l=e.guide.name)||void 0===l?void 0:l.toLowerCase().includes(C.toLowerCase()))})),"all"!==Z&&(e=e.filter(e=>e.status.toLowerCase()===Z.toLowerCase())),b(e)},L=e=>({PENDING:"待審核",ACTIVE:"已上線",REJECTED:"已拒絕",SUSPENDED:"已暫停"})[e]||e,I=e=>({PENDING:"warning",ACTIVE:"default",REJECTED:"destructive",SUSPENDED:"secondary"})[e]||"outline",R=async(e,s)=>{try{(await fetch("/api/admin/services/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:s})})).ok&&S()}catch(e){}};return y?(0,l.jsx)(i.AdminLayout,{children:(0,l.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,l.jsx)("p",{className:"text-gray-600",children:"載入中..."})]})})}):(0,l.jsx)(i.AdminLayout,{children:(0,l.jsxs)("div",{className:"p-6",children:[(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsxs)("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:[(0,l.jsx)(o.Z,{className:"h-8 w-8 mr-3"}),"服務管理"]}),(0,l.jsx)("p",{className:"text-gray-600 mt-2",children:"審核和管理地陪服務項目"})]}),(0,l.jsxs)(n.Zb,{className:"mb-6",children:[(0,l.jsx)(n.Ol,{children:(0,l.jsx)(n.ll,{children:"搜索和篩選"})}),(0,l.jsx)(n.aY,{children:(0,l.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,l.jsx)("div",{className:"flex-1",children:(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(m.Z,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),(0,l.jsx)(x.I,{placeholder:"搜索服務 (標題、地點、地陪名稱)",value:C,onChange:e=>E(e.target.value),className:"pl-10"})]})}),(0,l.jsx)("div",{className:"md:w-48",children:(0,l.jsxs)("select",{value:Z,onChange:e=>k(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary",children:[(0,l.jsx)("option",{value:"all",children:"所有狀態"}),(0,l.jsx)("option",{value:"pending",children:"待審核"}),(0,l.jsx)("option",{value:"active",children:"已上線"}),(0,l.jsx)("option",{value:"rejected",children:"已拒絕"}),(0,l.jsx)("option",{value:"suspended",children:"已暫停"})]})})]})})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[(0,l.jsx)(n.Zb,{children:(0,l.jsx)(n.aY,{className:"pt-6",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"總服務數"}),(0,l.jsx)("p",{className:"text-2xl font-bold",children:s.length})]}),(0,l.jsx)(o.Z,{className:"h-8 w-8 text-gray-400"})]})})}),(0,l.jsx)(n.Zb,{children:(0,l.jsx)(n.aY,{className:"pt-6",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"待審核"}),(0,l.jsx)("p",{className:"text-2xl font-bold",children:s.filter(e=>"PENDING"===e.status).length})]}),(0,l.jsx)(u.Z,{className:"h-8 w-8 text-yellow-500"})]})})}),(0,l.jsx)(n.Zb,{children:(0,l.jsx)(n.aY,{className:"pt-6",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"已上線"}),(0,l.jsx)("p",{className:"text-2xl font-bold",children:s.filter(e=>"ACTIVE"===e.status).length})]}),(0,l.jsx)(h.Z,{className:"h-8 w-8 text-green-500"})]})})}),(0,l.jsx)(n.Zb,{children:(0,l.jsx)(n.aY,{className:"pt-6",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"平均價格"}),(0,l.jsxs)("p",{className:"text-2xl font-bold",children:["NT$ ",Math.round(s.reduce((e,s)=>e+s.price,0)/s.length||0)]})]}),(0,l.jsx)(f.Z,{className:"h-8 w-8 text-gray-400"})]})})})]}),(0,l.jsxs)(n.Zb,{children:[(0,l.jsxs)(n.Ol,{children:[(0,l.jsxs)(n.ll,{children:["服務列表 (",g.length,")"]}),(0,l.jsx)(n.SZ,{children:"點擊服務查看詳細資料，或使用操作按鈕審核服務"})]}),(0,l.jsx)(n.aY,{children:(0,l.jsxs)("div",{className:"space-y-4",children:[g.map(s=>{var a,t;return(0,l.jsxs)("div",{className:"flex items-start justify-between p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[(0,l.jsxs)("div",{className:"flex items-start space-x-4 flex-1",children:[(0,l.jsx)("div",{className:"w-20 h-20 bg-gray-200 rounded-lg overflow-hidden flex-shrink-0",children:(null===(a=s.images)||void 0===a?void 0:a[0])?(0,l.jsx)("img",{src:s.images[0],alt:s.title,className:"w-full h-full object-cover"}):(0,l.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,l.jsx)(o.Z,{className:"h-8 w-8 text-gray-400"})})}),(0,l.jsx)("div",{className:"flex-1",children:(0,l.jsx)("div",{className:"flex items-start justify-between",children:(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:s.title}),(0,l.jsx)(d.Ct,{variant:I(s.status),className:"text-xs",children:L(s.status)})]}),(0,l.jsx)("p",{className:"text-sm text-gray-600 mb-2 line-clamp-2",children:s.description}),(0,l.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-500 mb-2",children:[(0,l.jsxs)("span",{className:"flex items-center",children:[(0,l.jsx)(o.Z,{className:"h-4 w-4 mr-1"}),s.location]}),(0,l.jsxs)("span",{className:"flex items-center",children:[(0,l.jsx)(u.Z,{className:"h-4 w-4 mr-1"}),s.durationHours," 小時"]}),(0,l.jsxs)("span",{className:"flex items-center",children:[(0,l.jsx)(j.Z,{className:"h-4 w-4 mr-1"}),"最多 ",s.maxGuests," 人"]}),(0,l.jsxs)("span",{className:"flex items-center",children:[(0,l.jsx)(f.Z,{className:"h-4 w-4 mr-1"}),"NT$ ",s.price.toLocaleString()]})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-4 text-sm",children:[(0,l.jsxs)("span",{className:"text-gray-600",children:["地陪: ",(null===(t=s.guide.userProfile)||void 0===t?void 0:t.name)||s.guide.name]}),(0,l.jsxs)("span",{className:"text-gray-500",children:[s._count.bookings," 次預訂"]}),(0,l.jsxs)("span",{className:"text-gray-500",children:[s._count.reviews," 則評論"]}),s.averageRating&&(0,l.jsxs)("span",{className:"flex items-center text-yellow-600",children:[(0,l.jsx)(N.Z,{className:"h-4 w-4 mr-1 fill-current"}),s.averageRating.toFixed(1)]})]})]})})})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[(0,l.jsxs)(c.z,{variant:"outline",size:"sm",onClick:()=>e.push("/admin/services/".concat(s.id)),children:[(0,l.jsx)(p.Z,{className:"h-4 w-4 mr-1"}),"查看"]}),"PENDING"===s.status&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(c.z,{variant:"default",size:"sm",onClick:()=>R(s.id,"approve"),children:[(0,l.jsx)(h.Z,{className:"h-4 w-4 mr-1"}),"通過"]}),(0,l.jsxs)(c.z,{variant:"destructive",size:"sm",onClick:()=>R(s.id,"reject"),children:[(0,l.jsx)(v.Z,{className:"h-4 w-4 mr-1"}),"拒絕"]})]}),"ACTIVE"===s.status&&(0,l.jsx)(c.z,{variant:"outline",size:"sm",onClick:()=>R(s.id,"suspend"),children:"暫停"}),"SUSPENDED"===s.status&&(0,l.jsx)(c.z,{variant:"default",size:"sm",onClick:()=>R(s.id,"activate"),children:"啟用"})]})]},s.id)}),0===g.length&&(0,l.jsxs)("div",{className:"text-center py-8",children:[(0,l.jsx)(o.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,l.jsx)("p",{className:"text-gray-500",children:"沒有找到符合條件的服務"})]})]})})]})]})})}},5671:function(e,s,a){"use strict";a.d(s,{Ol:function(){return n},SZ:function(){return d},Zb:function(){return i},aY:function(){return x},ll:function(){return c}});var l=a(7437),t=a(2265),r=a(2169);let i=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,l.jsx)("div",{ref:s,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...t})});i.displayName="Card";let n=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,l.jsx)("div",{ref:s,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",a),...t})});n.displayName="CardHeader";let c=t.forwardRef((e,s)=>{let{className:a,children:t,...i}=e;return(0,l.jsx)("h3",{ref:s,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",a),...i,children:t})});c.displayName="CardTitle";let d=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,l.jsx)("p",{ref:s,className:(0,r.cn)("text-sm text-muted-foreground",a),...t})});d.displayName="CardDescription";let x=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,l.jsx)("div",{ref:s,className:(0,r.cn)("p-6 pt-0",a),...t})});x.displayName="CardContent",t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,l.jsx)("div",{ref:s,className:(0,r.cn)("flex items-center p-6 pt-0",a),...t})}).displayName="CardFooter"},2782:function(e,s,a){"use strict";a.d(s,{I:function(){return i}});var l=a(7437),t=a(2265),r=a(2169);let i=t.forwardRef((e,s)=>{let{className:a,type:i,error:n,label:c,icon:d,...x}=e,o=t.useId();return(0,l.jsxs)("div",{className:"space-y-2",children:[c&&(0,l.jsx)("label",{htmlFor:o,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:c}),(0,l.jsxs)("div",{className:"relative",children:[d&&(0,l.jsx)("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",children:d}),(0,l.jsx)("input",{id:o,type:i,className:(0,r.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",d&&"pl-10",n&&"border-destructive focus-visible:ring-destructive",a),ref:s,...x})]}),n&&(0,l.jsx)("p",{className:"text-sm text-destructive",children:n})]})});i.displayName="Input"}},function(e){e.O(0,[1216,4784,7045,1744],function(){return e(e.s=9928)}),_N_E=e.O()}]);