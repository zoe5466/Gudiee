(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2484],{4919:function(e,t,r){Promise.resolve().then(r.bind(r,7972))},7972:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return B}});var i=r(7437),n=r(2265),o=r(4033),s=r(4784),l=r(6637),a=r(9670),d=r(5790),c=r(2457),m=r(9409),u=r(8203),h=r(5554),g=r(9883),p=r(1827),b=r(9617),f=r(1138),x=r(4721),y=r(5890),j=r(17),v=r(7346),w=r(820),C=r(8438),k=r(4689),S=r(2455),z=r(2549),A=r(6245);function R(e){let{initialContent:t="",title:r="",onSave:o,onCancel:s,className:l=""}=e,[d,c]=(0,n.useState)(t),[m,u]=(0,n.useState)(r),[h,g]=(0,n.useState)(!1),[p,b]=(0,n.useState)(!1),f=(0,n.useRef)(null),R=e=>{let t=f.current;if(!t)return;let r=t.selectionStart,i=t.selectionEnd,n=d.substring(r,i),o=n;switch(e){case"bold":o="**".concat(n,"**");break;case"italic":o="*".concat(n,"*");break;case"underline":o="<u>".concat(n,"</u>");break;case"link":o="[".concat(n||"連結文字","](https://example.com)");break;case"image":o="![".concat(n||"圖片描述","](圖片網址)");break;case"list":o=n.split("\n").map(e=>e.trim()?"- ".concat(e):e).join("\n");break;case"heading":o="## ".concat(n||"標題");break;case"code":o="`".concat(n,"`")}c(d.substring(0,r)+o+d.substring(i)),setTimeout(()=>{t.focus();let e=r+o.length;t.setSelectionRange(e,e)},0)},T=async()=>{b(!0);try{await o(d,m)}catch(e){}finally{b(!1)}};return(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"600px",backgroundColor:"white",borderRadius:"0.5rem",border:"1px solid #e5e7eb",overflow:"hidden"},className:l,children:[(0,i.jsx)("div",{style:{padding:"1rem",borderBottom:"1px solid #e5e7eb"},children:(0,i.jsx)("input",{type:"text",placeholder:"輸入標題...",value:m,onChange:e=>u(e.target.value),style:{width:"100%",padding:"0.75rem",border:"1px solid #e5e7eb",borderRadius:"0.375rem",fontSize:"1.125rem",fontWeight:"600",outline:"none"},className:"focus:border-blue-500 focus:ring-1 focus:ring-blue-500"})}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.75rem 1rem",backgroundColor:"#f8fafc",borderBottom:"1px solid #e5e7eb",flexWrap:"wrap"},children:[(0,i.jsxs)("div",{style:{display:"flex",gap:"0.25rem"},children:[(0,i.jsx)("button",{onClick:()=>R("bold"),style:{padding:"0.5rem",backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"0.25rem",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},className:"hover:bg-gray-100",title:"粗體",children:(0,i.jsx)(x.Z,{style:{width:"1rem",height:"1rem"}})}),(0,i.jsx)("button",{onClick:()=>R("italic"),style:{padding:"0.5rem",backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"0.25rem",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},className:"hover:bg-gray-100",title:"斜體",children:(0,i.jsx)(y.Z,{style:{width:"1rem",height:"1rem"}})}),(0,i.jsx)("button",{onClick:()=>R("underline"),style:{padding:"0.5rem",backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"0.25rem",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},className:"hover:bg-gray-100",title:"底線",children:(0,i.jsx)(j.Z,{style:{width:"1rem",height:"1rem"}})})]}),(0,i.jsx)("div",{style:{width:"1px",height:"1.5rem",backgroundColor:"#e5e7eb"}}),(0,i.jsxs)("div",{style:{display:"flex",gap:"0.25rem"},children:[(0,i.jsx)("button",{onClick:()=>R("heading"),style:{padding:"0.5rem",backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"0.25rem",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},className:"hover:bg-gray-100",title:"標題",children:(0,i.jsx)(v.Z,{style:{width:"1rem",height:"1rem"}})}),(0,i.jsx)("button",{onClick:()=>R("link"),style:{padding:"0.5rem",backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"0.25rem",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},className:"hover:bg-gray-100",title:"連結",children:(0,i.jsx)(w.Z,{style:{width:"1rem",height:"1rem"}})}),(0,i.jsx)("button",{onClick:()=>R("image"),style:{padding:"0.5rem",backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"0.25rem",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},className:"hover:bg-gray-100",title:"圖片",children:(0,i.jsx)(C.Z,{style:{width:"1rem",height:"1rem"}})}),(0,i.jsx)("button",{onClick:()=>R("list"),style:{padding:"0.5rem",backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"0.25rem",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},className:"hover:bg-gray-100",title:"清單",children:(0,i.jsx)(k.Z,{style:{width:"1rem",height:"1rem"}})}),(0,i.jsx)("button",{onClick:()=>R("code"),style:{padding:"0.5rem",backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"0.25rem",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},className:"hover:bg-gray-100",title:"程式碼",children:(0,i.jsx)(S.Z,{style:{width:"1rem",height:"1rem"}})})]}),(0,i.jsx)("div",{style:{width:"1px",height:"1.5rem",backgroundColor:"#e5e7eb"}}),(0,i.jsxs)("button",{onClick:()=>g(!h),style:{padding:"0.5rem 1rem",backgroundColor:h?"#3b82f6":"white",color:h?"white":"#374151",border:"1px solid #e5e7eb",borderRadius:"0.25rem",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.875rem",fontWeight:"500"},className:"hover:bg-gray-100",children:[(0,i.jsx)(a.Z,{style:{width:"1rem",height:"1rem"}}),h?"編輯":"預覽"]}),(0,i.jsxs)("div",{style:{marginLeft:"auto",display:"flex",gap:"0.5rem"},children:[s&&(0,i.jsxs)("button",{onClick:s,style:{padding:"0.5rem 1rem",backgroundColor:"white",color:"#6b7280",border:"1px solid #e5e7eb",borderRadius:"0.375rem",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.875rem",fontWeight:"500"},className:"hover:bg-gray-50",children:[(0,i.jsx)(z.Z,{style:{width:"1rem",height:"1rem"}}),"取消"]}),(0,i.jsxs)("button",{onClick:T,disabled:p||!m.trim()||!d.trim(),style:{padding:"0.5rem 1rem",backgroundColor:m.trim()&&d.trim()?"#10b981":"#e5e7eb",color:m.trim()&&d.trim()?"white":"#9ca3af",border:"none",borderRadius:"0.375rem",cursor:m.trim()&&d.trim()?"pointer":"not-allowed",display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.875rem",fontWeight:"500"},className:"hover:bg-green-600",children:[(0,i.jsx)(A.Z,{style:{width:"1rem",height:"1rem"}}),p?"保存中...":"保存"]})]})]}),(0,i.jsx)("div",{style:{flex:1,display:"flex"},children:h?(0,i.jsxs)("div",{style:{width:"100%",height:"100%",padding:"1rem",overflowY:"auto",backgroundColor:"#fafafa"},children:[m&&(0,i.jsx)("h1",{style:{fontSize:"2rem",fontWeight:"700",color:"#111827",marginBottom:"1.5rem",paddingBottom:"0.5rem",borderBottom:"2px solid #e5e7eb"},children:m}),(0,i.jsx)("div",{style:{lineHeight:"1.7",color:"#374151"},dangerouslySetInnerHTML:{__html:d?d.replace(/^## (.+)$/gm,"<h2>$1</h2>").replace(/^# (.+)$/gm,"<h1>$1</h1>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/<u>(.*?)<\/u>/g,"<u>$1</u>").replace(/`(.*?)`/g,"<code>$1</code>").replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank">$1</a>').replace(/!\[([^\]]*)\]\(([^)]+)\)/g,'<img src="$2" alt="$1" style="max-width: 100%; height: auto;" />').replace(/^- (.+)$/gm,"<li>$1</li>").replace(/(<li>.*<\/li>)/g,"<ul>$1</ul>").replace(/\n/g,"<br>"):'<p style="color: #9ca3af; font-style: italic;">暫無內容</p>'}})]}):(0,i.jsx)("textarea",{ref:f,value:d,onChange:e=>c(e.target.value),placeholder:"開始撰寫內容... 支援 Markdown 語法",style:{width:"100%",height:"100%",padding:"1rem",border:"none",outline:"none",resize:"none",fontFamily:'Monaco, Menlo, "Ubuntu Mono", monospace',fontSize:"0.875rem",lineHeight:"1.6"}})}),(0,i.jsxs)("div",{style:{padding:"0.5rem 1rem",backgroundColor:"#f8fafc",borderTop:"1px solid #e5e7eb",fontSize:"0.75rem",color:"#6b7280",display:"flex",justifyContent:"space-between"},children:[(0,i.jsxs)("span",{children:["字數：",d.length]}),(0,i.jsxs)("span",{children:["行數：",d.split("\n").length]})]})]})}function T(e){let{userRole:t,className:r=""}=e,[o,s]=(0,n.useState)([]),[l,d]=(0,n.useState)([]),[c,m]=(0,n.useState)(!0),[u,h]=(0,n.useState)(null),[x,y]=(0,n.useState)(!1),[j,v]=(0,n.useState)(!1),[w,C]=(0,n.useState)(""),[k,S]=(0,n.useState)("all"),[z,A]=(0,n.useState)("all"),[T,I]=(0,n.useState)("updatedAt"),[B,W]=(0,n.useState)("desc");(0,n.useEffect)(()=>{let e=[{id:"1",title:"台北101導覽服務介紹",content:"# 台北101導覽服務\n\n台北101是台北最著名的地標建築...",type:"service",status:"published",author:{id:"u1",name:"張小明"},createdAt:new Date("2024-01-15"),updatedAt:new Date("2024-01-20"),publishedAt:new Date("2024-01-20"),tags:["台北","觀光","地標"],slug:"taipei-101-tour",excerpt:"專業地陪帶您深度探索台北101...",featuredImage:"https://images.unsplash.com/photo-1506905925346-21bda4d32df4"},{id:"2",title:"台灣旅遊安全指南",content:"# 台灣旅遊安全指南\n\n在台灣旅遊時，安全是最重要的...",type:"article",status:"published",author:{id:"u2",name:"李美麗"},createdAt:new Date("2024-01-10"),updatedAt:new Date("2024-01-15"),publishedAt:new Date("2024-01-15"),tags:["安全","旅遊","指南"],slug:"taiwan-travel-safety-guide",excerpt:"旅遊安全須知和注意事項..."},{id:"3",title:"關於 Guidee 平台",content:"# 關於我們\n\nGuidee 是台灣首創的地陪媒合平台...",type:"page",status:"published",author:{id:"u3",name:"王大華"},createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-01-12"),publishedAt:new Date("2024-01-05"),tags:["公司","介紹"],slug:"about-guidee",excerpt:"Guidee 平台介紹和使命..."},{id:"4",title:"如何成為認證導遊",content:"# 成為認證導遊的步驟\n\n想要成為 Guidee 認證導遊嗎？...",type:"guide",status:"draft",author:{id:"u1",name:"張小明"},createdAt:new Date("2024-01-25"),updatedAt:new Date("2024-01-25"),tags:["導遊","認證","教學"],slug:"how-to-become-certified-guide",excerpt:"詳細介紹導遊認證流程..."}];s(e),d(e),m(!1)},[]),(0,n.useEffect)(()=>{let e=o.filter(e=>{var t;let r=e.title.toLowerCase().includes(w.toLowerCase())||(null===(t=e.excerpt)||void 0===t?void 0:t.toLowerCase().includes(w.toLowerCase()))||e.tags.some(e=>e.toLowerCase().includes(w.toLowerCase())),i="all"===k||e.type===k,n="all"===z||e.status===z;return r&&i&&n});e.sort((e,t)=>{let r=0;switch(T){case"title":r=e.title.localeCompare(t.title);break;case"createdAt":r=e.createdAt.getTime()-t.createdAt.getTime();break;default:r=e.updatedAt.getTime()-t.updatedAt.getTime()}return"desc"===B?-r:r}),d(e)},[o,w,k,z,T,B]);let N=async(e,t)=>{if(j){let r={id:Date.now().toString(),title:t,content:e,type:"article",status:"draft",author:{id:"current-user",name:"當前用戶"},createdAt:new Date,updatedAt:new Date,tags:[],slug:t.toLowerCase().replace(/[^a-z0-9\u4e00-\u9fa5]/g,"-"),excerpt:e.substring(0,100)+"..."};s(e=>[r,...e]),v(!1)}else u&&(s(r=>r.map(r=>r.id===u.id?{...r,title:t,content:e,updatedAt:new Date}:r)),y(!1),h(null))},Z=e=>{confirm("確定要刪除這個內容嗎？")&&s(t=>t.filter(t=>t.id!==e))},D=(e,t)=>{s(r=>r.map(r=>r.id===e?{...r,status:t,publishedAt:"published"===t?new Date:r.publishedAt,updatedAt:new Date}:r))},L=e=>{switch(e){case"published":return"#10b981";case"draft":return"#f59e0b";default:return"#6b7280"}},_=e=>{switch(e){case"article":return"文章";case"page":return"頁面";case"service":return"服務";case"guide":return"指南";default:return e}},E=e=>new Intl.DateTimeFormat("zh-TW",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(e);return c?(0,i.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"400px"},children:(0,i.jsx)("div",{style:{width:"2rem",height:"2rem",border:"2px solid #e5e7eb",borderTop:"2px solid #3b82f6",borderRadius:"50%",animation:"spin 1s linear infinite"}})}):j||x?(0,i.jsx)(R,{initialContent:(null==u?void 0:u.content)||"",title:(null==u?void 0:u.title)||"",onSave:N,onCancel:()=>{v(!1),y(!1),h(null)},className:r}):(0,i.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"0.5rem",border:"1px solid #e5e7eb",overflow:"hidden"},className:r,children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"1.5rem",borderBottom:"1px solid #e5e7eb"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{style:{fontSize:"1.5rem",fontWeight:"700",color:"#111827",margin:0},children:"內容管理"}),(0,i.jsx)("p",{style:{fontSize:"0.875rem",color:"#6b7280",margin:"0.25rem 0 0"},children:"管理網站內容，包括文章、頁面、服務和指南"})]}),("admin"===t||"editor"===t)&&(0,i.jsxs)("button",{onClick:()=>v(!0),style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.75rem 1.5rem",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"0.5rem",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer"},className:"hover:bg-blue-600",children:[(0,i.jsx)(g.Z,{style:{width:"1rem",height:"1rem"}}),"新增內容"]})]}),(0,i.jsx)("div",{style:{padding:"1rem 1.5rem",backgroundColor:"#f8fafc",borderBottom:"1px solid #e5e7eb"},children:(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr auto auto auto",gap:"1rem",alignItems:"center"},children:[(0,i.jsxs)("div",{style:{position:"relative"},children:[(0,i.jsx)(p.Z,{style:{position:"absolute",left:"0.75rem",top:"50%",transform:"translateY(-50%)",width:"1rem",height:"1rem",color:"#9ca3af"}}),(0,i.jsx)("input",{type:"text",placeholder:"搜尋標題、內容或標籤...",value:w,onChange:e=>C(e.target.value),style:{width:"100%",padding:"0.75rem 0.75rem 0.75rem 2.5rem",border:"1px solid #e5e7eb",borderRadius:"0.375rem",fontSize:"0.875rem",outline:"none"},className:"focus:border-blue-500 focus:ring-1 focus:ring-blue-500"})]}),(0,i.jsxs)("select",{value:k,onChange:e=>S(e.target.value),style:{padding:"0.75rem",border:"1px solid #e5e7eb",borderRadius:"0.375rem",fontSize:"0.875rem",backgroundColor:"white",cursor:"pointer"},children:[(0,i.jsx)("option",{value:"all",children:"所有類型"}),(0,i.jsx)("option",{value:"article",children:"文章"}),(0,i.jsx)("option",{value:"page",children:"頁面"}),(0,i.jsx)("option",{value:"service",children:"服務"}),(0,i.jsx)("option",{value:"guide",children:"指南"})]}),(0,i.jsxs)("select",{value:z,onChange:e=>A(e.target.value),style:{padding:"0.75rem",border:"1px solid #e5e7eb",borderRadius:"0.375rem",fontSize:"0.875rem",backgroundColor:"white",cursor:"pointer"},children:[(0,i.jsx)("option",{value:"all",children:"所有狀態"}),(0,i.jsx)("option",{value:"published",children:"已發布"}),(0,i.jsx)("option",{value:"draft",children:"草稿"}),(0,i.jsx)("option",{value:"archived",children:"已封存"})]}),(0,i.jsxs)("select",{value:"".concat(T,"-").concat(B),onChange:e=>{let[t,r]=e.target.value.split("-");I(t),W(r)},style:{padding:"0.75rem",border:"1px solid #e5e7eb",borderRadius:"0.375rem",fontSize:"0.875rem",backgroundColor:"white",cursor:"pointer"},children:[(0,i.jsx)("option",{value:"updatedAt-desc",children:"最近更新"}),(0,i.jsx)("option",{value:"createdAt-desc",children:"最近創建"}),(0,i.jsx)("option",{value:"title-asc",children:"標題 A-Z"}),(0,i.jsx)("option",{value:"title-desc",children:"標題 Z-A"})]})]})}),(0,i.jsxs)("div",{style:{overflowX:"auto"},children:[(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{style:{backgroundColor:"#f8fafc"},children:[(0,i.jsx)("th",{style:{padding:"0.75rem 1.5rem",textAlign:"left",fontSize:"0.75rem",fontWeight:"600",color:"#374151",textTransform:"uppercase",letterSpacing:"0.05em"},children:"標題"}),(0,i.jsx)("th",{style:{padding:"0.75rem 1.5rem",textAlign:"left",fontSize:"0.75rem",fontWeight:"600",color:"#374151",textTransform:"uppercase",letterSpacing:"0.05em"},children:"類型"}),(0,i.jsx)("th",{style:{padding:"0.75rem 1.5rem",textAlign:"left",fontSize:"0.75rem",fontWeight:"600",color:"#374151",textTransform:"uppercase",letterSpacing:"0.05em"},children:"狀態"}),(0,i.jsx)("th",{style:{padding:"0.75rem 1.5rem",textAlign:"left",fontSize:"0.75rem",fontWeight:"600",color:"#374151",textTransform:"uppercase",letterSpacing:"0.05em"},children:"作者"}),(0,i.jsx)("th",{style:{padding:"0.75rem 1.5rem",textAlign:"left",fontSize:"0.75rem",fontWeight:"600",color:"#374151",textTransform:"uppercase",letterSpacing:"0.05em"},children:"更新時間"}),(0,i.jsx)("th",{style:{padding:"0.75rem 1.5rem",textAlign:"right",fontSize:"0.75rem",fontWeight:"600",color:"#374151",textTransform:"uppercase",letterSpacing:"0.05em"},children:"操作"})]})}),(0,i.jsx)("tbody",{children:l.map(e=>(0,i.jsxs)("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:[(0,i.jsx)("td",{style:{padding:"1rem 1.5rem"},children:(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"0.875rem",fontWeight:"500",color:"#111827",marginBottom:"0.25rem"},children:e.title}),e.excerpt&&(0,i.jsx)("div",{style:{fontSize:"0.75rem",color:"#6b7280",lineHeight:"1.4",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:e.excerpt}),e.tags.length>0&&(0,i.jsxs)("div",{style:{display:"flex",gap:"0.25rem",marginTop:"0.5rem",flexWrap:"wrap"},children:[e.tags.slice(0,3).map((e,t)=>(0,i.jsx)("span",{style:{padding:"0.125rem 0.375rem",backgroundColor:"#f3f4f6",color:"#6b7280",borderRadius:"0.25rem",fontSize:"0.625rem"},children:e},t)),e.tags.length>3&&(0,i.jsxs)("span",{style:{fontSize:"0.625rem",color:"#9ca3af"},children:["+",e.tags.length-3]})]})]})}),(0,i.jsx)("td",{style:{padding:"1rem 1.5rem"},children:(0,i.jsx)("span",{style:{padding:"0.25rem 0.5rem",backgroundColor:"#f0f9ff",color:"#0369a1",borderRadius:"0.375rem",fontSize:"0.75rem",fontWeight:"500"},children:_(e.type)})}),(0,i.jsx)("td",{style:{padding:"1rem 1.5rem"},children:(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,i.jsx)("div",{style:{width:"0.5rem",height:"0.5rem",backgroundColor:L(e.status),borderRadius:"50%"}}),(0,i.jsx)("span",{style:{fontSize:"0.875rem",color:"#374151"},children:"published"===e.status?"已發布":"draft"===e.status?"草稿":"已封存"})]})}),(0,i.jsx)("td",{style:{padding:"1rem 1.5rem"},children:(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,i.jsx)("div",{style:{width:"1.5rem",height:"1.5rem",backgroundColor:"#e5e7eb",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem",fontWeight:"500",color:"#6b7280"},children:e.author.name.charAt(0)}),(0,i.jsx)("span",{style:{fontSize:"0.875rem",color:"#374151"},children:e.author.name})]})}),(0,i.jsx)("td",{style:{padding:"1rem 1.5rem"},children:(0,i.jsx)("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:E(e.updatedAt)})}),(0,i.jsx)("td",{style:{padding:"1rem 1.5rem",textAlign:"right"},children:(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",justifyContent:"flex-end"},children:[(0,i.jsx)("button",{style:{padding:"0.375rem",backgroundColor:"transparent",border:"none",borderRadius:"0.25rem",cursor:"pointer"},className:"hover:bg-gray-100",title:"查看",children:(0,i.jsx)(a.Z,{style:{width:"1rem",height:"1rem",color:"#6b7280"}})}),("admin"===t||"editor"===t||"current-user"===e.author.id)&&(0,i.jsx)("button",{onClick:()=>{h(e),y(!0)},style:{padding:"0.375rem",backgroundColor:"transparent",border:"none",borderRadius:"0.25rem",cursor:"pointer"},className:"hover:bg-gray-100",title:"編輯",children:(0,i.jsx)(b.Z,{style:{width:"1rem",height:"1rem",color:"#6b7280"}})}),("admin"===t||"editor"===t)&&(0,i.jsxs)("select",{value:e.status,onChange:t=>D(e.id,t.target.value),style:{padding:"0.25rem",border:"1px solid #e5e7eb",borderRadius:"0.25rem",fontSize:"0.75rem",backgroundColor:"white",cursor:"pointer"},children:[(0,i.jsx)("option",{value:"draft",children:"草稿"}),(0,i.jsx)("option",{value:"published",children:"發布"}),(0,i.jsx)("option",{value:"archived",children:"封存"})]}),("admin"===t||"current-user"===e.author.id)&&(0,i.jsx)("button",{onClick:()=>Z(e.id),style:{padding:"0.375rem",backgroundColor:"transparent",border:"none",borderRadius:"0.25rem",cursor:"pointer"},className:"hover:bg-red-50",title:"刪除",children:(0,i.jsx)(f.Z,{style:{width:"1rem",height:"1rem",color:"#ef4444"}})})]})})]},e.id))})]}),0===l.length&&(0,i.jsxs)("div",{style:{textAlign:"center",padding:"3rem",color:"#6b7280"},children:[(0,i.jsx)("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:"\uD83D\uDCC4"}),(0,i.jsx)("h3",{style:{fontSize:"1.125rem",fontWeight:"500",marginBottom:"0.5rem"},children:"找不到內容"}),(0,i.jsx)("p",{children:"嘗試調整搜尋條件或篩選器"})]})]})]})}var I=r(8228);function B(){let e=(0,o.useRouter)(),{user:t,isAuthenticated:r}=(0,I.a)(),{t:g}=(0,s.Q)(),[p,b]=(0,n.useState)("overview"),[f,x]=(0,n.useState)(!0);(0,n.useEffect)(()=>{if(!r){e.push("/auth/login?redirect=/admin/cms");return}if((null==t?void 0:t.role)!=="admin"&&(null==t?void 0:t.role)!=="guide"){e.push("/");return}x(!1)},[r,t,e]);let y={totalContent:247,publishedContent:189,draftContent:58,monthlyViews:12589,monthlyViewsGrowth:15.3,topContent:[{title:"台北101導覽服務",views:1249,type:"服務"},{title:"台灣旅遊安全指南",views:987,type:"文章"},{title:"九份老街文化之旅",views:834,type:"服務"},{title:"關於 Guidee 平台",views:756,type:"頁面"},{title:"如何成為認證導遊",views:623,type:"指南"}]};return f?(0,i.jsx)("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"2rem",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,i.jsx)("div",{style:{width:"3rem",height:"3rem",border:"3px solid rgba(255, 255, 255, 0.3)",borderTop:"3px solid white",borderRadius:"50%",animation:"spin 1s linear infinite"}})}):(0,i.jsx)("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"1rem"},children:(0,i.jsxs)("div",{style:{maxWidth:"1400px",margin:"0 auto"},children:[(0,i.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"0.5rem",padding:"1.5rem",marginBottom:"1.5rem",border:"1px solid #e5e7eb"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1rem"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{style:{fontSize:"2rem",fontWeight:"700",color:"#111827",margin:0,marginBottom:"0.5rem"},children:g("admin.cms.title")}),(0,i.jsx)("p",{style:{fontSize:"1rem",color:"#6b7280",margin:0},children:g("admin.cms.description")})]}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.875rem",color:"#6b7280"},children:[(0,i.jsx)(u.Z,{style:{width:"1rem",height:"1rem"}}),new Date().toLocaleDateString("zh-TW")]}),(0,i.jsx)("div",{style:{padding:"0.5rem 0.75rem",backgroundColor:"#10b981",color:"white",borderRadius:"0.375rem",fontSize:"0.875rem",fontWeight:"500"},children:(null==t?void 0:t.role)==="admin"?"管理員":"編輯者"})]})]}),(0,i.jsx)("div",{style:{display:"flex",gap:"0.5rem",borderTop:"1px solid #e5e7eb",paddingTop:"1rem"},children:[{key:"overview",label:g("admin.cms.overview"),icon:c.Z},{key:"content",label:g("admin.cms.content_management"),icon:l.Z},{key:"analytics",label:g("admin.cms.analytics"),icon:d.Z},{key:"settings",label:g("admin.cms.system_settings"),icon:m.Z}].map(e=>{let{key:t,label:r,icon:n}=e;return(0,i.jsxs)("button",{onClick:()=>b(t),style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.75rem 1rem",backgroundColor:p===t?"#3b82f6":"transparent",color:p===t?"white":"#6b7280",border:"1px solid",borderColor:p===t?"#3b82f6":"#e5e7eb",borderRadius:"0.375rem",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer",transition:"all 0.2s"},className:"hover:bg-gray-50",children:[(0,i.jsx)(n,{style:{width:"1rem",height:"1rem"}}),r]},t)})})]}),(0,i.jsx)("div",{style:{marginBottom:"2rem"},children:(()=>{switch(p){case"overview":return(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"2rem"},children:[(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem"},children:[(0,i.jsxs)("div",{style:{backgroundColor:"white",padding:"1.5rem",borderRadius:"0.5rem",border:"1px solid #e5e7eb"},children:[(0,i.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1rem"},children:(0,i.jsx)("div",{style:{width:"3rem",height:"3rem",backgroundColor:"#dbeafe",borderRadius:"0.5rem",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,i.jsx)(l.Z,{style:{width:"1.5rem",height:"1.5rem",color:"#3b82f6"}})})}),(0,i.jsx)("div",{style:{fontSize:"2rem",fontWeight:"700",color:"#111827",marginBottom:"0.25rem"},children:y.totalContent}),(0,i.jsx)("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:g("admin.cms.total_content")})]}),(0,i.jsxs)("div",{style:{backgroundColor:"white",padding:"1.5rem",borderRadius:"0.5rem",border:"1px solid #e5e7eb"},children:[(0,i.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1rem"},children:(0,i.jsx)("div",{style:{width:"3rem",height:"3rem",backgroundColor:"#dcfce7",borderRadius:"0.5rem",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,i.jsx)(a.Z,{style:{width:"1.5rem",height:"1.5rem",color:"#10b981"}})})}),(0,i.jsx)("div",{style:{fontSize:"2rem",fontWeight:"700",color:"#111827",marginBottom:"0.25rem"},children:y.publishedContent}),(0,i.jsx)("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:g("admin.cms.published_content")})]}),(0,i.jsxs)("div",{style:{backgroundColor:"white",padding:"1.5rem",borderRadius:"0.5rem",border:"1px solid #e5e7eb"},children:[(0,i.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1rem"},children:(0,i.jsx)("div",{style:{width:"3rem",height:"3rem",backgroundColor:"#fef3c7",borderRadius:"0.5rem",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,i.jsx)(l.Z,{style:{width:"1.5rem",height:"1.5rem",color:"#f59e0b"}})})}),(0,i.jsx)("div",{style:{fontSize:"2rem",fontWeight:"700",color:"#111827",marginBottom:"0.25rem"},children:y.draftContent}),(0,i.jsx)("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:g("admin.cms.draft_content")})]}),(0,i.jsxs)("div",{style:{backgroundColor:"white",padding:"1.5rem",borderRadius:"0.5rem",border:"1px solid #e5e7eb"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1rem"},children:[(0,i.jsx)("div",{style:{width:"3rem",height:"3rem",backgroundColor:"#fce7f3",borderRadius:"0.5rem",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,i.jsx)(d.Z,{style:{width:"1.5rem",height:"1.5rem",color:"#ec4899"}})}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",color:"#10b981",fontSize:"0.875rem",fontWeight:"500"},children:[(0,i.jsx)(d.Z,{style:{width:"1rem",height:"1rem"}}),"+",y.monthlyViewsGrowth,"%"]})]}),(0,i.jsx)("div",{style:{fontSize:"2rem",fontWeight:"700",color:"#111827",marginBottom:"0.25rem"},children:y.monthlyViews.toLocaleString()}),(0,i.jsx)("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:g("admin.cms.monthly_views")})]})]}),(0,i.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"0.5rem",border:"1px solid #e5e7eb",overflow:"hidden"},children:[(0,i.jsx)("div",{style:{padding:"1.5rem",borderBottom:"1px solid #e5e7eb"},children:(0,i.jsx)("h3",{style:{fontSize:"1.125rem",fontWeight:"600",color:"#111827",margin:0},children:g("admin.cms.popular_content")})}),(0,i.jsx)("div",{style:{padding:"1rem"},children:y.topContent.map((e,t)=>(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.75rem",borderRadius:"0.375rem",marginBottom:t<y.topContent.length-1?"0.5rem":0},className:"hover:bg-gray-50",children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[(0,i.jsx)("div",{style:{width:"1.5rem",height:"1.5rem",backgroundColor:"#f3f4f6",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem",fontWeight:"600",color:"#6b7280"},children:t+1}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"0.875rem",fontWeight:"500",color:"#111827"},children:e.title}),(0,i.jsx)("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:e.type})]})]}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",fontSize:"0.875rem",color:"#6b7280"},children:[(0,i.jsx)(a.Z,{style:{width:"0.875rem",height:"0.875rem"}}),e.views.toLocaleString()]})]},t))})]})]});case"content":return(0,i.jsx)(T,{userRole:(null==t?void 0:t.role)==="admin"?"admin":"editor"});case"analytics":return(0,i.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"0.5rem",border:"1px solid #e5e7eb",padding:"2rem",textAlign:"center"},children:[(0,i.jsx)(c.Z,{style:{width:"4rem",height:"4rem",color:"#d1d5db",margin:"0 auto 1rem"}}),(0,i.jsx)("h3",{style:{fontSize:"1.125rem",fontWeight:"600",color:"#111827",marginBottom:"0.5rem"},children:g("admin.cms.analytics_coming_soon")}),(0,i.jsx)("p",{style:{color:"#6b7280"},children:g("admin.cms.analytics_description")})]});case"settings":return(0,i.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"0.5rem",border:"1px solid #e5e7eb",padding:"2rem",textAlign:"center"},children:[(0,i.jsx)(m.Z,{style:{width:"4rem",height:"4rem",color:"#d1d5db",margin:"0 auto 1rem"}}),(0,i.jsx)("h3",{style:{fontSize:"1.125rem",fontWeight:"600",color:"#111827",marginBottom:"0.5rem"},children:g("admin.cms.settings_coming_soon")}),(0,i.jsx)("p",{style:{color:"#6b7280"},children:g("admin.cms.settings_description")})]});default:return null}})()}),(0,i.jsx)(h.d8,{showBackButton:!0,backButtonText:"返回首頁"})]})})}},5554:function(e,t,r){"use strict";r.d(t,{L6:function(){return a},d8:function(){return s},us:function(){return l}});var i=r(7437),n=r(4033),o=r(1291);function s(e){let{showBackButton:t=!1,backButtonText:r="返回",showHomeButton:s=!0,homeButtonText:l="回到首頁",customBackAction:a}=e,d=(0,n.useRouter)();return(0,i.jsxs)(i.Fragment,{children:[s&&(0,i.jsx)("div",{style:{position:"absolute",top:"1rem",left:"1rem",zIndex:50},className:"sm:top-8 sm:left-8",children:(0,i.jsxs)("button",{onClick:()=>{d.push("/")},style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0.75rem",backgroundColor:"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(10px)",borderRadius:"0.5rem",border:"1px solid rgba(255, 255, 255, 0.3)",cursor:"pointer",transition:"all 0.2s",fontSize:"0.75rem",fontWeight:"500",color:"#374151",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)"},className:"hover:bg-white hover:shadow-md sm:text-sm sm:px-4 sm:py-3",children:[(0,i.jsxs)("span",{className:"hidden sm:inline",children:["← ",l]}),(0,i.jsx)("span",{className:"sm:hidden",children:"← 首頁"})]})}),t&&(0,i.jsx)("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"1rem 1.5rem",paddingTop:s?"4rem":"1rem"},children:(0,i.jsxs)("button",{onClick:()=>{a?a():d.back()},style:{display:"flex",alignItems:"center",gap:"0.5rem",color:"#6b7280",background:"none",border:"none",cursor:"pointer",fontSize:"0.875rem",transition:"color 0.2s",padding:"0.5rem 0"},className:"hover:text-gray-900",children:[(0,i.jsx)(o.Z,{style:{width:"1.25rem",height:"1.25rem"}}),(0,i.jsx)("span",{children:r})]})})]})}function l(e){let{text:t="回到首頁"}=e;return(0,i.jsx)(s,{showHomeButton:!0,homeButtonText:t,showBackButton:!1})}function a(e){let{backButtonText:t="返回",homeButtonText:r="回到首頁",customBackAction:n}=e;return(0,i.jsx)(s,{showHomeButton:!0,showBackButton:!0,backButtonText:t,homeButtonText:r,customBackAction:n})}},8228:function(e,t,r){"use strict";r.d(t,{a:function(){return o}});var i=r(4660),n=r(4810);let o=(0,i.Ue)()((0,n.tJ)((e,t)=>({user:null,token:null,refreshToken:null,isLoading:!1,isAuthenticated:!1,login:async(t,r)=>{e({isLoading:!0});try{var i,n,o,s;let l=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:t,password:r})}),a=await l.json();if(!l.ok||!a.success)throw Error(a.error||a.message||"登入失敗");let d={id:a.data.user.id,email:a.data.user.email,name:a.data.user.name,avatar:a.data.user.avatar,role:a.data.user.role.toLowerCase(),isEmailVerified:a.data.user.isEmailVerified,isKYCVerified:a.data.user.isKycVerified,createdAt:a.data.user.createdAt,permissions:a.data.user.permissions||[],profile:{phone:a.data.user.phone,bio:null===(i=a.data.user.userProfile)||void 0===i?void 0:i.bio,location:null===(n=a.data.user.userProfile)||void 0===n?void 0:n.location,languages:null===(o=a.data.user.userProfile)||void 0===o?void 0:o.languages,specialties:null===(s=a.data.user.userProfile)||void 0===s?void 0:s.specialties}};e({user:d,token:a.data.token,refreshToken:null,isAuthenticated:!0,isLoading:!1})}catch(t){throw e({isLoading:!1}),t}},register:async t=>{e({isLoading:!0});try{await new Promise(e=>setTimeout(e,1500));let r={id:Date.now().toString(),email:t.email,name:t.name,role:t.userType||"customer",isEmailVerified:!1,isKYCVerified:!1,createdAt:new Date().toISOString(),permissions:"guide"===t.userType?["user:read","guide:manage","booking:manage"]:["user:read","booking:create"],profile:{phone:t.phone}},i="mock-jwt-token-"+Date.now();e({user:r,token:i,refreshToken:"mock-refresh-token",isAuthenticated:!0,isLoading:!1})}catch(t){throw e({isLoading:!1}),t}},logout:async()=>{try{await fetch("/api/auth/logout",{method:"POST",credentials:"include"})}catch(e){}e({user:null,token:null,refreshToken:null,isAuthenticated:!1})},updateUser:async r=>{let{user:i,token:n}=t();if(!i||!n)throw Error("未登入");e({isLoading:!0});try{let t=await fetch("/api/users/profile",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify(r)});if(!t.ok)throw Error("更新失敗");let o=await t.json();e({user:{...i,...o},isLoading:!1})}catch(t){throw e({isLoading:!1}),t}},refreshAuth:async()=>{let{refreshToken:r}=t();if(r)try{let t=await fetch("/api/auth/refresh",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:r})});if(!t.ok)throw Error("Token 刷新失敗");let i=await t.json();e({token:i.token,refreshToken:i.refreshToken})}catch(e){t().logout()}},initializeAuth:async()=>{try{let o=await fetch("/api/auth/me",{credentials:"include"});if(o.ok){let s=await o.json();if(s.success&&s.data.user){var t,r,i,n;let o={id:s.data.user.id,email:s.data.user.email,name:s.data.user.name,avatar:s.data.user.avatar,role:s.data.user.role.toLowerCase(),isEmailVerified:s.data.user.isEmailVerified,isKYCVerified:s.data.user.isKycVerified,createdAt:s.data.user.createdAt,permissions:s.data.user.permissions||[],profile:{phone:s.data.user.phone,bio:null===(t=s.data.user.userProfile)||void 0===t?void 0:t.bio,location:null===(r=s.data.user.userProfile)||void 0===r?void 0:r.location,languages:null===(i=s.data.user.userProfile)||void 0===i?void 0:i.languages,specialties:null===(n=s.data.user.userProfile)||void 0===n?void 0:n.specialties}};e({user:o,isAuthenticated:!0})}}}catch(e){}},setLoading:t=>{e({isLoading:t})},hasPermission:e=>{var r;let{user:i}=t();return!!i&&("GUIDE"===i.role||(null===(r=i.permissions)||void 0===r?void 0:r.includes(e))||!1)}}),{name:"guidee-auth",partialize:e=>({user:e.user,token:e.token,refreshToken:e.refreshToken,isAuthenticated:e.isAuthenticated})}))}},function(e){e.O(0,[1216,4784,1744],function(){return e(e.s=4919)}),_N_E=e.O()}]);