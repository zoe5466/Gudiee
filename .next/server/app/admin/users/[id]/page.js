(()=>{var e={};e.id=214,e.ids=[214],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},65826:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>l.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>o,routeModule:()=>h,tree:()=>d});var r=t(50482),a=t(69108),i=t(62563),l=t.n(i),n=t(68300),c={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);t.d(s,c);let d=["",{children:["admin",{children:["users",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,3788)),"/Users/zoechang/projects/Guidee/src/app/admin/users/[id]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,58185)),"/Users/zoechang/projects/Guidee/src/app/admin/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,98890)),"/Users/zoechang/projects/Guidee/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,69361,23)),"next/dist/client/components/not-found-error"]}],o=["/Users/zoechang/projects/Guidee/src/app/admin/users/[id]/page.tsx"],x="/admin/users/[id]/page",m={require:t,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/admin/users/[id]/page",pathname:"/admin/users/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},36629:(e,s,t)=>{Promise.resolve().then(t.bind(t,31174))},31174:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>v});var r=t(95344),a=t(3729),i=t(22254),l=t(36515),n=t(23673),c=t(5094),d=t(19591),o=t(66138),x=t(63024),m=t(75695),h=t(80895),u=t(23485),p=t(7060),j=t(40626),g=t(80508),f=t(71206),N=t(55794),y=t(76755),b=t(88534);function v(){var e;let s=(0,i.useRouter)(),t=(0,i.useParams)(),[v,w]=(0,a.useState)(null),[C,P]=(0,a.useState)(!0),[Z,S]=(0,a.useState)("");(0,a.useEffect)(()=>{t.id&&k(t.id)},[t.id]);let k=async e=>{try{let s=await fetch(`/api/admin/users/${e}`);if(s.ok){let e=await s.json();w(e)}else S("無法獲取用戶詳細資料")}catch(e){S("載入用戶資料時發生錯誤")}finally{P(!1)}},z=async e=>{if(v)try{(await fetch(`/api/admin/users/${v.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:e})})).ok&&k(v.id)}catch(e){}};return C?r.jsx(l.AdminLayout,{children:r.jsx("div",{className:"flex items-center justify-center h-96",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:"載入中..."})]})})}):Z||!v?r.jsx(l.AdminLayout,{children:(0,r.jsxs)("div",{className:"text-center py-12",children:[r.jsx(o.Z,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),r.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"載入失敗"}),r.jsx("p",{className:"text-gray-600 mb-6",children:Z||"找不到該用戶"}),(0,r.jsxs)(c.z,{onClick:()=>s.push("/admin/users"),children:[r.jsx(x.Z,{className:"h-4 w-4 mr-2"}),"返回用戶列表"]})]})}):r.jsx(l.AdminLayout,{children:(0,r.jsxs)("div",{className:"p-6",children:[r.jsx("div",{className:"mb-8",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)(c.z,{variant:"outline",onClick:()=>s.push("/admin/users"),children:[r.jsx(x.Z,{className:"h-4 w-4 mr-2"}),"返回"]}),(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:v.userProfile?.name||v.name||"未設定姓名"}),r.jsx("p",{className:"text-gray-600 mt-1",children:"用戶詳細管理"})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)(c.z,{variant:"outline",onClick:()=>z("edit"),children:[r.jsx(m.Z,{className:"h-4 w-4 mr-2"}),"編輯"]}),(0,r.jsxs)(c.z,{variant:"outline",onClick:()=>z("suspend"),children:[r.jsx(h.Z,{className:"h-4 w-4 mr-2"}),"停用"]}),"admin"!==v.role&&(0,r.jsxs)(c.z,{variant:"outline",onClick:()=>z("promote"),children:[r.jsx(u.Z,{className:"h-4 w-4 mr-2"}),"提升權限"]})]})]})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,r.jsxs)("div",{className:"lg:col-span-1 space-y-6",children:[(0,r.jsxs)(n.Zb,{children:[r.jsx(n.Ol,{children:r.jsx(n.ll,{children:"基本資料"})}),(0,r.jsxs)(n.aY,{children:[(0,r.jsxs)("div",{className:"text-center mb-6",children:[r.jsx("div",{className:"w-24 h-24 bg-gray-300 rounded-full flex items-center justify-center mx-auto mb-4",children:r.jsx("span",{className:"text-2xl font-bold text-gray-600",children:(v.userProfile?.name||v.name||v.email)[0].toUpperCase()})}),r.jsx("h3",{className:"text-lg font-semibold",children:v.userProfile?.name||v.name||"未設定"}),r.jsx("p",{className:"text-gray-600",children:v.email}),r.jsx("div",{className:"flex justify-center mt-2",children:r.jsx(d.Ct,{variant:{admin:"destructive",guide:"default",customer:"secondary"}[v.role]||"outline",children:{admin:"管理員",guide:"地陪",customer:"客戶"}[e=v.role]||e})})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between py-2 border-b",children:[r.jsx("span",{className:"text-sm text-gray-600",children:"電子郵件驗證"}),v.isEmailVerified?(0,r.jsxs)(d.Ct,{variant:"success",children:[r.jsx(p.Z,{className:"h-3 w-3 mr-1"}),"已驗證"]}):(0,r.jsxs)(d.Ct,{variant:"destructive",children:[r.jsx(o.Z,{className:"h-3 w-3 mr-1"}),"未驗證"]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between py-2 border-b",children:[r.jsx("span",{className:"text-sm text-gray-600",children:"身份驗證 (KYC)"}),v.isKycVerified?(0,r.jsxs)(d.Ct,{variant:"success",children:[r.jsx(p.Z,{className:"h-3 w-3 mr-1"}),"已通過"]}):r.jsx(d.Ct,{variant:"outline",children:"未驗證"})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between py-2 border-b",children:[r.jsx("span",{className:"text-sm text-gray-600",children:"註冊時間"}),r.jsx("span",{className:"text-sm",children:new Date(v.createdAt).toLocaleDateString("zh-TW")})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between py-2",children:[r.jsx("span",{className:"text-sm text-gray-600",children:"最後登入"}),r.jsx("span",{className:"text-sm",children:v.lastLoginAt?new Date(v.lastLoginAt).toLocaleDateString("zh-TW"):"從未登入"})]})]})]})]}),v.userProfile&&(0,r.jsxs)(n.Zb,{children:[r.jsx(n.Ol,{children:r.jsx(n.ll,{children:"聯絡資訊"})}),(0,r.jsxs)(n.aY,{className:"space-y-4",children:[v.userProfile.phone&&(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx(j.Z,{className:"h-4 w-4 text-gray-400"}),r.jsx("span",{className:"text-sm",children:v.userProfile.phone})]}),v.userProfile.location&&(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx(g.Z,{className:"h-4 w-4 text-gray-400"}),r.jsx("span",{className:"text-sm",children:v.userProfile.location})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx(f.Z,{className:"h-4 w-4 text-gray-400"}),r.jsx("span",{className:"text-sm",children:v.email})]})]})]})]}),(0,r.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsx(n.Zb,{children:r.jsx(n.aY,{className:"pt-6",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)("div",{className:"flex-1",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"提供服務"}),r.jsx("p",{className:"text-2xl font-bold",children:v.stats?.servicesCount||0})]}),r.jsx(g.Z,{className:"h-8 w-8 text-gray-400"})]})})}),r.jsx(n.Zb,{children:r.jsx(n.aY,{className:"pt-6",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)("div",{className:"flex-1",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"預訂記錄"}),r.jsx("p",{className:"text-2xl font-bold",children:v.stats?.bookingsCount||0})]}),r.jsx(N.Z,{className:"h-8 w-8 text-gray-400"})]})})}),r.jsx(n.Zb,{children:r.jsx(n.aY,{className:"pt-6",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)("div",{className:"flex-1",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"評論數量"}),r.jsx("p",{className:"text-2xl font-bold",children:v.stats?.reviewsCount||0})]}),r.jsx(y.Z,{className:"h-8 w-8 text-gray-400"})]})})})]}),v.userProfile&&(0,r.jsxs)(n.Zb,{children:[r.jsx(n.Ol,{children:r.jsx(n.ll,{children:"個人檔案"})}),(0,r.jsxs)(n.aY,{className:"space-y-6",children:[v.userProfile.bio&&(0,r.jsxs)("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-600 mb-2",children:"個人簡介"}),r.jsx("p",{className:"text-sm bg-gray-50 p-4 rounded-lg",children:v.userProfile.bio})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[v.userProfile.languages&&v.userProfile.languages.length>0&&(0,r.jsxs)("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-600 mb-2",children:"語言能力"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:v.userProfile.languages.map((e,s)=>r.jsx(d.Ct,{variant:"secondary",children:e},s))})]}),v.userProfile.specialties&&v.userProfile.specialties.length>0&&(0,r.jsxs)("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-600 mb-2",children:"專業領域"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:v.userProfile.specialties.map((e,s)=>r.jsx(d.Ct,{variant:"outline",children:e},s))})]})]}),v.userProfile.certifications&&v.userProfile.certifications.length>0&&(0,r.jsxs)("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-600 mb-2",children:"認證資格"}),r.jsx("div",{className:"space-y-2",children:v.userProfile.certifications.map((e,s)=>(0,r.jsxs)("div",{className:"flex items-center p-3 bg-green-50 rounded-lg",children:[r.jsx(p.Z,{className:"h-4 w-4 text-green-500 mr-2"}),r.jsx("span",{className:"text-sm text-green-700",children:e})]},s))})]})]})]}),(0,r.jsxs)(n.Zb,{children:[r.jsx(n.Ol,{children:(0,r.jsxs)(n.ll,{className:"flex items-center",children:[r.jsx(b.Z,{className:"h-5 w-5 mr-2"}),"最近活動"]})}),r.jsx(n.aY,{children:(0,r.jsxs)("div",{className:"space-y-4",children:[v.recentServices&&v.recentServices.length>0&&(0,r.jsxs)("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-600 mb-3",children:"最近提供的服務"}),r.jsx("div",{className:"space-y-2",children:v.recentServices.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium",children:e.title}),r.jsx("p",{className:"text-xs text-gray-500",children:new Date(e.createdAt).toLocaleDateString("zh-TW")})]}),(0,r.jsxs)("div",{className:"text-right",children:[r.jsx(d.Ct,{variant:"APPROVED"===e.status?"success":"outline",children:e.status}),(0,r.jsxs)("p",{className:"text-xs text-gray-600 mt-1",children:["NT$ ",e.price]})]})]},e.id))})]}),v.recentBookings&&v.recentBookings.length>0&&(0,r.jsxs)("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-600 mb-3",children:"最近預訂記錄"}),r.jsx("div",{className:"space-y-2",children:v.recentBookings.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium",children:e.serviceTitle}),r.jsx("p",{className:"text-xs text-gray-500",children:new Date(e.bookingDate).toLocaleDateString("zh-TW")})]}),(0,r.jsxs)("div",{className:"text-right",children:[r.jsx(d.Ct,{variant:"secondary",children:e.status}),(0,r.jsxs)("p",{className:"text-xs text-gray-600 mt-1",children:["NT$ ",e.totalAmount]})]})]},e.id))})]}),!v.recentServices?.length&&!v.recentBookings?.length&&(0,r.jsxs)("div",{className:"text-center text-gray-500 py-8",children:[r.jsx(b.Z,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),r.jsx("p",{children:"暫無最近活動記錄"})]})]})})]})]})]})]})})}},16676:(e,s,t)=>{"use strict";t.d(s,{W:()=>x,j:()=>m});var r=t(95344),a=t(3729),i=t(81202),l=t(30304),n=t(62312),c=t(25390),d=t(71756),o=t(62455);function x({variant:e="dropdown",showFlag:s=!0,showNativeName:t=!0,className:x=""}){let{locale:m,setLocale:h,t:u}=(0,o.Q)(),[p,j]=(0,a.useState)(!1),[g,f]=(0,a.useState)(!1),[N,y]=(0,a.useState)({top:0,left:0,width:0}),b=(0,a.useRef)(null),v=(0,a.useRef)(null);(0,a.useEffect)(()=>{f(!0)},[]),(0,a.useEffect)(()=>{let e=e=>{let s=e.target,t=v.current?.contains(s),r=document.querySelector("[data-language-dropdown]")?.contains(s);t||r||j(!1)};if(p)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[p]);let w=()=>{if(v.current){let e=v.current.getBoundingClientRect();y({top:e.bottom+4,left:e.right-192,width:192})}},C=e=>{h(e),j(!1)},P=d.H8[m];return g?"inline"===e?r.jsx("div",{className:`flex gap-2 ${x}`,children:Object.entries(d.H8).map(([e,a])=>(0,r.jsxs)("button",{onClick:()=>C(e),style:{padding:"0.5rem 0.75rem",borderRadius:"0.375rem",border:"1px solid",borderColor:m===e?"#2563eb":"#e5e7eb",backgroundColor:m===e?"#eff6ff":"white",color:m===e?"#2563eb":"#6b7280",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer",transition:"all 0.2s",display:"flex",alignItems:"center",gap:"0.5rem"},className:"hover:border-blue-300",children:[s&&r.jsx("span",{children:a.flag}),t&&r.jsx("span",{children:a.nativeName}),m===e&&r.jsx(n.Z,{style:{width:"0.875rem",height:"0.875rem"}})]},e))}):(0,r.jsxs)("div",{ref:b,style:{position:"relative"},className:x,children:[(0,r.jsxs)("button",{ref:v,onClick:()=>{p||w(),j(!p)},style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0.75rem",backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"0.5rem",fontSize:"0.875rem",fontWeight:"500",color:"#374151",cursor:"pointer",transition:"all 0.2s",minWidth:"8rem"},className:"hover:bg-gray-50 hover:border-gray-300",children:[r.jsx(l.Z,{style:{width:"1rem",height:"1rem"}}),s&&r.jsx("span",{children:P.flag}),t&&r.jsx("span",{children:P.nativeName}),r.jsx(c.Z,{style:{width:"0.875rem",height:"0.875rem",marginLeft:"auto",transform:p?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s"}})]}),p&&g&&(0,i.createPortal)(r.jsx("div",{"data-language-dropdown":!0,style:{position:"fixed",top:N.top,left:N.left,width:N.width,backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"0.5rem",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1)",zIndex:1e4,overflow:"hidden"},children:Object.entries(d.H8).map(([e,t])=>(0,r.jsxs)("button",{onClick:()=>C(e),style:{width:"100%",display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.75rem",fontSize:"0.875rem",color:m===e?"#2563eb":"#374151",backgroundColor:m===e?"#f8fafc":"transparent",border:"none",cursor:"pointer",transition:"all 0.2s",textAlign:"left"},className:"hover:bg-gray-50",children:[s&&r.jsx("span",{style:{fontSize:"1.125rem"},children:t.flag}),(0,r.jsxs)("div",{style:{flex:1},children:[r.jsx("div",{style:{fontWeight:"500"},children:t.nativeName}),r.jsx("div",{style:{fontSize:"0.75rem",color:"#9ca3af"},children:t.name})]}),m===e&&r.jsx(n.Z,{style:{width:"1rem",height:"1rem",color:"#2563eb"}})]},e))}),document.body)]}):(0,r.jsxs)("div",{className:`flex items-center gap-2 ${x}`,children:[r.jsx(l.Z,{className:"w-4 h-4 text-gray-500"}),r.jsx("span",{className:"text-sm text-gray-500",children:"Loading..."})]})}function m({className:e=""}){let{locale:s,setLocale:t}=(0,o.Q)(),[i,n]=(0,a.useState)(!1);if((0,a.useEffect)(()=>{n(!0)},[]),!i)return r.jsx("button",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"2.5rem",height:"2.5rem",backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"50%",cursor:"pointer",transition:"all 0.2s",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"},className:`hover:bg-gray-50 hover:scale-105 ${e}`,children:r.jsx(l.Z,{className:"w-4 h-4 text-gray-500"})});let c=d.H8[s].flag;return r.jsx("button",{onClick:()=>{let e=["zh-TW","en"],r=(e.indexOf(s)+1)%e.length,a=e[r];a&&t(a)},style:{display:"flex",alignItems:"center",justifyContent:"center",width:"2.5rem",height:"2.5rem",backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"50%",fontSize:"1.125rem",cursor:"pointer",transition:"all 0.2s",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"},className:`hover:bg-gray-50 hover:scale-105 ${e}`,title:`Switch to ${"zh-TW"===s?"English":"繁體中文"}`,children:c})}},23673:(e,s,t)=>{"use strict";t.d(s,{Ol:()=>n,SZ:()=>d,Zb:()=>l,aY:()=>o,ll:()=>c});var r=t(95344),a=t(3729),i=t(11453);let l=a.forwardRef(({className:e,...s},t)=>r.jsx("div",{ref:t,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...s}));l.displayName="Card";let n=a.forwardRef(({className:e,...s},t)=>r.jsx("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",e),...s}));n.displayName="CardHeader";let c=a.forwardRef(({className:e,children:s,...t},a)=>r.jsx("h3",{ref:a,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t,children:s}));c.displayName="CardTitle";let d=a.forwardRef(({className:e,...s},t)=>r.jsx("p",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",e),...s}));d.displayName="CardDescription";let o=a.forwardRef(({className:e,...s},t)=>r.jsx("div",{ref:t,className:(0,i.cn)("p-6 pt-0",e),...s}));o.displayName="CardContent",a.forwardRef(({className:e,...s},t)=>r.jsx("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",e),...s})).displayName="CardFooter"},11453:(e,s,t)=>{"use strict";t.d(s,{cn:()=>i});var r=t(56815),a=t(79377);function i(...e){return(0,a.m6)((0,r.W)(e))}},3788:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>i,__esModule:()=>a,default:()=>l});let r=(0,t(86843).createProxy)(String.raw`/Users/zoechang/projects/Guidee/src/app/admin/users/[id]/page.tsx`),{__esModule:a,$$typeof:i}=r,l=r.default}};var s=require("../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[1216,8039,4471],()=>t(65826));module.exports=r})();