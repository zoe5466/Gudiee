(()=>{var e={};e.id=5687,e.ids=[5687],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},32181:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>o,pages:()=>m,routeModule:()=>u,tree:()=>c});var a=t(50482),r=t(69108),i=t(62563),n=t.n(i),l=t(68300),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);t.d(s,d);let c=["",{children:["admin",{children:["reviews",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,45987)),"/Users/zoechang/projects/Guidee/src/app/admin/reviews/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,58185)),"/Users/zoechang/projects/Guidee/src/app/admin/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,98890)),"/Users/zoechang/projects/Guidee/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,69361,23)),"next/dist/client/components/not-found-error"]}],m=["/Users/zoechang/projects/Guidee/src/app/admin/reviews/page.tsx"],o="/admin/reviews/page",x={require:t,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/admin/reviews/page",pathname:"/admin/reviews",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},80558:(e,s,t)=>{Promise.resolve().then(t.bind(t,33215))},33215:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>T});var a=t(95344),r=t(3729),i=t(62455),n=t(23673),l=t(5094),d=t(46540),c=t(2690),m=t(19591),o=t(53295),x=t(11453);let u=o.fC,h=r.forwardRef(({className:e,...s},t)=>a.jsx(o.aV,{ref:t,className:(0,x.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...s}));h.displayName=o.aV.displayName;let g=r.forwardRef(({className:e,...s},t)=>a.jsx(o.xz,{ref:t,className:(0,x.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...s}));g.displayName=o.xz.displayName;let p=r.forwardRef(({className:e,...s},t)=>a.jsx(o.VY,{ref:t,className:(0,x.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...s}));p.displayName=o.VY.displayName;var v=t(76755),j=t(46064),N=t(50340),w=t(25545),f=t(66138),b=t(7060),y=t(26187),R=t(23485),E=t(17418),P=t(28765),I=t(18822),Z=t(80508),C=t(55794),_=t(35851),A=t(62312),D=t(14513),G=t(53148);function T(){let{t:e}=(0,i.Q)(),[s,t]=(0,r.useState)([]),[o,x]=(0,r.useState)({totalReviews:0,pendingReviews:0,approvedReviews:0,rejectedReviews:0,reportedReviews:0,averageRating:0,positiveReviews:0,negativeReviews:0}),[T,L]=(0,r.useState)(null),[V,z]=(0,r.useState)(!0),[O,S]=(0,r.useState)(""),[k,q]=(0,r.useState)("ALL"),[Y,$]=(0,r.useState)("ALL"),[F,J]=(0,r.useState)(""),[U,M]=(0,r.useState)("pending");(0,r.useEffect)(()=>{Q(),W()},[]);let Q=async()=>{try{t([{id:"1",userId:"user1",userName:"張小明",serviceId:"service1",serviceName:"台北一日遊",guideId:"guide1",guideName:"李導遊",rating:5,comment:"非常棒的體驗！導遊專業親切，行程安排得很好，景點介紹詳細，讓我們對台北有了更深的了解。強烈推薦！",createdAt:"2025-01-21T10:30:00Z",status:"PENDING",reportCount:0,isReported:!1,sentiment:"POSITIVE",images:["https://picsum.photos/400/300?random=1"]},{id:"2",userId:"user2",userName:"王美華",serviceId:"service2",serviceName:"九份老街導覽",guideId:"guide2",guideName:"陳導遊",rating:2,comment:"導遊遲到了30分鐘，而且對景點的介紹不夠詳細，感覺不太專業。價錢偏貴，不值得。",createdAt:"2025-01-21T09:15:00Z",status:"PENDING",reportCount:2,isReported:!0,sentiment:"NEGATIVE",moderatorNote:"需要進一步審核是否為惡意評論"},{id:"3",userId:"user3",userName:"李先生",serviceId:"service3",serviceName:"淡水河岸遊",guideId:"guide1",guideName:"李導遊",rating:4,comment:"整體來說還不錯，導遊很友善，景色也很美。唯一不足的是時間有點趕，希望能多預留一些時間拍照。",createdAt:"2025-01-20T16:20:00Z",status:"APPROVED",reportCount:0,isReported:!1,sentiment:"POSITIVE",responseFromGuide:"謝謝您的建議，我們會調整行程時間安排，確保有充足的拍照時間。"},{id:"4",userId:"user4",userName:"劉小姐",serviceId:"service4",serviceName:"陽明山溫泉之旅",guideId:"guide3",guideName:"黃導遊",rating:1,comment:"垃圾服務，導遊態度惡劣，完全不推薦。浪費錢和時間。",createdAt:"2025-01-20T14:10:00Z",status:"REJECTED",reportCount:0,isReported:!1,sentiment:"NEGATIVE",moderatorNote:"語言不當，缺乏具體描述，判定為無效評論"},{id:"5",userId:"user5",userName:"吳大哥",serviceId:"service5",serviceName:"夜市美食探索",guideId:"guide4",guideName:"郭導遊",rating:5,comment:"超棒的美食之旅！導遊帶我們嘗試了很多當地特色小吃，每一樣都很好吃。郭導遊不僅熟悉美食，還會說很多有趣的故事。",createdAt:"2025-01-20T12:45:00Z",status:"APPROVED",reportCount:0,isReported:!1,sentiment:"POSITIVE"}])}catch(e){}finally{z(!1)}},W=async()=>{try{x({totalReviews:156,pendingReviews:23,approvedReviews:112,rejectedReviews:21,reportedReviews:8,averageRating:4.2,positiveReviews:124,negativeReviews:32})}catch(e){}},X=async e=>{try{let a=s.map(s=>s.id===e?{...s,status:"APPROVED"}:s);t(a),T?.id===e&&L({...T,status:"APPROVED"})}catch(e){}},B=async e=>{try{let a=s.map(s=>s.id===e?{...s,status:"REJECTED",moderatorNote:F||"不符合社群規範"}:s);t(a),T?.id===e&&L({...T,status:"REJECTED",moderatorNote:F||"不符合社群規範"}),J("")}catch(e){}},H=e=>Array.from({length:5},(s,t)=>a.jsx(v.Z,{className:`h-4 w-4 ${t<e?"text-yellow-400 fill-current":"text-gray-300"}`},t)),K=e=>{switch(e){case"PENDING":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"APPROVED":return"bg-green-100 text-green-800 border-green-200";case"REJECTED":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},ee=e=>{switch(e){case"POSITIVE":return"text-green-600";case"NEGATIVE":return"text-red-600";default:return"text-gray-600"}},es=s.filter(e=>{let s=e.userName.toLowerCase().includes(O.toLowerCase())||e.serviceName.toLowerCase().includes(O.toLowerCase())||e.comment.toLowerCase().includes(O.toLowerCase()),t="ALL"===k||"REPORTED"===k&&e.isReported||e.status===k,a="ALL"===Y||e.rating.toString()===Y;return s&&t&&a}),et=e=>{switch(e){case"pending":return es.filter(e=>"PENDING"===e.status);case"approved":return es.filter(e=>"APPROVED"===e.status);case"rejected":return es.filter(e=>"REJECTED"===e.status);case"reported":return es.filter(e=>e.isReported);default:return es}};return V?a.jsx("div",{className:"flex items-center justify-center h-96",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:e("admin.common.loading")})]})}):(0,a.jsxs)("div",{className:"space-y-8",children:[a.jsx("div",{className:"bg-gradient-to-r from-white/90 to-orange-50/50 backdrop-blur-sm rounded-2xl p-8 shadow-sm border border-slate-200/50",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-slate-900 to-orange-600 bg-clip-text text-transparent",children:e("admin.review_management.title")}),a.jsx("p",{className:"text-slate-600 mt-3 text-lg",children:"審核用戶評論，確保內容質量和社群規範"}),(0,a.jsxs)("div",{className:"flex items-center mt-4 text-sm text-slate-500",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mr-2 animate-pulse"}),a.jsx("span",{children:"即時監控中"})]}),(0,a.jsxs)("div",{className:"ml-6 flex items-center",children:[a.jsx(v.Z,{className:"w-4 h-4 mr-1 text-yellow-500 fill-current"}),(0,a.jsxs)("span",{children:["平均評分：",o.averageRating.toFixed(1)]})]})]})]}),a.jsx("div",{className:"hidden lg:block",children:a.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-orange-500 to-red-600 rounded-2xl flex items-center justify-center shadow-lg",children:a.jsx(v.Z,{className:"w-10 h-10 text-white"})})})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[a.jsx(n.Zb,{className:"bg-gradient-to-br from-blue-500 to-blue-600 text-white border-0 shadow-lg",children:a.jsx(n.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-blue-100 text-sm font-medium",children:e("admin.review_management.total_reviews")}),a.jsx("p",{className:"text-3xl font-bold mt-2",children:o.totalReviews}),(0,a.jsxs)("div",{className:"flex items-center mt-2",children:[a.jsx(j.Z,{className:"h-4 w-4 mr-1"}),a.jsx("span",{className:"text-sm",children:"本月新增 +12"})]})]}),a.jsx(N.Z,{className:"h-12 w-12 text-blue-200"})]})})}),a.jsx(n.Zb,{className:"bg-gradient-to-br from-yellow-500 to-orange-500 text-white border-0 shadow-lg",children:a.jsx(n.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-yellow-100 text-sm font-medium",children:e("admin.review_management.pending_reviews")}),a.jsx("p",{className:"text-3xl font-bold mt-2",children:o.pendingReviews}),(0,a.jsxs)("div",{className:"flex items-center mt-2",children:[a.jsx(w.Z,{className:"h-4 w-4 mr-1"}),a.jsx("span",{className:"text-sm",children:"需要關注"})]})]}),a.jsx(f.Z,{className:"h-12 w-12 text-yellow-200"})]})})}),a.jsx(n.Zb,{className:"bg-gradient-to-br from-green-500 to-emerald-600 text-white border-0 shadow-lg",children:a.jsx(n.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-green-100 text-sm font-medium",children:"已通過"}),a.jsx("p",{className:"text-3xl font-bold mt-2",children:o.approvedReviews}),(0,a.jsxs)("div",{className:"flex items-center mt-2",children:[a.jsx(b.Z,{className:"h-4 w-4 mr-1"}),(0,a.jsxs)("span",{className:"text-sm",children:[(o.approvedReviews/o.totalReviews*100).toFixed(0),"% 通過率"]})]})]}),a.jsx(b.Z,{className:"h-12 w-12 text-green-200"})]})})}),a.jsx(n.Zb,{className:"bg-gradient-to-br from-red-500 to-pink-600 text-white border-0 shadow-lg",children:a.jsx(n.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-red-100 text-sm font-medium",children:"被檢舉"}),a.jsx("p",{className:"text-3xl font-bold mt-2",children:o.reportedReviews}),(0,a.jsxs)("div",{className:"flex items-center mt-2",children:[a.jsx(y.Z,{className:"h-4 w-4 mr-1"}),a.jsx("span",{className:"text-sm",children:"需立即處理"})]})]}),a.jsx(R.Z,{className:"h-12 w-12 text-red-200"})]})})})]}),(0,a.jsxs)(n.Zb,{children:[a.jsx(n.Ol,{children:(0,a.jsxs)(n.ll,{className:"flex items-center",children:[a.jsx(E.Z,{className:"h-5 w-5 mr-2"}),"篩選與搜尋"]})}),a.jsx(n.aY,{children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"relative",children:[a.jsx(P.Z,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),a.jsx(d.I,{placeholder:e("admin.review_management.search_reviews"),value:O,onChange:e=>S(e.target.value),className:"pl-10"})]}),(0,a.jsxs)("select",{value:k,onChange:e=>q(e.target.value),className:"p-2 border border-gray-300 rounded-md",children:[a.jsx("option",{value:"ALL",children:e("admin.review_management.all_status")}),a.jsx("option",{value:"PENDING",children:e("admin.review_management.pending")}),a.jsx("option",{value:"APPROVED",children:e("admin.review_management.approved")}),a.jsx("option",{value:"REJECTED",children:e("admin.review_management.rejected")}),a.jsx("option",{value:"REPORTED",children:e("admin.review_management.flagged")})]}),(0,a.jsxs)("select",{value:Y,onChange:e=>$(e.target.value),className:"p-2 border border-gray-300 rounded-md",children:[a.jsx("option",{value:"ALL",children:"所有評分"}),a.jsx("option",{value:"5",children:"⭐⭐⭐⭐⭐"}),a.jsx("option",{value:"4",children:"⭐⭐⭐⭐"}),a.jsx("option",{value:"3",children:"⭐⭐⭐"}),a.jsx("option",{value:"2",children:"⭐⭐"}),a.jsx("option",{value:"1",children:"⭐"})]}),a.jsx(l.z,{variant:"outline",onClick:()=>{S(""),q("ALL"),$("ALL")},children:"清除篩選"})]})})]}),(0,a.jsxs)(u,{value:U,onValueChange:M,children:[(0,a.jsxs)(h,{className:"grid w-full grid-cols-4",children:[(0,a.jsxs)(g,{value:"pending",className:"relative",children:[e("admin.review_management.pending"),o.pendingReviews>0&&a.jsx(m.Ct,{variant:"destructive",className:"ml-2 h-5 w-5 p-0 text-xs",children:o.pendingReviews})]}),a.jsx(g,{value:"approved",children:e("admin.review_management.approved")}),a.jsx(g,{value:"rejected",children:e("admin.review_management.rejected")}),(0,a.jsxs)(g,{value:"reported",className:"relative",children:[e("admin.review_management.flagged"),o.reportedReviews>0&&a.jsx(m.Ct,{variant:"destructive",className:"ml-2 h-5 w-5 p-0 text-xs",children:o.reportedReviews})]})]}),a.jsx(p,{value:U,className:"mt-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-6",children:[et(U).map(e=>a.jsx(n.Zb,{className:`hover:shadow-lg transition-shadow ${e.isReported?"border-red-200 bg-red-50/30":""}`,children:a.jsx(n.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex items-start space-x-4 flex-1",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center",children:a.jsx(I.Z,{className:"h-6 w-6 text-white"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[a.jsx("h3",{className:"font-semibold text-lg",children:e.userName}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[H(e.rating),(0,a.jsxs)("span",{className:"text-sm text-gray-600 ml-1",children:["(",e.rating,"/5)"]})]}),a.jsx(m.Ct,{className:`${K(e.status)}`,children:"PENDING"===e.status?"待審核":"APPROVED"===e.status?"已通過":"已拒絕"}),e.isReported&&(0,a.jsxs)(m.Ct,{variant:"destructive",className:"animate-pulse",children:[a.jsx(y.Z,{className:"h-3 w-3 mr-1"}),"被檢舉"]})]}),a.jsx("div",{className:"space-y-2 mb-4",children:(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[a.jsx(Z.Z,{className:"h-4 w-4 mr-1"}),a.jsx("span",{className:"mr-4",children:e.serviceName}),(0,a.jsxs)("span",{className:"mr-4",children:["地陪：",e.guideName]}),a.jsx(C.Z,{className:"h-4 w-4 mr-1"}),a.jsx("span",{children:new Date(e.createdAt).toLocaleDateString("zh-TW")})]})}),(0,a.jsxs)("div",{className:"mb-4",children:[a.jsx("p",{className:"text-gray-800 leading-relaxed",children:e.comment}),e.images&&e.images.length>0&&a.jsx("div",{className:"mt-3 flex space-x-2",children:e.images.map((e,s)=>a.jsx("img",{src:e,alt:`評論圖片 ${s+1}`,className:"w-20 h-20 object-cover rounded-lg cursor-pointer hover:opacity-80"},s))})]}),e.responseFromGuide&&(0,a.jsxs)("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 mt-4",children:[(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[a.jsx(_.Z,{className:"h-4 w-4 text-blue-600 mr-2"}),a.jsx("span",{className:"text-sm font-medium text-blue-800",children:"地陪回覆"})]}),a.jsx("p",{className:"text-gray-700 text-sm",children:e.responseFromGuide})]}),e.moderatorNote&&(0,a.jsxs)("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 mt-4",children:[(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[a.jsx(R.Z,{className:"h-4 w-4 text-yellow-600 mr-2"}),a.jsx("span",{className:"text-sm font-medium text-yellow-800",children:"審核備註"})]}),a.jsx("p",{className:"text-gray-700 text-sm",children:e.moderatorNote})]}),a.jsx("div",{className:"flex items-center justify-between mt-4 pt-4 border-t border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[a.jsx("span",{className:`font-medium ${ee(e.sentiment)}`,children:"POSITIVE"===e.sentiment?"正面評論":"NEGATIVE"===e.sentiment?"負面評論":"中性評論"}),e.reportCount>0&&(0,a.jsxs)("span",{className:"text-red-600",children:[a.jsx(y.Z,{className:"h-4 w-4 inline mr-1"}),e.reportCount," 次檢舉"]})]})})]})]}),(0,a.jsxs)("div",{className:"flex flex-col space-y-2 ml-4",children:["PENDING"===e.status&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(l.z,{size:"sm",className:"bg-green-600 hover:bg-green-700",onClick:()=>X(e.id),children:[a.jsx(A.Z,{className:"h-4 w-4 mr-2"}),"通過"]}),(0,a.jsxs)(l.z,{size:"sm",variant:"destructive",onClick:()=>{L(e)},children:[a.jsx(D.Z,{className:"h-4 w-4 mr-2"}),"拒絕"]})]}),(0,a.jsxs)(l.z,{size:"sm",variant:"outline",children:[a.jsx(G.Z,{className:"h-4 w-4 mr-2"}),"詳細"]})]})]})})},e.id)),0===et(U).length&&a.jsx(n.Zb,{children:(0,a.jsxs)(n.aY,{className:"p-12 text-center",children:[a.jsx(v.Z,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"沒有找到評論"}),a.jsx("p",{className:"text-gray-600",children:"目前沒有符合篩選條件的評論"})]})})]})})]}),T&&"PENDING"===T.status&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)(n.Zb,{className:"w-full max-w-md mx-4",children:[(0,a.jsxs)(n.Ol,{children:[a.jsx(n.ll,{children:"拒絕評論"}),a.jsx(n.SZ,{children:"請提供拒絕理由（可選）"})]}),(0,a.jsxs)(n.aY,{className:"space-y-4",children:[a.jsx(c.g,{placeholder:"輸入拒絕理由...",value:F,onChange:e=>J(e.target.value),rows:3}),(0,a.jsxs)("div",{className:"flex space-x-2 justify-end",children:[a.jsx(l.z,{variant:"outline",onClick:()=>{L(null),J("")},children:"取消"}),a.jsx(l.z,{variant:"destructive",onClick:()=>{B(T.id),L(null)},children:"確認拒絕"})]})]})]})})]})}},45987:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>i,__esModule:()=>r,default:()=>n});let a=(0,t(86843).createProxy)(String.raw`/Users/zoechang/projects/Guidee/src/app/admin/reviews/page.tsx`),{__esModule:r,$$typeof:i}=a,n=a.default}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[1216,8039,4471,7585],()=>t(32181));module.exports=a})();