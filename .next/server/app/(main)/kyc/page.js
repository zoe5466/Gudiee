(()=>{var e={};e.id=9067,e.ids=[9067],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},39186:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>x,originalPathname:()=>o,pages:()=>m,routeModule:()=>u,tree:()=>c});var a=t(50482),r=t(69108),l=t(62563),i=t.n(l),n=t(68300),d={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>n[e]);t.d(s,d);let c=["",{children:["(main)",{children:["kyc",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,16768)),"/Users/zoechang/projects/Guidee/src/app/(main)/kyc/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,11808)),"/Users/zoechang/projects/Guidee/src/app/(main)/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,69361,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,98890)),"/Users/zoechang/projects/Guidee/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,69361,23)),"next/dist/client/components/not-found-error"]}],m=["/Users/zoechang/projects/Guidee/src/app/(main)/kyc/page.tsx"],o="/(main)/kyc/page",x={require:t,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/(main)/kyc/page",pathname:"/kyc",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},12172:(e,s,t)=>{Promise.resolve().then(t.bind(t,31400))},31400:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>m});var a=t(95344),r=t(3729),l=t(22254),i=t(2582),n=t(72032),d=t(58378),c=t(51653);function m(){let e=(0,l.useRouter)(),{user:s,isAuthenticated:t,isLoading:m}=(0,i.a)(),{success:o,error:x}=(0,n.pm)(),[u,h]=(0,r.useState)(1),[p,g]=(0,r.useState)(!1),[b,j]=(0,r.useState)({idNumber:"",birthDate:"",address:"",emergencyContact:"",idFrontImage:"",idBackImage:"",selfieImage:""}),[N,f]=(0,r.useState)({});(0,r.useEffect)(()=>{if(!m&&!t){e.push("/login");return}if(s?.isKYCVerified){e.push("/profile");return}},[t,m,s,e]);let v=()=>{let e={};if(b.idNumber.trim()?/^[A-Z][1-2]\d{8}$/.test(b.idNumber.toUpperCase())||(e.idNumber="請輸入有效的身分證字號格式"):e.idNumber="請輸入身分證字號",b.birthDate){let s=new Date(b.birthDate).getFullYear();new Date().getFullYear()-s<18&&(e.birthDate="必須年滿18歲")}else e.birthDate="請選擇出生日期";return b.address.trim()||(e.address="請輸入聯絡地址"),f(e),0===Object.keys(e).length},y=()=>{let e={};return b.idFrontImage||(e.idFrontImage="請上傳身分證正面照片"),b.idBackImage||(e.idBackImage="請上傳身分證背面照片"),f(e),0===Object.keys(e).length},w=()=>{let e={};return b.selfieImage||(e.selfieImage="請上傳手持身分證的自拍照"),f(e),0===Object.keys(e).length},k=(e,s)=>{j(t=>({...t,[e]:s})),N[e]&&f(s=>({...s,[e]:void 0}))},C=async()=>{g(!0);try{if(!(await fetch("/api/kyc/submit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)})).ok)throw Error("提交失敗");o("提交成功","您的KYC申請已提交，我們將在24-48小時內完成審核"),e.push("/profile")}catch(e){x("提交失敗","無法提交KYC申請，請稍後再試")}finally{g(!1)}};return m||!s?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsx(d.gb,{size:"lg"})}):a.jsx("div",{className:"min-h-screen bg-gray-50 py-12",children:a.jsx("div",{className:"container max-w-4xl",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-r from-[#FF5A5F] to-[#E1464A] px-6 py-8",children:[a.jsx("h1",{className:"text-3xl font-bold text-white",children:"身分驗證 (KYC)"}),a.jsx("p",{className:"text-red-100 mt-2",children:"為了確保平台安全，請完成身分驗證程序"})]}),(0,a.jsxs)("div",{className:"px-6 py-4 bg-gray-50",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"驗證進度"}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:["第 ",u," 步，共 3 步"]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-[#FF5A5F] h-2 rounded-full transition-all duration-300",style:{width:`${u/3*100}%`}})})]}),a.jsx("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:["第",u,"步：",{1:"個人基本資料",2:"身分證明文件",3:"本人驗證照片"}[u]]}),1===u&&a.jsx("form",{className:"space-y-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"idNumber",className:"block text-sm font-medium text-gray-700",children:"身分證字號 *"}),a.jsx("input",{type:"text",id:"idNumber",name:"idNumber",value:b.idNumber,onChange:e=>k("idNumber",e.target.value.toUpperCase()),className:`input mt-1 w-full ${N.idNumber?"border-red-500 focus:border-red-500 focus:ring-red-200":""}`,placeholder:"例：A123456789",maxLength:10}),N.idNumber&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:N.idNumber})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"birthDate",className:"block text-sm font-medium text-gray-700",children:"出生日期 *"}),a.jsx("input",{type:"date",id:"birthDate",name:"birthDate",value:b.birthDate,onChange:e=>k("birthDate",e.target.value),className:`input mt-1 w-full ${N.birthDate?"border-red-500 focus:border-red-500 focus:ring-red-200":""}`,max:new Date(new Date().setFullYear(new Date().getFullYear()-18)).toISOString().split("T")[0]}),N.birthDate&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:N.birthDate})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[a.jsx("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700",children:"聯絡地址 *"}),a.jsx("input",{type:"text",id:"address",name:"address",value:b.address,onChange:e=>k("address",e.target.value),className:`input mt-1 w-full ${N.address?"border-red-500 focus:border-red-500 focus:ring-red-200":""}`,placeholder:"請輸入詳細地址（包含郵遞區號）"}),N.address&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:N.address})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[a.jsx("label",{htmlFor:"emergencyContact",className:"block text-sm font-medium text-gray-700",children:"緊急聯絡人"}),a.jsx("input",{type:"text",id:"emergencyContact",name:"emergencyContact",value:b.emergencyContact,onChange:e=>k("emergencyContact",e.target.value),className:"input mt-1 w-full",placeholder:"姓名 + 電話 (選填)"})]})]})}),2===u&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"身分證正面 *"}),a.jsx(c.U,{value:b.idFrontImage,onChange:e=>k("idFrontImage",e),accept:"image/jpeg,image/png",maxSize:5,className:"h-48"}),N.idFrontImage&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:N.idFrontImage})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"身分證背面 *"}),a.jsx(c.U,{value:b.idBackImage,onChange:e=>k("idBackImage",e),accept:"image/jpeg,image/png",maxSize:5,className:"h-48"}),N.idBackImage&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:N.idBackImage})]})]}),a.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("svg",{className:"h-5 w-5 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),(0,a.jsxs)("div",{className:"ml-3",children:[a.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"注意事項"}),a.jsx("div",{className:"mt-2 text-sm text-yellow-700",children:(0,a.jsxs)("ul",{className:"list-disc list-inside space-y-1",children:[a.jsx("li",{children:"請確保照片清晰，文字可清楚讀取"}),a.jsx("li",{children:"照片中不得有反光或陰影遮擋"}),a.jsx("li",{children:"支援格式：JPG、PNG，檔案大小不超過5MB"})]})})]})]})})]}),3===u&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"max-w-md mx-auto",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3 text-center",children:"手持身分證的自拍照 *"}),a.jsx(c.U,{value:b.selfieImage,onChange:e=>k("selfieImage",e),accept:"image/jpeg,image/png",maxSize:5,className:"h-64"}),N.selfieImage&&a.jsx("p",{className:"mt-1 text-sm text-red-600 text-center",children:N.selfieImage})]}),a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("svg",{className:"h-5 w-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),(0,a.jsxs)("div",{className:"ml-3",children:[a.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"拍照指引"}),a.jsx("div",{className:"mt-2 text-sm text-blue-700",children:(0,a.jsxs)("ul",{className:"list-disc list-inside space-y-1",children:[a.jsx("li",{children:"請手持身分證於胸前，確保身分證資訊清楚可見"}),a.jsx("li",{children:"請確保您的臉部完整入鏡，表情自然"}),a.jsx("li",{children:"光線充足，背景簡潔，避免反光或陰影"}),a.jsx("li",{children:"請勿戴帽子、口罩或太陽眼鏡"})]})})]})]})})]}),a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mt-6",children:(0,a.jsxs)("div",{className:"flex",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("svg",{className:"h-5 w-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),(0,a.jsxs)("div",{className:"ml-3",children:[a.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"隱私保護承諾"}),a.jsx("div",{className:"mt-2 text-sm text-blue-700",children:a.jsx("p",{children:"您的個人資料將採用 SSL 加密傳輸，並嚴格遵循個人資料保護法規。 我們不會將您的資料用於身分驗證以外的用途。"})})]})]})}),(0,a.jsxs)("div",{className:"flex justify-between mt-8",children:[a.jsx("div",{children:u>1&&a.jsx("button",{type:"button",onClick:()=>{u>1&&h(e=>e-1)},className:"btn btn-ghost btn-md",children:"上一步"})}),(0,a.jsxs)("div",{className:"flex space-x-4",children:[a.jsx("button",{type:"button",onClick:()=>e.push("/profile"),className:"btn btn-ghost btn-md",children:"稍後完成"}),a.jsx("button",{type:"button",onClick:()=>{let e=!1;switch(u){case 1:e=v();break;case 2:e=y();break;case 3:e=w()}e&&u<3?h(e=>e+1):e&&3===u&&C()},disabled:p,className:"btn btn-primary btn-md disabled:opacity-50 disabled:cursor-not-allowed",children:p?(0,a.jsxs)("div",{className:"flex items-center justify-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"提交中..."]}):3===u?"提交驗證":"下一步"})]})]})]})})]})})})}},16768:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>l,__esModule:()=>r,default:()=>i});let a=(0,t(86843).createProxy)(String.raw`/Users/zoechang/projects/Guidee/src/app/(main)/kyc/page.tsx`),{__esModule:r,$$typeof:l}=a,i=a.default}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[1216,8039,4757,8290,3450],()=>t(39186));module.exports=a})();