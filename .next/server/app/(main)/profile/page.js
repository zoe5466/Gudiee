(()=>{var e={};e.id=86,e.ids=[86],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},89490:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>c,routeModule:()=>p,tree:()=>d});var a=t(50482),l=t(69108),r=t(62563),n=t.n(r),i=t(68300),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);t.d(s,o);let d=["",{children:["(main)",{children:["profile",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,46588)),"/Users/zoechang/projects/Guidee/src/app/(main)/profile/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,11808)),"/Users/zoechang/projects/Guidee/src/app/(main)/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,69361,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,98890)),"/Users/zoechang/projects/Guidee/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,69361,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/zoechang/projects/Guidee/src/app/(main)/profile/page.tsx"],x="/(main)/profile/page",m={require:t,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:l.x.APP_PAGE,page:"/(main)/profile/page",pathname:"/profile",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},79043:(e,s,t)=>{Promise.resolve().then(t.bind(t,37730))},37730:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>C});var a=t(95344),l=t(3729),r=t(22254),n=t(75695),i=t(80508),o=t(55794),d=t(96213),c=t(51354),x=t(76755),m=t(85674),p=t(33037),h=t(23485),u=t(30304),g=t(13746),b=t(2582),f=t(51653),j=t(14513),y=t(11453);function v({isOpen:e,onClose:s,title:t,description:r,children:n,size:i="md",showCloseButton:o=!0,closeOnOverlayClick:d=!0,className:c}){return(l.useEffect(()=>{let t=e=>{"Escape"===e.key&&s()};return e&&(document.addEventListener("keydown",t),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",t),document.body.style.overflow="unset"}},[e,s]),e)?(0,a.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:d?s:void 0}),a.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:(0,a.jsxs)("div",{className:(0,y.cn)("relative w-full bg-white rounded-xl shadow-2xl transform transition-all",{sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl",full:"max-w-[95vw] max-h-[95vh]"}[i],c),onClick:e=>e.stopPropagation(),children:[(t||o)&&(0,a.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,a.jsxs)("div",{children:[t&&a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:t}),r&&a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:r})]}),o&&a.jsx("button",{onClick:s,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors","aria-label":"關閉",children:a.jsx(j.Z,{className:"w-5 h-5 text-gray-400"})})]}),a.jsx("div",{className:"p-6",children:n})]})})]}):null}var N=t(58378),w=t(72032),k=t(4792);function C(){let e=(0,r.useRouter)(),{user:s,updateUser:t,isLoading:j,isAuthenticated:y}=(0,b.a)(),{success:C,error:P}=(0,w.pm)(),{isOpen:_,openModal:S,closeModal:Z}=function(){let[e,s]=l.useState(!1);return{isOpen:e,openModal:()=>s(!0),closeModal:()=>s(!1),toggleModal:()=>s(!e)}}(),[z,q]=(0,l.useState)({name:"",phone:"",bio:"",location:"",languages:[],specialties:[],avatar:""}),[A,E]=(0,l.useState)({}),[R,B]=(0,l.useState)(!1);(0,l.useEffect)(()=>{if(!y){e.push("/login");return}},[y,e]),(0,l.useEffect)(()=>{s&&q({name:s.name||"",phone:s.profile?.phone||"",bio:s.profile?.bio||"",location:s.profile?.location||"",languages:s.profile?.languages||[],specialties:s.profile?.specialties||[],avatar:s.avatar||""})},[s]);let G=()=>{let e={};return z.name.trim()?z.name.trim().length<2&&(e.name="姓名至少需要2個字元"):e.name="請輸入姓名",z.phone&&!/^09\d{8}$/.test(z.phone.replace(/\D/g,""))&&(e.phone="請輸入有效的台灣手機號碼格式"),z.bio&&z.bio.length>500&&(e.bio="自我介紹不能超過500個字元"),E(e),0===Object.keys(e).length},M=(e,s)=>{q(t=>({...t,[e]:s})),A[e]&&E(s=>({...s,[e]:void 0}))},T=async()=>{if(G()){B(!0);try{await t({name:z.name,avatar:z.avatar,profile:{phone:z.phone,bio:z.bio,location:z.location,languages:z.languages,specialties:z.specialties}}),C("更新成功","您的個人資料已成功更新"),Z()}catch(e){P("更新失敗","無法更新個人資料，請稍後再試")}finally{B(!1)}}};return y&&s?(0,a.jsxs)("div",{style:{minHeight:"100vh",background:"linear-gradient(to bottom right, #dbeafe, #ffffff, #e0e7ff)"},children:[a.jsx(k.us,{}),(0,a.jsxs)("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"1rem"},className:"sm:p-8",children:[(0,a.jsxs)("div",{className:"mb-8",children:[a.jsx("h1",{className:"heading-1 text-gray-900 mb-2",children:"個人中心"}),a.jsx("p",{className:"body-large",children:"管理您的個人資料和偏好設定"})]}),(0,a.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:"2rem"},className:"lg:grid-cols-3",children:[(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"2rem"},className:"lg:col-span-2",children:[(0,a.jsxs)("div",{style:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"1rem",padding:"1.5rem",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)"},children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-6",children:[a.jsx("h2",{className:"heading-3",children:"個人資料"}),(0,a.jsxs)("button",{onClick:S,className:"btn btn-secondary btn-sm flex items-center gap-2",children:[a.jsx(n.Z,{className:"w-4 h-4"}),"編輯"]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-6 mb-6",children:[(0,a.jsxs)("div",{className:"relative",children:[s.avatar?a.jsx("img",{src:s.avatar,alt:s.name,className:"w-24 h-24 rounded-full object-cover"}):a.jsx("div",{className:"w-24 h-24 bg-gray-200 rounded-full flex items-center justify-center",children:a.jsx("span",{className:"text-2xl font-bold text-gray-400",children:s.name.charAt(0)})}),a.jsx("div",{className:"absolute -bottom-1 -right-1 flex space-x-1",children:s.isEmailVerified&&a.jsx("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center",children:a.jsx("span",{className:"text-white text-xs",children:"✓"})})})]}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:s.name}),a.jsx("p",{className:"text-gray-600 mb-2",children:s.profile?.bio||"還沒有自我介紹"}),(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-500 space-x-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[a.jsx(i.Z,{className:"w-4 h-4"}),s.profile?.location||"未設定地區"]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[a.jsx(o.Z,{className:"w-4 h-4"}),"加入於 ",new Date(s.createdAt).toLocaleDateString("zh-TW")]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-3",children:[a.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${"guide"===s.role?"bg-[#FF5A5F] text-white":"bg-blue-100 text-blue-800"}`,children:"guide"===s.role?"地陪":"旅客"}),!s.isKYCVerified&&a.jsx("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs font-medium",children:"待驗證"})]})]})]}),s.profile?.specialties&&s.profile.specialties.length>0&&(0,a.jsxs)("div",{className:"mb-4",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"專長領域"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:s.profile.specialties.map((e,s)=>a.jsx("span",{className:"px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm",children:e},s))})]}),s.profile?.languages&&s.profile.languages.length>0&&(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"語言能力"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:s.profile.languages.map((e,s)=>a.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm",children:e},s))})]})]}),(0,a.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"1rem"},className:"md:grid-cols-4",children:[(0,a.jsxs)("div",{style:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"1rem",padding:"1rem",textAlign:"center",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)"},children:[a.jsx("div",{className:"text-2xl font-bold text-gray-900",children:"12"}),a.jsx("div",{className:"text-sm text-gray-600",children:"完成預訂"})]}),(0,a.jsxs)("div",{style:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"1rem",padding:"1rem",textAlign:"center",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)"},children:[a.jsx("div",{className:"text-2xl font-bold text-gray-900",children:"4.8"}),a.jsx("div",{className:"text-sm text-gray-600",children:"平均評分"})]}),(0,a.jsxs)("div",{style:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"1rem",padding:"1rem",textAlign:"center",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)"},children:[a.jsx("div",{className:"text-2xl font-bold text-gray-900",children:"8"}),a.jsx("div",{className:"text-sm text-gray-600",children:"收藏地陪"})]}),(0,a.jsxs)("div",{style:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"1rem",padding:"1rem",textAlign:"center",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)"},children:[a.jsx("div",{className:"text-2xl font-bold text-gray-900",children:"3"}),a.jsx("div",{className:"text-sm text-gray-600",children:"本月預訂"})]})]})]}),(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[(0,a.jsxs)("div",{style:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"1rem",padding:"1.5rem",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)"},children:[a.jsx("h3",{className:"heading-3 mb-4",children:"快速操作"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("button",{onClick:()=>e.push("/my-bookings"),className:"w-full flex items-center gap-3 p-3 text-left hover:bg-gray-50 rounded-lg transition-colors",children:[a.jsx(d.Z,{className:"w-5 h-5 text-gray-400"}),a.jsx("span",{children:"預訂歷史"})]}),"guide"===s.role&&(0,a.jsxs)("button",{onClick:()=>e.push("/guide-dashboard"),className:"w-full flex items-center gap-3 p-3 text-left hover:bg-blue-50 rounded-lg transition-colors",children:[a.jsx(i.Z,{className:"w-5 h-5 text-blue-500"}),a.jsx("span",{style:{color:"#2563eb",fontWeight:"500"},children:"導遊控制台"})]}),(0,a.jsxs)("button",{className:"w-full flex items-center gap-3 p-3 text-left hover:bg-gray-50 rounded-lg transition-colors",children:[a.jsx(c.Z,{className:"w-5 h-5 text-gray-400"}),a.jsx("span",{children:"我的收藏"})]}),(0,a.jsxs)("button",{className:"w-full flex items-center gap-3 p-3 text-left hover:bg-gray-50 rounded-lg transition-colors",children:[a.jsx(x.Z,{className:"w-5 h-5 text-gray-400"}),a.jsx("span",{children:"我的評價"})]}),(0,a.jsxs)("button",{className:"w-full flex items-center gap-3 p-3 text-left hover:bg-gray-50 rounded-lg transition-colors",children:[a.jsx(m.Z,{className:"w-5 h-5 text-gray-400"}),a.jsx("span",{children:"付款方式"})]})]})]}),(0,a.jsxs)("div",{style:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"1rem",padding:"1.5rem",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)"},children:[a.jsx("h3",{className:"heading-3 mb-4",children:"設定"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("button",{className:"w-full flex items-center gap-3 p-3 text-left hover:bg-gray-50 rounded-lg transition-colors",children:[a.jsx(p.Z,{className:"w-5 h-5 text-gray-400"}),a.jsx("span",{children:"通知設定"})]}),(0,a.jsxs)("button",{className:"w-full flex items-center gap-3 p-3 text-left hover:bg-gray-50 rounded-lg transition-colors",children:[a.jsx(h.Z,{className:"w-5 h-5 text-gray-400"}),a.jsx("span",{children:"隱私設定"})]}),(0,a.jsxs)("button",{className:"w-full flex items-center gap-3 p-3 text-left hover:bg-gray-50 rounded-lg transition-colors",children:[a.jsx(u.Z,{className:"w-5 h-5 text-gray-400"}),a.jsx("span",{children:"語言設定"})]}),(0,a.jsxs)("button",{className:"w-full flex items-center gap-3 p-3 text-left hover:bg-gray-50 rounded-lg transition-colors",children:[a.jsx(g.Z,{className:"w-5 h-5 text-gray-400"}),a.jsx("span",{children:"帳戶設定"})]})]})]}),!s.isKYCVerified&&(0,a.jsxs)("div",{className:"card p-6 bg-yellow-50 border-yellow-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-yellow-800 mb-2",children:"完成身分驗證"}),a.jsx("p",{className:"text-sm text-yellow-700 mb-4",children:"完成 KYC 驗證可以提升帳戶安全性並解鎖更多功能"}),a.jsx("button",{onClick:()=>e.push("/kyc"),className:"btn btn-primary btn-sm w-full",children:"立即驗證"})]})]})]})]}),a.jsx(v,{isOpen:_,onClose:Z,title:"編輯個人資料",size:"lg",children:(0,a.jsxs)("form",{className:"space-y-6",children:[a.jsx(f.G,{value:z.avatar,onChange:e=>{M("avatar",e)},size:"lg"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"姓名 *"}),a.jsx("input",{type:"text",value:z.name,onChange:e=>M("name",e.target.value),className:`input w-full ${A.name?"border-red-500 focus:border-red-500 focus:ring-red-200":""}`,required:!0}),A.name&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:A.name})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"電子郵件 *"}),a.jsx("input",{type:"email",value:s.email,className:"input bg-gray-50 w-full",disabled:!0})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"手機號碼"}),a.jsx("input",{type:"tel",value:z.phone,onChange:e=>M("phone",e.target.value),className:`input w-full ${A.phone?"border-red-500 focus:border-red-500 focus:ring-red-200":""}`,placeholder:"例：0912345678"}),A.phone&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:A.phone})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"所在地區"}),a.jsx("input",{type:"text",value:z.location,onChange:e=>M("location",e.target.value),className:"input w-full",placeholder:"例：台北市"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"自我介紹"}),a.jsx("textarea",{value:z.bio,onChange:e=>M("bio",e.target.value),className:`input min-h-[100px] w-full ${A.bio?"border-red-500 focus:border-red-500 focus:ring-red-200":""}`,placeholder:"告訴大家關於您的故事...",maxLength:500}),(0,a.jsxs)("div",{className:"flex justify-between items-center mt-1",children:[A.bio&&a.jsx("p",{className:"text-sm text-red-600",children:A.bio}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 ml-auto",children:[z.bio.length,"/500"]})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-4",children:[a.jsx("button",{type:"button",onClick:Z,className:"btn btn-ghost btn-md",children:"取消"}),a.jsx("button",{type:"button",onClick:T,disabled:R,className:"btn btn-primary btn-md disabled:opacity-50 disabled:cursor-not-allowed",children:R?(0,a.jsxs)("div",{className:"flex items-center justify-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"儲存中..."]}):"儲存變更"})]})]})})]}):a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsx(N.gb,{size:"lg"})})}},4792:(e,s,t)=>{"use strict";t.d(s,{L6:()=>o,d8:()=>n,us:()=>i});var a=t(95344),l=t(22254),r=t(71532);function n({showBackButton:e=!1,backButtonText:s="返回",showHomeButton:t=!0,homeButtonText:n="回到首頁",customBackAction:i}){let o=(0,l.useRouter)();return(0,a.jsxs)(a.Fragment,{children:[t&&a.jsx("div",{style:{position:"absolute",top:"1rem",left:"1rem",zIndex:50},className:"sm:top-8 sm:left-8",children:(0,a.jsxs)("button",{onClick:()=>{o.push("/")},style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0.75rem",backgroundColor:"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(10px)",borderRadius:"0.5rem",border:"1px solid rgba(255, 255, 255, 0.3)",cursor:"pointer",transition:"all 0.2s",fontSize:"0.75rem",fontWeight:"500",color:"#374151",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)"},className:"hover:bg-white hover:shadow-md sm:text-sm sm:px-4 sm:py-3",children:[(0,a.jsxs)("span",{className:"hidden sm:inline",children:["← ",n]}),a.jsx("span",{className:"sm:hidden",children:"← 首頁"})]})}),e&&a.jsx("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"1rem 1.5rem",paddingTop:t?"4rem":"1rem"},children:(0,a.jsxs)("button",{onClick:()=>{i?i():o.back()},style:{display:"flex",alignItems:"center",gap:"0.5rem",color:"#6b7280",background:"none",border:"none",cursor:"pointer",fontSize:"0.875rem",transition:"color 0.2s",padding:"0.5rem 0"},className:"hover:text-gray-900",children:[a.jsx(r.Z,{style:{width:"1.25rem",height:"1.25rem"}}),a.jsx("span",{children:s})]})})]})}function i({text:e="回到首頁"}){return a.jsx(n,{showHomeButton:!0,homeButtonText:e,showBackButton:!1})}function o({backButtonText:e="返回",homeButtonText:s="回到首頁",customBackAction:t}){return a.jsx(n,{showHomeButton:!0,showBackButton:!0,backButtonText:e,homeButtonText:s,customBackAction:t})}},46588:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>r,__esModule:()=>l,default:()=>n});let a=(0,t(86843).createProxy)(String.raw`/Users/zoechang/projects/Guidee/src/app/(main)/profile/page.tsx`),{__esModule:l,$$typeof:r}=a,n=a.default}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[1216,8039,4757,8290,3450],()=>t(89490));module.exports=a})();