"use strict";exports.id=7913,exports.ids=[7913],exports.modules={47913:(e,t,s)=>{s.d(t,{j:()=>$});var a=s(95344),r=s(3729),i=s(35851),l=s(18822),n=s(23485),c=s(76755),d=s(25545),o=s(1560),m=s(51765),x=s(85979),g=s(26187),h=s(58378),u=s(43158),p=s(67023);let v=(0,u.Ue)()((0,p.tJ)((e,t)=>({reviews:[],userReviews:[],statistics:{},isLoading:!1,isSubmitting:!1,error:null,filters:{sortBy:"newest"},currentPage:1,totalPages:1,pageSize:10,fetchReviews:async(s,a)=>{e({isLoading:!0,error:null});try{await new Promise(e=>setTimeout(e,1e3));let r=Array.from({length:15},(e,t)=>({id:`review-${s}-${t+1}`,serviceId:"service"===a?s:`service-${Math.floor(5*Math.random())+1}`,guideId:"guide"===a?s:`guide-${Math.floor(10*Math.random())+1}`,userId:`user-${Math.floor(100*Math.random())+1}`,bookingId:`booking-${Math.floor(1e3*Math.random())+1}`,rating:Math.floor(5*Math.random())+1,comment:["非常棒的體驗！導遊很專業，行程安排得很好。","服務態度很好，但是時間安排有點緊湊。","超級推薦！導遊知識豐富，而且很幽默。","價格合理，服務品質很不錯。","導遊很準時，講解詳細，整體體驗很滿意。"][Math.floor(5*Math.random())],photos:Math.random()>.7?[`/images/review-${t+1}-1.jpg`,`/images/review-${t+1}-2.jpg`]:void 0,pros:Math.random()>.5?["專業知識","準時","親切"]:void 0,cons:Math.random()>.8?["時間安排緊湊"]:void 0,isVerified:Math.random()>.3,isAnonymous:Math.random()>.8,helpful:Math.floor(20*Math.random()),reported:Math.floor(3*Math.random()),response:Math.random()>.6?{content:"感謝您的評價！我們會繼續努力提供更好的服務。",authorId:"guide"===a?s:"admin-1",authorType:"guide"===a?"guide":"admin",createdAt:new Date(Date.now()-6048e5*Math.random()).toISOString()}:void 0,tags:Math.random()>.5?["專業","準時","親切"]:void 0,createdAt:new Date(Date.now()-2592e6*Math.random()).toISOString(),updatedAt:new Date(Date.now()-1296e6*Math.random()).toISOString(),status:"approved"})),i={averageRating:r.reduce((e,t)=>e+t.rating,0)/r.length,totalReviews:r.length,ratingDistribution:r.reduce((e,t)=>(e[t.rating]=(e[t.rating]||0)+1,e),{}),totalHelpful:r.reduce((e,t)=>e+t.helpful,0),verifiedReviewsCount:r.filter(e=>e.isVerified).length,responseRate:r.filter(e=>e.response).length/r.length*100,tags:r.reduce((e,t)=>(t.tags?.forEach(t=>{e[t]=(e[t]||0)+1}),e),{})};e({reviews:r,statistics:{...t().statistics,[s]:i},isLoading:!1})}catch(t){e({error:t instanceof Error?t.message:"載入評論失敗",isLoading:!1})}},fetchUserReviews:async t=>{e({isLoading:!0,error:null});try{await new Promise(e=>setTimeout(e,800));let s=Array.from({length:5},(e,s)=>({id:`user-review-${t}-${s+1}`,serviceId:`service-${Math.floor(5*Math.random())+1}`,guideId:`guide-${Math.floor(10*Math.random())+1}`,userId:t,bookingId:`booking-${Math.floor(1e3*Math.random())+1}`,rating:Math.floor(5*Math.random())+1,comment:"很棒的體驗！",isVerified:!0,isAnonymous:Math.random()>.7,helpful:Math.floor(10*Math.random()),reported:0,tags:["專業","準時"],createdAt:new Date(Date.now()-5184e6*Math.random()).toISOString(),updatedAt:new Date().toISOString(),status:"approved"}));e({userReviews:s,isLoading:!1})}catch(t){e({error:t instanceof Error?t.message:"載入用戶評論失敗",isLoading:!1})}},submitReview:async t=>{e({isSubmitting:!0,error:null});try{await new Promise(e=>setTimeout(e,1500));let s={...t,id:`review-${Date.now()}`,helpful:0,reported:0,status:"pending",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};e(e=>({reviews:[s,...e.reviews],userReviews:[s,...e.userReviews],isSubmitting:!1}))}catch(t){throw e({error:t instanceof Error?t.message:"提交評論失敗",isSubmitting:!1}),t}},updateReview:async(t,s)=>{e({isSubmitting:!0,error:null});try{await new Promise(e=>setTimeout(e,1e3)),e(e=>({reviews:e.reviews.map(e=>e.id===t?{...e,...s,updatedAt:new Date().toISOString()}:e),userReviews:e.userReviews.map(e=>e.id===t?{...e,...s,updatedAt:new Date().toISOString()}:e),isSubmitting:!1}))}catch(t){throw e({error:t instanceof Error?t.message:"更新評論失敗",isSubmitting:!1}),t}},deleteReview:async t=>{e({isSubmitting:!0,error:null});try{await new Promise(e=>setTimeout(e,800)),e(e=>({reviews:e.reviews.filter(e=>e.id!==t),userReviews:e.userReviews.filter(e=>e.id!==t),isSubmitting:!1}))}catch(t){throw e({error:t instanceof Error?t.message:"刪除評論失敗",isSubmitting:!1}),t}},reportReview:async(t,s)=>{try{await new Promise(e=>setTimeout(e,500)),e(e=>({reviews:e.reviews.map(e=>e.id===t?{...e,reported:e.reported+1}:e)}))}catch(t){throw e({error:t instanceof Error?t.message:"檢舉失敗"}),t}},markHelpful:async t=>{try{await new Promise(e=>setTimeout(e,300)),e(e=>({reviews:e.reviews.map(e=>e.id===t?{...e,helpful:e.helpful+1}:e)}))}catch(t){throw e({error:t instanceof Error?t.message:"標記有用失敗"}),t}},respondToReview:async(t,s)=>{e({isSubmitting:!0,error:null});try{await new Promise(e=>setTimeout(e,1e3));let a={content:s,authorId:"current-user-id",authorType:"guide",createdAt:new Date().toISOString()};e(e=>({reviews:e.reviews.map(e=>e.id===t?{...e,response:a,updatedAt:new Date().toISOString()}:e),isSubmitting:!1}))}catch(t){throw e({error:t instanceof Error?t.message:"回覆評論失敗",isSubmitting:!1}),t}},setFilters:t=>{e(e=>({filters:{...e.filters,...t},currentPage:1}))},setPage:t=>{e({currentPage:t})},resetFilters:()=>{e({filters:{sortBy:"newest"},currentPage:1})}}),{name:"guidee-reviews",partialize:e=>({userReviews:e.userReviews,statistics:e.statistics})}));var f=s(2582),j=s(46064),b=s(89895);function w({statistics:e,size:t="md",showDetails:s=!0,className:r=""}){let i={sm:{container:"p-3",rating:"text-2xl",stars:"w-4 h-4",text:"text-sm"},md:{container:"p-4",rating:"text-3xl",stars:"w-5 h-5",text:"text-base"},lg:{container:"p-6",rating:"text-4xl",stars:"w-6 h-6",text:"text-lg"}}[t];return(0,a.jsxs)("div",{className:`bg-white rounded-lg border ${i.container} ${r}`,children:[(0,a.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:`font-bold text-gray-900 ${i.rating}`,children:e.averageRating.toFixed(1)}),a.jsx("div",{className:"flex justify-center mb-1",children:((e,t)=>{let s=Math.floor(e),r=e%1>=.5;return a.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(e=>a.jsx(c.Z,{className:`${t} ${e<=s?"text-yellow-400 fill-yellow-400":e===s+1&&r?"text-yellow-400 fill-yellow-400":"text-gray-300"}`},e))})})(e.averageRating,i.stars)}),(0,a.jsxs)("div",{className:`text-gray-600 ${i.text}`,children:[e.totalReviews," 則評論"]})]}),s&&(0,a.jsxs)("div",{className:"flex-1 grid grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"flex justify-center mb-1",children:a.jsx(n.Z,{className:"w-5 h-5 text-green-600"})}),(0,a.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:[Math.round(e.verifiedReviewsCount/e.totalReviews*100),"%"]}),a.jsx("div",{className:"text-xs text-gray-600",children:"已驗證"})]}),(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"flex justify-center mb-1",children:a.jsx(j.Z,{className:"w-5 h-5 text-blue-600"})}),(0,a.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:[Math.round(e.responseRate),"%"]}),a.jsx("div",{className:"text-xs text-gray-600",children:"回覆率"})]}),(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"flex justify-center mb-1",children:a.jsx(b.Z,{className:"w-5 h-5 text-purple-600"})}),a.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.totalHelpful}),a.jsx("div",{className:"text-xs text-gray-600",children:"有用"})]})]})]}),s&&(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"評分分佈"}),[5,4,3,2,1].map(t=>{let s=e.ratingDistribution[t]||0,r=e.totalReviews>0?s/e.totalReviews*100:0;return(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1 w-12",children:[a.jsx("span",{className:"text-sm text-gray-600",children:t}),a.jsx(c.Z,{className:"w-3 h-3 text-yellow-400 fill-yellow-400"})]}),a.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-yellow-400 h-2 rounded-full transition-all duration-300",style:{width:`${r}%`}})}),a.jsx("div",{className:"text-sm text-gray-600 w-8 text-right",children:s})]},t)})]}),s&&Object.keys(e.tags).length>0&&(0,a.jsxs)("div",{className:"mt-4 pt-4 border-t",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"服務特色"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(e.tags).sort(([,e],[,t])=>t-e).slice(0,6).map(([e,t])=>(0,a.jsxs)("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:[e," (",t,")"]},e))})]})]})}var y=s(17418),N=s(25390),R=s(14513),S=s(20016),M=s(55794);function k({filters:e,onFiltersChange:t,onReset:s,totalReviews:l,availableTags:d=[],className:o=""}){let[m,x]=(0,r.useState)(!1),[g,h]=(0,r.useState)(!1),u=(0,r.useRef)(null);(0,r.useEffect)(()=>{let e=e=>{u.current&&!u.current.contains(e.target)&&(x(!1),h(!1))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let p=s=>{let a=e.tags||[],r=a.includes(s)?a.filter(e=>e!==s):[...a,s];t({tags:0===r.length?void 0:r})},v=()=>{let t=0;return e.rating&&e.rating.length<5&&t++,void 0!==e.verified&&t++,e.withPhotos&&t++,e.withResponse&&t++,e.tags&&e.tags.length>0&&t++,e.dateRange&&t++,t},f=v()>0;return(0,a.jsxs)("div",{className:`relative ${o}`,children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[a.jsx("select",{value:e.sortBy,onChange:e=>t({sortBy:e.target.value}),className:"px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[{value:"newest",label:"最新發布"},{value:"oldest",label:"最早發布"},{value:"highest",label:"評分最高"},{value:"lowest",label:"評分最低"},{value:"helpful",label:"最有用"}].map(e=>a.jsx("option",{value:e.value,children:e.label},e.value))}),(0,a.jsxs)("button",{onClick:()=>x(!m),className:`flex items-center gap-2 px-3 py-2 border rounded-md text-sm transition-colors ${f?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:[a.jsx(y.Z,{className:"w-4 h-4"}),"篩選",f&&a.jsx("span",{className:"bg-blue-500 text-white rounded-full w-5 h-5 text-xs flex items-center justify-center",children:v()}),a.jsx(N.Z,{className:"w-4 h-4"})]}),f&&a.jsx("button",{onClick:s,className:"text-sm text-gray-500 hover:text-gray-700",children:"清除篩選"})]}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:["共 ",l," 則評論"]})]}),m&&a.jsx("div",{ref:u,className:"absolute top-full left-0 mt-2 w-96 bg-white border border-gray-200 rounded-lg shadow-lg z-50",children:(0,a.jsxs)("div",{className:"p-4 space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[a.jsx("h3",{className:"font-medium text-gray-900",children:"篩選選項"}),a.jsx("button",{onClick:()=>x(!1),className:"text-gray-400 hover:text-gray-600",children:a.jsx(R.Z,{className:"w-4 h-4"})})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"text-sm font-medium text-gray-700 mb-3 flex items-center gap-2",children:[a.jsx(c.Z,{className:"w-4 h-4"}),"評分"]}),a.jsx("div",{className:"space-y-2",children:[{value:[5],label:"5 星"},{value:[4,5],label:"4 星以上"},{value:[3,4,5],label:"3 星以上"},{value:[2,3,4,5],label:"2 星以上"},{value:[1,2,3,4,5],label:"全部評分"}].map(s=>(0,a.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[a.jsx("input",{type:"radio",name:"rating",checked:5===s.value.length?!e.rating||5===e.rating.length:JSON.stringify(e.rating?.sort((e,t)=>t-e))===JSON.stringify(s.value),onChange:()=>t({rating:5===s.value.length?void 0:s.value}),className:"text-blue-600"}),a.jsx("span",{className:"text-sm text-gray-700",children:s.label})]},s.label))})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"text-sm font-medium text-gray-700 mb-3 flex items-center gap-2",children:[a.jsx(n.Z,{className:"w-4 h-4"}),"驗證狀態"]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[a.jsx("input",{type:"radio",name:"verified",checked:void 0===e.verified,onChange:()=>t({verified:void 0}),className:"text-blue-600"}),a.jsx("span",{className:"text-sm text-gray-700",children:"全部"})]}),(0,a.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[a.jsx("input",{type:"radio",name:"verified",checked:!0===e.verified,onChange:()=>t({verified:!0}),className:"text-blue-600"}),a.jsx("span",{className:"text-sm text-gray-700",children:"僅已驗證"})]}),(0,a.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[a.jsx("input",{type:"radio",name:"verified",checked:!1===e.verified,onChange:()=>t({verified:!1}),className:"text-blue-600"}),a.jsx("span",{className:"text-sm text-gray-700",children:"僅未驗證"})]})]})]}),(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"附加內容"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:e.withPhotos||!1,onChange:e=>t({withPhotos:e.target.checked||void 0}),className:"text-blue-600"}),a.jsx(S.Z,{className:"w-4 h-4 text-gray-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:"有照片"})]}),(0,a.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:e.withResponse||!1,onChange:e=>t({withResponse:e.target.checked||void 0}),className:"text-blue-600"}),a.jsx(i.Z,{className:"w-4 h-4 text-gray-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:"有回覆"})]})]})]}),d.length>0&&(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"服務特色"}),a.jsx("div",{className:"flex flex-wrap gap-2 max-h-32 overflow-y-auto",children:d.map(t=>a.jsx("button",{onClick:()=>p(t),className:`px-2 py-1 rounded-full text-sm border transition-colors ${e.tags?.includes(t)?"bg-blue-100 border-blue-300 text-blue-700":"bg-gray-50 border-gray-200 text-gray-700 hover:bg-gray-100"}`,children:t},t))})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"text-sm font-medium text-gray-700 mb-3 flex items-center gap-2",children:[a.jsx(M.Z,{className:"w-4 h-4"}),"日期範圍"]}),a.jsx("button",{onClick:()=>h(!g),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm text-left hover:bg-gray-50",children:e.dateRange?`${e.dateRange.start.toLocaleDateString()} - ${e.dateRange.end.toLocaleDateString()}`:"選擇日期範圍"}),g&&(0,a.jsxs)("div",{className:"mt-2 p-3 border border-gray-200 rounded-md bg-gray-50",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"開始日期"}),a.jsx("input",{type:"date",value:e.dateRange?.start.toISOString().split("T")[0]||"",onChange:s=>{t({dateRange:{start:new Date(s.target.value),end:e.dateRange?.end||new Date}})},className:"w-full px-2 py-1 border border-gray-300 rounded text-xs"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"結束日期"}),a.jsx("input",{type:"date",value:e.dateRange?.end.toISOString().split("T")[0]||"",onChange:s=>{let a=new Date(s.target.value);t({dateRange:{start:e.dateRange?.start||new Date,end:a}})},className:"w-full px-2 py-1 border border-gray-300 rounded text-xs"})]})]}),a.jsx("button",{onClick:()=>{t({dateRange:void 0}),h(!1)},className:"mt-2 text-xs text-gray-500 hover:text-gray-700",children:"清除日期範圍"})]})]})]})}),f&&(0,a.jsxs)("div",{className:"flex flex-wrap gap-2 mt-3",children:[e.rating&&e.rating.length<5&&(0,a.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:[1===e.rating.length?`${e.rating[0]} 星`:`${Math.min(...e.rating)}-${Math.max(...e.rating)} 星`,a.jsx("button",{onClick:()=>t({rating:void 0}),className:"hover:text-blue-600",children:a.jsx(R.Z,{className:"w-3 h-3"})})]}),void 0!==e.verified&&(0,a.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full",children:[e.verified?"已驗證":"未驗證",a.jsx("button",{onClick:()=>t({verified:void 0}),className:"hover:text-green-600",children:a.jsx(R.Z,{className:"w-3 h-3"})})]}),e.withPhotos&&(0,a.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded-full",children:["有照片",a.jsx("button",{onClick:()=>t({withPhotos:void 0}),className:"hover:text-purple-600",children:a.jsx(R.Z,{className:"w-3 h-3"})})]}),e.withResponse&&(0,a.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-orange-100 text-orange-800 text-xs rounded-full",children:["有回覆",a.jsx("button",{onClick:()=>t({withResponse:void 0}),className:"hover:text-orange-600",children:a.jsx(R.Z,{className:"w-3 h-3"})})]}),e.tags?.map(e=>a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-gray-100 text-gray-800 text-xs rounded-full",children:[e,a.jsx("button",{onClick:()=>p(e),className:"hover:text-gray-600",children:a.jsx(R.Z,{className:"w-3 h-3"})})]},e)),e.dateRange&&(0,a.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-indigo-100 text-indigo-800 text-xs rounded-full",children:[e.dateRange.start.toLocaleDateString()," - ",e.dateRange.end.toLocaleDateString(),a.jsx("button",{onClick:()=>t({dateRange:void 0}),className:"hover:text-indigo-600",children:a.jsx(R.Z,{className:"w-3 h-3"})})]})]})]})}var D=s(72032);function $({targetId:e,targetType:t,showTitle:s=!0,showFilters:u=!0,showStatistics:p=!0,maxItems:j,className:b=""}){let{user:y}=(0,f.a)(),{success:N,error:R}=(0,D.pm)(),{reviews:S,statistics:M,isLoading:$,filters:Z,fetchReviews:C,markHelpful:A,reportReview:I,respondToReview:T,setFilters:P,resetFilters:O}=v(),[E,L]=(0,r.useState)([]),[F,z]=(0,r.useState)(null),[B,V]=(0,r.useState)("");(0,r.useEffect)(()=>{C(e,t)},[e,t,C]),(0,r.useEffect)(()=>{let e=[...S];switch(Z.rating&&Z.rating.length<5&&(e=e.filter(e=>Z.rating.includes(e.rating))),void 0!==Z.verified&&(e=e.filter(e=>e.isVerified===Z.verified)),Z.withPhotos&&(e=e.filter(e=>e.photos&&e.photos.length>0)),Z.withResponse&&(e=e.filter(e=>e.response)),Z.tags&&Z.tags.length>0&&(e=e.filter(e=>e.tags&&Z.tags.some(t=>e.tags.includes(t)))),Z.dateRange&&(e=e.filter(e=>{let t=new Date(e.createdAt);return t>=Z.dateRange.start&&t<=Z.dateRange.end})),Z.sortBy){case"newest":e.sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime());break;case"oldest":e.sort((e,t)=>new Date(e.createdAt).getTime()-new Date(t.createdAt).getTime());break;case"highest":e.sort((e,t)=>t.rating-e.rating);break;case"lowest":e.sort((e,t)=>e.rating-t.rating);break;case"helpful":e.sort((e,t)=>t.helpful-e.helpful)}j&&(e=e.slice(0,j)),L(e)},[S,Z,j]);let H=e=>{let t=new Date(e),s=(new Date().getTime()-t.getTime())/36e5;return s<24?`${Math.floor(s)} 小時前`:s<168?`${Math.floor(s/24)} 天前`:t.toLocaleDateString("zh-TW",{year:"numeric",month:"long",day:"numeric"})},J=async e=>{try{await A(e),N("標記成功","感謝您的回饋")}catch(e){R("操作失敗","請稍後再試")}},U=async e=>{let t=prompt("請說明檢舉原因：");if(t)try{await I(e,t),N("檢舉成功","我們會盡快處理")}catch(e){R("檢舉失敗","請稍後再試")}},W=async e=>{if(B.trim())try{await T(e,B.trim()),z(null),V(""),N("回覆成功","感謝您的回覆")}catch(e){R("回覆失敗","請稍後再試")}},q=M[e],G=q?Object.keys(q.tags):[];return $?a.jsx(h.gb,{}):(0,a.jsxs)("div",{className:b,children:[s&&q&&(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"用戶評價"}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:["共 ",q.totalReviews," 則評論"]})]}),p&&a.jsx(w,{statistics:q,size:"lg",className:"mb-6"})]}),u&&a.jsx(k,{filters:Z,onFiltersChange:P,onReset:O,totalReviews:S.length,availableTags:G,className:"mb-6"}),0===E.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[a.jsx("div",{className:"text-gray-400 mb-4",children:a.jsx(i.Z,{className:"w-12 h-12 mx-auto"})}),a.jsx("p",{className:"text-gray-500",children:"暫無符合條件的評論"})]}):a.jsx("div",{className:"space-y-6",children:E.map(e=>(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-gray-300 rounded-full flex items-center justify-center",children:a.jsx(l.Z,{className:"w-5 h-5 text-gray-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-medium text-gray-900",children:e.isAnonymous?"匿名用戶":`用戶 ${e.userId.slice(-4)}`}),e.isVerified&&a.jsx(n.Z,{className:"w-4 h-4 text-green-600"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[a.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(t=>a.jsx(c.Z,{className:`w-4 h-4 ${t<=e.rating?"text-yellow-400 fill-yellow-400":"text-gray-300"}`},t))}),(0,a.jsxs)("span",{className:"text-sm text-gray-500 flex items-center gap-1",children:[a.jsx(d.Z,{className:"w-3 h-3"}),H(e.createdAt)]})]})]})]}),a.jsx("div",{className:"relative",children:a.jsx("button",{className:"p-1 text-gray-400 hover:text-gray-600",children:a.jsx(o.Z,{className:"w-4 h-4"})})})]}),a.jsx("div",{className:"mb-4",children:a.jsx("p",{className:"text-gray-700 leading-relaxed",children:e.comment})}),e.tags&&e.tags.length>0&&a.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:e.tags.map(e=>a.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:e},e))}),(e.pros||e.cons)&&(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.pros&&e.pros.length>0&&(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"text-sm font-medium text-green-700 mb-2",children:"優點"}),a.jsx("ul",{className:"space-y-1",children:e.pros.map((e,t)=>(0,a.jsxs)("li",{className:"text-sm text-gray-600 flex items-start gap-2",children:[a.jsx("span",{className:"text-green-500 mt-1",children:"+"}),e]},t))})]}),e.cons&&e.cons.length>0&&(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"text-sm font-medium text-red-700 mb-2",children:"建議改進"}),a.jsx("ul",{className:"space-y-1",children:e.cons.map((e,t)=>(0,a.jsxs)("li",{className:"text-sm text-gray-600 flex items-start gap-2",children:[a.jsx("span",{className:"text-red-500 mt-1",children:"-"}),e]},t))})]})]}),e.photos&&e.photos.length>0&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx(m.Z,{className:"w-4 h-4 text-gray-500"}),a.jsx("span",{className:"text-sm text-gray-600",children:"評論照片"})]}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:e.photos.map((e,t)=>a.jsx("img",{src:e,alt:`評論照片 ${t+1}`,className:"w-full h-24 object-cover rounded-lg border"},t))})]}),e.response&&(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(i.Z,{className:"w-4 h-4 text-blue-600"}),a.jsx("span",{className:"text-sm font-medium text-gray-900",children:"guide"===e.response.authorType?"導遊回覆":"官方回覆"}),a.jsx("span",{className:"text-sm text-gray-500",children:H(e.response.createdAt)})]}),a.jsx("p",{className:"text-sm text-gray-700",children:e.response.content})]}),F===e.id&&(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[a.jsx("textarea",{value:B,onChange:e=>V(e.target.value),placeholder:"撰寫回覆...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3}),(0,a.jsxs)("div",{className:"flex gap-2 mt-3",children:[a.jsx("button",{onClick:()=>W(e.id),disabled:!B.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed",children:"發布回覆"}),a.jsx("button",{onClick:()=>{z(null),V("")},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50",children:"取消"})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between pt-4 border-t",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("button",{onClick:()=>J(e.id),className:"flex items-center gap-2 text-gray-500 hover:text-blue-600 transition-colors",children:[a.jsx(x.Z,{className:"w-4 h-4"}),(0,a.jsxs)("span",{className:"text-sm",children:["有用 (",e.helpful,")"]})]}),y&&"service"===t&&!e.response&&(0,a.jsxs)("button",{onClick:()=>z(e.id),className:"flex items-center gap-2 text-gray-500 hover:text-green-600 transition-colors",children:[a.jsx(i.Z,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm",children:"回覆"})]})]}),(0,a.jsxs)("button",{onClick:()=>U(e.id),className:"flex items-center gap-1 text-gray-400 hover:text-red-600 transition-colors",children:[a.jsx(g.Z,{className:"w-3 h-3"}),a.jsx("span",{className:"text-xs",children:"檢舉"})]})]})]},e.id))})]})}},58378:(e,t,s)=>{s.d(t,{gb:()=>i});var a=s(95344);s(3729);var r=s(11453);function i({size:e="md",variant:t="spinner",className:s,text:i}){let l={sm:"w-4 h-4",md:"w-6 h-6",lg:"w-8 h-8"},n={sm:"text-sm",md:"text-base",lg:"text-lg"};return"spinner"===t?(0,a.jsxs)("div",{className:(0,r.cn)("flex flex-col items-center justify-center",s),children:[a.jsx("div",{className:(0,r.cn)("animate-spin rounded-full border-2 border-gray-300 border-t-[#FF5A5F]",l[e])}),i&&a.jsx("p",{className:(0,r.cn)("mt-2 text-gray-600",n[e]),children:i})]}):"dots"===t?(0,a.jsxs)("div",{className:(0,r.cn)("flex flex-col items-center justify-center",s),children:[a.jsx("div",{className:"flex space-x-1",children:[0,1,2].map(t=>a.jsx("div",{className:(0,r.cn)("bg-[#FF5A5F] rounded-full animate-pulse","sm"===e?"w-2 h-2":"md"===e?"w-3 h-3":"w-4 h-4"),style:{animationDelay:`${.2*t}s`,animationDuration:"1.2s"}},t))}),i&&a.jsx("p",{className:(0,r.cn)("mt-2 text-gray-600",n[e]),children:i})]}):"pulse"===t?(0,a.jsxs)("div",{className:(0,r.cn)("flex flex-col items-center justify-center",s),children:[a.jsx("div",{className:(0,r.cn)("bg-[#FF5A5F] rounded-full animate-pulse",l[e])}),i&&a.jsx("p",{className:(0,r.cn)("mt-2 text-gray-600",n[e]),children:i})]}):null}},72032:(e,t,s)=>{s.d(t,{pm:()=>c}),s(95344);var a=s(3729),r=s(7060),i=s(66138),l=s(45961),n=s(91991);function c(){let[e,t]=(0,a.useState)([]),s=e=>{let s=Math.random().toString(36).substr(2,9),a={id:s,duration:5e3,...e};return t(e=>[...e,a]),s};return{toasts:e,addToast:s,removeToast:e=>{t(t=>t.filter(t=>t.id!==e))},success:(e,t)=>s({type:"success",title:e,message:t}),error:(e,t)=>s({type:"error",title:e,message:t}),warning:(e,t)=>s({type:"warning",title:e,message:t}),info:(e,t)=>s({type:"info",title:e,message:t})}}r.Z,i.Z,l.Z,n.Z}};